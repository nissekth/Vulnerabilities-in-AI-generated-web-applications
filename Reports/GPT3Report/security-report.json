{
  "metadata": {
    "scanDate": "2025-12-15T15:02:27.350Z",
    "duration": "107s",
    "target": "https://gpt-3-3dd1e.firebaseapp.com",
    "appName": "Social Media App",
    "projectId": "gpt-3-3dd1e",
    "scope": "OWASP Top 10:2021 A01-A03"
  },
  "summary": {
    "total": 34,
    "bySeverity": {
      "CRITICAL": 4,
      "HIGH": 20,
      "MEDIUM": 10,
      "LOW": 0,
      "INFO": 0
    },
    "byCategory": {
      "A01": 20,
      "A02": 3,
      "A03": 11
    },
    "byTool": {
      "firebase-emulator": 13,
      "static-analysis": 3,
      "crypto-scanner": 3,
      "semgrep": 15
    },
    "riskScore": 160,
    "riskLevel": "CRITICAL",
    "deduplication": {
      "originalCount": 41,
      "deduplicatedCount": 34,
      "duplicatesRemoved": 7,
      "reductionPercent": 17
    }
  },
  "findings": [
    {
      "id": "VULN-001",
      "category": "A01",
      "cwe": "CWE-276",
      "cweName": "Unknown",
      "severity": "CRITICAL",
      "title": "Overly Permissive Default Rules",
      "description": "Firestore rules may have a wildcard match that allows access to any collection.",
      "evidence": "Accessed arbitrary collection without authentication",
      "remediation": "Avoid match /{document=**} with permissive rules. Define explicit rules for each collection.",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T15:00:46.491Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "e2503ffb070960b5",
      "_fingerprintSource": "cwe:CWE-276||cat:A01||title:overly permissive default rules"
    },
    {
      "id": "VULN-002",
      "category": "A01",
      "cwe": "CWE-284",
      "cweName": "Improper Access Control",
      "severity": "CRITICAL",
      "title": "Unauthenticated Read Access to Private Messages",
      "description": "Private messages are readable without authentication.",
      "evidence": "Unauthenticated read on /messages/{messageId} succeeded",
      "remediation": "Messages must require authentication: allow read: if request.auth != null",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T15:00:46.491Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "072a19fbaca23d35",
      "_fingerprintSource": "cwe:CWE-284||cat:A01||title:unauthenticated read access to private messages"
    },
    {
      "id": "VULN-003",
      "category": "A01",
      "cwe": "CWE-639",
      "cweName": "IDOR",
      "severity": "CRITICAL",
      "title": "IDOR Vulnerability on Private Data Collection",
      "description": "Private user data is accessible by manipulating document IDs.",
      "evidence": "alice123 accessed bob456's private data",
      "remediation": "Ensure document ID matches auth UID: allow read: if request.auth.uid == userId",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T15:00:46.491Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "e194fbc0d3f11ce4",
      "_fingerprintSource": "cwe:CWE-639||cat:A01||title:idor vulnerability on private data collection"
    },
    {
      "id": "VULN-004",
      "category": "A01",
      "cwe": "CWE-922",
      "cweName": "Insecure Storage of Sensitive Information",
      "severity": "CRITICAL",
      "title": "Sensitive Configuration Data Accessible",
      "description": "API keys or other sensitive configuration stored in Firestore is accessible to regular users.",
      "evidence": "Regular user accessed /config/api_keys document",
      "remediation": "Sensitive config should not be in client-accessible Firestore. Use Cloud Functions or secure backend storage.",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T15:00:46.491Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "02304e7377367877",
      "_fingerprintSource": "cwe:CWE-922||cat:A01||title:sensitive configuration data accessible"
    },
    {
      "id": "VULN-005",
      "category": "A01",
      "cwe": "CWE-200",
      "cweName": "Exposure of Sensitive Information",
      "severity": "HIGH",
      "title": "User Enumeration via Collection Listing",
      "description": "Unauthenticated users can list/enumerate user documents, exposing user data.",
      "evidence": "Unauthenticated list query on /users succeeded",
      "remediation": "Prevent listing: require authentication and consider restricting list queries",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T15:00:46.491Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "a1ba02402a01e8b1",
      "_fingerprintSource": "cwe:CWE-200||cat:A01||title:user enumeration via collection listing"
    },
    {
      "id": "VULN-006",
      "category": "A01",
      "cwe": "CWE-275",
      "cweName": "Unknown",
      "severity": "HIGH",
      "title": "Subcollection Permission Bypass",
      "description": "Subcollections may have different (weaker) permissions than their parent documents.",
      "evidence": "alice123 accessed bob456's private_notes subcollection",
      "remediation": "Ensure subcollections have explicit rules: match /users/{userId}/private_notes/{noteId}",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T15:00:46.491Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "09bbc07bba5db78a",
      "_fingerprintSource": "cwe:CWE-275||cat:A01||title:subcollection permission bypass"
    },
    {
      "id": "VULN-007",
      "category": "A01",
      "cwe": "CWE-284",
      "cweName": "Improper Access Control",
      "severity": "HIGH",
      "title": "Unrestricted Read Access",
      "description": "Rule allows anyone to read data without authentication",
      "evidence": {
        "rule": "allow read: if true"
      },
      "remediation": "Change to: allow read: if request.auth != null",
      "tool": "static-analysis",
      "tools": [
        "static-analysis"
      ],
      "duplicateCount": 6,
      "mergedFrom": [
        {
          "id": "VULN-001",
          "tool": "static-analysis",
          "severity": "HIGH"
        },
        {
          "id": "VULN-002",
          "tool": "static-analysis",
          "severity": "HIGH"
        },
        {
          "id": "VULN-003",
          "tool": "static-analysis",
          "severity": "HIGH"
        },
        {
          "id": "VULN-004",
          "tool": "static-analysis",
          "severity": "HIGH"
        },
        {
          "id": "VULN-005",
          "tool": "static-analysis",
          "severity": "HIGH"
        },
        {
          "id": "VULN-006",
          "tool": "static-analysis",
          "severity": "HIGH"
        }
      ],
      "timestamp": "2025-12-15T15:00:40.624Z",
      "confirmed": false,
      "_fingerprint": "c840b8d7ff27a8ee",
      "_fingerprintSource": "cwe:CWE-284||cat:A01||loc:rule:allow read: if true||vuln:rule:allow read: if true||title:unrestricted read access"
    },
    {
      "id": "VULN-008",
      "category": "A01",
      "cwe": "CWE-284",
      "cweName": "Improper Access Control",
      "severity": "HIGH",
      "title": "Message Injection Possible",
      "description": "Message creation does not validate that sender is in participants list",
      "evidence": {
        "collection": "messages"
      },
      "remediation": "Add: && request.auth.uid in request.resource.data.participants && request.resource.data.senderId == request.auth.uid",
      "tool": "static-analysis",
      "timestamp": "2025-12-15T15:00:40.625Z",
      "tools": [
        "static-analysis"
      ],
      "duplicateCount": 1,
      "_fingerprint": "89224ff3b74f6de2",
      "_fingerprintSource": "cwe:CWE-284||cat:A01||loc:collection:messages||title:message injection possible"
    },
    {
      "id": "VULN-009",
      "category": "A01",
      "cwe": "CWE-284",
      "cweName": "Improper Access Control",
      "severity": "HIGH",
      "title": "Unauthenticated Read Access to User Data",
      "description": "Firestore rules allow unauthenticated users to read user documents. This exposes potentially sensitive user information to anyone.",
      "evidence": "Unauthenticated read on /users/{userId} succeeded",
      "remediation": "Add authentication check: allow read: if request.auth != null",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T15:00:46.491Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "cc5cee82832a3308",
      "_fingerprintSource": "cwe:CWE-284||cat:A01||title:unauthenticated read access to user data"
    },
    {
      "id": "VULN-010",
      "category": "A01",
      "cwe": "CWE-639",
      "cweName": "IDOR",
      "severity": "HIGH",
      "title": "IDOR Vulnerability on User Profiles",
      "description": "Users can access other users' profiles by simply changing the document ID in the request.",
      "evidence": "alice123 accessed bob456's profile by changing document ID",
      "remediation": "Restrict reads to own profile: allow read: if request.auth.uid == userId",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T15:00:46.491Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "8116391c3befc481",
      "_fingerprintSource": "cwe:CWE-639||cat:A01||title:idor vulnerability on user profiles"
    },
    {
      "id": "VULN-011",
      "category": "A01",
      "cwe": "CWE-668",
      "cweName": "Unknown",
      "severity": "HIGH",
      "title": "Group Messages Exposed to Non-Members",
      "description": "Users can read messages from groups they are not members of.",
      "evidence": "alice123 read messages from private-group without membership",
      "remediation": "Verify group membership before allowing access to group resources",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T15:00:46.491Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "5189518ef5ac2b51",
      "_fingerprintSource": "cwe:CWE-668||cat:A01||title:group messages exposed to non-members"
    },
    {
      "id": "VULN-012",
      "category": "A01",
      "cwe": "CWE-862",
      "cweName": "Missing Authorization",
      "severity": "HIGH",
      "title": "Missing Authorization on Admin Collection",
      "description": "Admin-only collections are accessible without admin role verification.",
      "evidence": "Regular user accessed /admin_settings collection",
      "remediation": "Add admin check: allow read: if get(/databases/$(database)/documents/users/$(request.auth.uid)).data.isAdmin == true",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T15:00:46.491Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "4d312072984b9604",
      "_fingerprintSource": "cwe:CWE-862||cat:A01||title:missing authorization on admin collection"
    },
    {
      "id": "VULN-013",
      "category": "A01",
      "cwe": "CWE-863",
      "cweName": "Incorrect Authorization",
      "severity": "HIGH",
      "title": "Incorrect Authorization on Message Access",
      "description": "Users can read messages without being a participant in the conversation.",
      "evidence": "alice123 read message where she is not a participant",
      "remediation": "Add participant check: allow read: if request.auth.uid in resource.data.participants",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T15:00:46.491Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "b601536d35ed71d6",
      "_fingerprintSource": "cwe:CWE-863||cat:A01||title:incorrect authorization on message access"
    },
    {
      "id": "VULN-014",
      "category": "A02",
      "cwe": "CWE-798",
      "cweName": "Unknown",
      "severity": "HIGH",
      "title": "Hardcoded Google API Key found",
      "description": "Found potential Google API Key in https://gpt-3-3dd1e.firebaseapp.com/firebase-config.js",
      "evidence": {
        "pattern": "Google API Key",
        "source": "https://gpt-3-3dd1e.firebaseapp.com/firebase-config.js",
        "redactedMatch": "AIzaSyD9Bd...W0rYs"
      },
      "remediation": null,
      "tool": "crypto-scanner",
      "timestamp": "2025-12-15T15:02:01.103Z",
      "tools": [
        "crypto-scanner"
      ],
      "duplicateCount": 1,
      "_fingerprint": "3d0538ce25f56f4c",
      "_fingerprintSource": "cwe:CWE-798||cat:A02||title:hardcoded google api key found"
    },
    {
      "id": "VULN-015",
      "category": "A03",
      "cwe": "CWE-610",
      "cweName": "Unknown",
      "severity": "HIGH",
      "title": "external-reference-script-src",
      "description": "Dynamic script.src. CWE-610",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT3/my-social-app/app.js",
        "line": 612,
        "endLine": 612,
        "code": "$('profile-picture').src = u.profilePictureUrl;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:00:50.012Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "2cfa633388438815",
      "_fingerprintSource": "cwe:CWE-610||cat:A03||loc:file:/home/nillof/Exjobb/GPT3/my-social-app/app.js|line:612||vuln:code:$(profile-picture).src = u.profilepictureurl;||title:external-reference-script-src"
    },
    {
      "id": "VULN-016",
      "category": "A03",
      "cwe": "CWE-610",
      "cweName": "Unknown",
      "severity": "HIGH",
      "title": "external-reference-script-src",
      "description": "Dynamic script.src. CWE-610",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT3/my-social-app/app.js",
        "line": 699,
        "endLine": 699,
        "code": "img.src = p.imageUrl;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:00:50.012Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "b26bf91fc6fc7756",
      "_fingerprintSource": "cwe:CWE-610||cat:A03||loc:file:/home/nillof/Exjobb/GPT3/my-social-app/app.js|line:699||vuln:code:img.src = p.imageurl;||title:external-reference-script-src"
    },
    {
      "id": "VULN-017",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT3/my-social-app/app.js",
        "line": 281,
        "endLine": 286,
        "code": "div.innerHTML = `\n        <strong>${user.displayName}</strong>\n        <p>${user.city || ''}, ${user.country || ''}</p>\n        <p>Age: ${user.age || ''}</p>\n        <p>${user.about || ''}</p>\n      `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:00:50.012Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "5611d4778cde1724",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT3/my-social-app/app.js|line:281||vuln:code:div.innerhtml = ` <strong>${user.displayname}</strong> <p>${user.city || }, ${us||title:dom xss"
    },
    {
      "id": "VULN-018",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT3/my-social-app/app.js",
        "line": 417,
        "endLine": 447,
        "code": "div.innerHTML = `\n      <div class=\"post-header\">\n        <div>\n          <strong>${author.displayName || 'Unknown'}</strong>\n          <div class=\"post-meta\">\n            ${post.visibility === 'friends' ? 'Friends only • ' : 'Public • '}\n            ${formatDate(post.createdAt)}\n          </div>\n        </div>\n        <div>\n          <button class=\"add-friend-btn\" data-uid=\"${post.authorId}\">Add friend</button>\n        </div>\n      </div>\n      <div class=\"post-body\">\n        <p>${post.text || ''}</p>\n        ${post.imageUrl ? `<img src=\"${post.imageUrl}\" alt=\"post image\">` : ''}\n        ${post.album ? `<p><em>Album: ${post.album}</em></p>` : ''}\n      </div>\n      <div class=\"post-actions\" data-post-id=\"${post.id}\">\n        <button class=\"like-btn\">Like</button>\n        <button class=\"show-comments-btn\">Show comments</button>\n        ${post.imageUrl ? `<a href=\"${post.imageUrl}\" download>Download image</a>` : ''}\n        ${(currentUserDoc && (currentUser.uid === post.authorId || currentUserDoc.role === 'admin' || currentUser.uid === OWNER_UID))\n          ? `<button class=\"delete-post-btn\">Delete</button>` : ''}\n      </div>\n      <div class=\"post-comments\" id=\"comments-${post.id}\"></div>\n      <div class=\"post-comment-form\">\n        <textarea class=\"comment-text\" placeholder=\"Add a comment...\"></textarea>\n        <button class=\"add-comment-btn\" data-post-id=\"${post.id}\">Comment</button>\n      </div>\n    `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:00:50.012Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "0a8d82214895c576",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT3/my-social-app/app.js|line:417||vuln:code:div.innerhtml = ` <div class=post-header> <div> <strong>${author.displayname || ||title:dom xss"
    },
    {
      "id": "VULN-019",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT3/my-social-app/app.js",
        "line": 555,
        "endLine": 561,
        "code": "div.innerHTML = `\n      <strong>${author.displayName || 'Unknown'}</strong>:\n      ${c.text}\n      <span style=\"font-size:0.8rem;color:#666;\"> (${formatDate(c.createdAt)})</span>\n      ${(currentUserDoc && (c.authorId === currentUser.uid || currentUserDoc.role === 'admin' || currentUser.uid === OWNER_UID))\n        ? `<button data-comment-id=\"${c.id}\" data-post-id=\"${postId}\" class=\"delete-comment-btn\">Delete</button>` : ''}\n    `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:00:50.012Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "0f225882939db696",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT3/my-social-app/app.js|line:555||vuln:code:div.innerhtml = ` <strong>${author.displayname || unknown}</strong>: ${c.text} <||title:dom xss"
    },
    {
      "id": "VULN-020",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT3/my-social-app/app.js",
        "line": 745,
        "endLine": 778,
        "code": "div.innerHTML = `\n      <div class=\"post-header\">\n        <div>\n          <strong>${currentUserDoc.displayName}</strong>\n          <div class=\"post-meta\">\n            ${post.visibility === 'friends' ? 'Friends only • ' : 'Public • '}\n            ${formatDate(post.createdAt)}\n          </div>\n        </div>\n      </div>\n\n      <div class=\"post-body\">\n        <p>${post.text || ''}</p>\n        ${post.imageUrl ? `<img src=\"${post.imageUrl}\" alt=\"post image\">` : ''}\n        ${post.album ? `<p><em>Album: ${post.album}</em></p>` : ''}\n      </div>\n\n      <div class=\"post-actions\" data-post-id=\"${post.id}\">\n        <button class=\"like-btn\">Like</button>\n        <button class=\"show-comments-btn\">Show comments</button>\n        ${post.imageUrl ? `<a href=\"${post.imageUrl}\" download>Download image</a>` : ''}\n        ${(uid === currentUser.uid || currentUserDoc.role === 'admin' || currentUser.uid === OWNER_UID)\n          ? `<button class=\"delete-post-btn\">Delete</button>`\n          : ''\n        }\n      </div>\n\n      <div class=\"post-comments\" id=\"comments-${post.id}\"></div>\n\n      <div class=\"post-comment-form\">\n        <textarea class=\"comment-text\" placeholder=\"Add a comment...\"></textarea>\n        <button class=\"add-comment-btn\" data-post-id=\"${post.id}\">Comment</button>\n      </div>\n    `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:00:50.012Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "4586753cdd55b2c8",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT3/my-social-app/app.js|line:745||vuln:code:div.innerhtml = ` <div class=post-header> <div> <strong>${currentuserdoc.display||title:dom xss"
    },
    {
      "id": "VULN-021",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT3/my-social-app/app.js",
        "line": 970
      },
      "remediation": null,
      "tool": "semgrep",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 2,
      "mergedFrom": [
        {
          "id": "VULN-032",
          "tool": "semgrep",
          "severity": "HIGH"
        },
        {
          "id": "VULN-033",
          "tool": "semgrep",
          "severity": "HIGH"
        }
      ],
      "timestamp": "2025-12-15T15:00:50.012Z",
      "confirmed": false,
      "_fingerprint": "0728f49540d18945",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT3/my-social-app/app.js|line:970||vuln:code:div.innerhtml = ` <strong>${u.displayname}</strong> <p>${u.city || }, ${u.countr||title:dom xss"
    },
    {
      "id": "VULN-022",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT3/my-social-app/app.js",
        "line": 1058,
        "endLine": 1063,
        "code": "div.innerHTML = `\n      <strong>${s.user.displayName}</strong>\n      <p>${s.user.city || ''}, ${s.user.country || ''}</p>\n      <p>Mutual friends: ${s.mutual}</p>\n      <button class=\"add-friend-btn\" data-uid=\"${s.id}\">Add friend</button>\n    `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:00:50.012Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "c02e41a6c7ce512d",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT3/my-social-app/app.js|line:1058||vuln:code:div.innerhtml = ` <strong>${s.user.displayname}</strong> <p>${s.user.city || }, ||title:dom xss"
    },
    {
      "id": "VULN-023",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT3/my-social-app/app.js",
        "line": 1115,
        "endLine": 1118,
        "code": "div.innerHTML = `\n      <strong>${u.displayName}</strong>\n      <p>Click to open conversation</p>\n    `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:00:50.012Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "d2811373538ac312",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT3/my-social-app/app.js|line:1115||vuln:code:div.innerhtml = ` <strong>${u.displayname}</strong> <p>click to open conversatio||title:dom xss"
    },
    {
      "id": "VULN-024",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT3/my-social-app/app.js",
        "line": 1416,
        "endLine": 1420,
        "code": "div.innerHTML = `\n      <strong>${u.displayName} (${u.email})</strong>\n      <p>Role: ${u.role || 'user'}</p>\n      <button data-uid=\"${doc.id}\" class=\"admin-delete-user-btn\">Delete user</button>\n    `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:00:50.012Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "0f621eab857b939a",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT3/my-social-app/app.js|line:1416||vuln:code:div.innerhtml = ` <strong>${u.displayname} (${u.email})</strong> <p>role: ${u.ro||title:dom xss"
    },
    {
      "id": "VULN-025",
      "category": "A01",
      "cwe": "CWE-284",
      "cweName": "Improper Access Control",
      "severity": "MEDIUM",
      "title": "Unauthenticated Read Access to Posts",
      "description": "Posts are readable without authentication. Consider if this is intentional for public content.",
      "evidence": "Unauthenticated read on /posts/{postId} succeeded",
      "remediation": "If posts should be private, add: allow read: if request.auth != null",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T15:00:46.491Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "f5c167243df79b33",
      "_fingerprintSource": "cwe:CWE-284||cat:A01||title:unauthenticated read access to posts"
    },
    {
      "id": "VULN-026",
      "category": "A01",
      "cwe": "CWE-285",
      "cweName": "Improper Authorization",
      "severity": "MEDIUM",
      "title": "improper-auth-admin-string",
      "description": "Client-side admin role check. CWE-285",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT3/my-social-app/app.js",
        "line": 121,
        "endLine": 121,
        "code": "} else if (currentUserDoc.role === 'admin') {"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:00:50.012Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "769a232e23a9ecaa",
      "_fingerprintSource": "cwe:CWE-285||cat:A01||loc:file:/home/nillof/Exjobb/GPT3/my-social-app/app.js|line:121||vuln:code:} else if (currentuserdoc.role === admin) {||title:improper-auth-admin-string"
    },
    {
      "id": "VULN-027",
      "category": "A01",
      "cwe": "CWE-285",
      "cweName": "Improper Authorization",
      "severity": "MEDIUM",
      "title": "improper-auth-admin-string",
      "description": "Client-side admin role check. CWE-285",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT3/my-social-app/app.js",
        "line": 439,
        "endLine": 439,
        "code": "${(currentUserDoc && (currentUser.uid === post.authorId || currentUserDoc.role === 'admin' || currentUser.uid === OWNER_UID))"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:00:50.012Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "c2a6a745c0c6da38",
      "_fingerprintSource": "cwe:CWE-285||cat:A01||loc:file:/home/nillof/Exjobb/GPT3/my-social-app/app.js|line:439||vuln:code:${(currentuserdoc && (currentuser.uid === post.authorid || currentuserdoc.role =||title:improper-auth-admin-string"
    },
    {
      "id": "VULN-028",
      "category": "A01",
      "cwe": "CWE-285",
      "cweName": "Improper Authorization",
      "severity": "MEDIUM",
      "title": "improper-auth-admin-string",
      "description": "Client-side admin role check. CWE-285",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT3/my-social-app/app.js",
        "line": 559,
        "endLine": 559,
        "code": "${(currentUserDoc && (c.authorId === currentUser.uid || currentUserDoc.role === 'admin' || currentUser.uid === OWNER_UID))"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:00:50.012Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "6e11dd65fc1f076b",
      "_fingerprintSource": "cwe:CWE-285||cat:A01||loc:file:/home/nillof/Exjobb/GPT3/my-social-app/app.js|line:559||vuln:code:${(currentuserdoc && (c.authorid === currentuser.uid || currentuserdoc.role === ||title:improper-auth-admin-string"
    },
    {
      "id": "VULN-029",
      "category": "A01",
      "cwe": "CWE-285",
      "cweName": "Improper Authorization",
      "severity": "MEDIUM",
      "title": "improper-auth-admin-string",
      "description": "Client-side admin role check. CWE-285",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT3/my-social-app/app.js",
        "line": 766,
        "endLine": 766,
        "code": "${(uid === currentUser.uid || currentUserDoc.role === 'admin' || currentUser.uid === OWNER_UID)"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:00:50.012Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "fc632f3aea4d16c9",
      "_fingerprintSource": "cwe:CWE-285||cat:A01||loc:file:/home/nillof/Exjobb/GPT3/my-social-app/app.js|line:766||vuln:code:${(uid === currentuser.uid || currentuserdoc.role === admin || currentuser.uid =||title:improper-auth-admin-string"
    },
    {
      "id": "VULN-030",
      "category": "A01",
      "cwe": "CWE-285",
      "cweName": "Improper Authorization",
      "severity": "MEDIUM",
      "title": "improper-auth-admin-string",
      "description": "Client-side admin role check. CWE-285",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT3/my-social-app/app.js",
        "line": 1353,
        "endLine": 1353,
        "code": "const newRole = user.role === 'admin' ? 'user' : 'admin';"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:00:50.012Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "07c0fa476537e221",
      "_fingerprintSource": "cwe:CWE-285||cat:A01||loc:file:/home/nillof/Exjobb/GPT3/my-social-app/app.js|line:1353||vuln:code:const newrole = user.role === admin ? user : admin;||title:improper-auth-admin-string"
    },
    {
      "id": "VULN-031",
      "category": "A01",
      "cwe": "CWE-668",
      "cweName": "Unknown",
      "severity": "MEDIUM",
      "title": "Draft Content Exposed to Other Users",
      "description": "Unpublished/draft content is accessible to users other than the author.",
      "evidence": "bob456 accessed alice123's draft posts",
      "remediation": "Add visibility check: allow read: if resource.data.status == \"published\" || request.auth.uid == resource.data.userId",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T15:00:46.491Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "a20995916ac311eb",
      "_fingerprintSource": "cwe:CWE-668||cat:A01||title:draft content exposed to other users"
    },
    {
      "id": "VULN-032",
      "category": "A02",
      "cwe": "CWE-330",
      "cweName": "Use of Insufficiently Random Values",
      "severity": "MEDIUM",
      "title": "Weak Random detected",
      "description": "Found Weak Random in https://gpt-3-3dd1e.firebaseapp.com/app.js. This may indicate weak cryptographic practices.",
      "evidence": {
        "pattern": "Weak Random",
        "source": "https://gpt-3-3dd1e.firebaseapp.com/app.js",
        "matchCount": 1
      },
      "remediation": null,
      "tool": "crypto-scanner",
      "timestamp": "2025-12-15T15:02:01.103Z",
      "tools": [
        "crypto-scanner"
      ],
      "duplicateCount": 1,
      "_fingerprint": "c9c51dcd58f3ba92",
      "_fingerprintSource": "cwe:CWE-330||cat:A02||title:weak random detected"
    },
    {
      "id": "VULN-033",
      "category": "A02",
      "cwe": "CWE-521",
      "cweName": "Weak Password Requirements",
      "severity": "MEDIUM",
      "title": "Weak password policy",
      "description": "Password field \"register-password\" has weak policy: no minimum length requirement (should be ≥8), no pattern for password complexity",
      "evidence": null,
      "remediation": null,
      "tool": "crypto-scanner",
      "tools": [
        "crypto-scanner"
      ],
      "duplicateCount": 2,
      "mergedFrom": [
        {
          "id": "VULN-040",
          "tool": "crypto-scanner",
          "severity": "MEDIUM"
        },
        {
          "id": "VULN-041",
          "tool": "crypto-scanner",
          "severity": "MEDIUM"
        }
      ],
      "timestamp": "2025-12-15T15:02:01.103Z",
      "confirmed": false,
      "_fingerprint": "f17a2819353daa70",
      "_fingerprintSource": "cwe:CWE-521||cat:A02||title:weak password policy"
    },
    {
      "id": "VULN-034",
      "category": "A03",
      "cwe": "CWE-434",
      "cweName": "Unrestricted Upload of File with Dangerous Type",
      "severity": "MEDIUM",
      "title": "Missing File Type Validation in Storage Rules",
      "description": "Storage rules do not validate file content type",
      "evidence": null,
      "remediation": "Add: && request.resource.contentType.matches('image/.*')",
      "tool": "static-analysis",
      "timestamp": "2025-12-15T15:00:40.625Z",
      "tools": [
        "static-analysis"
      ],
      "duplicateCount": 1,
      "_fingerprint": "7a89ddfe7772272a",
      "_fingerprintSource": "cwe:CWE-434||cat:A03||title:missing file type validation in storage rules"
    }
  ],
  "cweCoverage": {
    "A01_BrokenAccessControl": [
      "CWE-22",
      "CWE-23",
      "CWE-200",
      "CWE-201",
      "CWE-219",
      "CWE-264",
      "CWE-275",
      "CWE-276",
      "CWE-284",
      "CWE-285",
      "CWE-352",
      "CWE-359",
      "CWE-425",
      "CWE-441",
      "CWE-497",
      "CWE-538",
      "CWE-540",
      "CWE-548",
      "CWE-552",
      "CWE-566",
      "CWE-601",
      "CWE-639",
      "CWE-651",
      "CWE-668",
      "CWE-706",
      "CWE-862",
      "CWE-863",
      "CWE-913",
      "CWE-922",
      "CWE-1275"
    ],
    "A02_CryptographicFailures": [
      "CWE-261",
      "CWE-296",
      "CWE-310",
      "CWE-319",
      "CWE-321",
      "CWE-322",
      "CWE-323",
      "CWE-324",
      "CWE-325",
      "CWE-326",
      "CWE-327",
      "CWE-328",
      "CWE-329",
      "CWE-330",
      "CWE-331",
      "CWE-335",
      "CWE-336",
      "CWE-337",
      "CWE-338",
      "CWE-340",
      "CWE-347",
      "CWE-523",
      "CWE-757",
      "CWE-759",
      "CWE-760",
      "CWE-780",
      "CWE-818",
      "CWE-916"
    ],
    "A03_Injection": [
      "CWE-20",
      "CWE-74",
      "CWE-75",
      "CWE-77",
      "CWE-78",
      "CWE-79",
      "CWE-80",
      "CWE-83",
      "CWE-87",
      "CWE-88",
      "CWE-89",
      "CWE-90",
      "CWE-91",
      "CWE-93",
      "CWE-94",
      "CWE-95",
      "CWE-96",
      "CWE-97",
      "CWE-98",
      "CWE-99",
      "CWE-113",
      "CWE-116",
      "CWE-138",
      "CWE-184",
      "CWE-470",
      "CWE-471",
      "CWE-564",
      "CWE-610",
      "CWE-643",
      "CWE-644",
      "CWE-652",
      "CWE-917",
      "CWE-943"
    ]
  }
}