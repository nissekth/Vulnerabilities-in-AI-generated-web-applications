{
  "metadata": {
    "scanDate": "2025-12-15T23:41:44.096Z",
    "duration": "102s",
    "target": "https://claude4-195d9.firebaseapp.com",
    "appName": "Social Media App",
    "projectId": "claude4-195d9",
    "scope": "OWASP Top 10:2021 A01-A03"
  },
  "summary": {
    "total": 30,
    "bySeverity": {
      "CRITICAL": 2,
      "HIGH": 22,
      "MEDIUM": 6,
      "LOW": 0,
      "INFO": 0
    },
    "byCategory": {
      "A01": 11,
      "A02": 4,
      "A03": 15
    },
    "byTool": {
      "static-analysis": 7,
      "firebase-emulator": 5,
      "semgrep": 15,
      "crypto-scanner": 3
    },
    "riskScore": 142,
    "riskLevel": "CRITICAL",
    "deduplication": {
      "originalCount": 35,
      "deduplicatedCount": 30,
      "duplicatesRemoved": 5,
      "reductionPercent": 14
    }
  },
  "findings": [
    {
      "id": "VULN-001",
      "category": "A01",
      "cwe": "CWE-285",
      "cweName": "Improper Authorization",
      "severity": "CRITICAL",
      "title": "Authorization Bypass - No Owner Verification",
      "description": "Rule only checks authentication, not authorization. Any authenticated user can modify any document.",
      "evidence": {
        "rule": "allow write: if request.auth != null;"
      },
      "remediation": "Add owner check: allow update: if request.auth != null && request.auth.uid == userId",
      "tool": "static-analysis",
      "timestamp": "2025-12-15T23:40:02.326Z",
      "tools": [
        "static-analysis"
      ],
      "duplicateCount": 1,
      "_fingerprint": "55bb57f861d69e4d",
      "_fingerprintSource": "cwe:CWE-285||cat:A01||loc:rule:allow write: if request.auth != null;||vuln:rule:allow write: if request.auth != null;||title:authorization bypass - no owner verification"
    },
    {
      "id": "VULN-002",
      "category": "A01",
      "cwe": "CWE-285",
      "cweName": "Improper Authorization",
      "severity": "CRITICAL",
      "title": "Authorization Bypass - No Owner Verification",
      "description": "Rule only checks authentication, not authorization. Any authenticated user can modify any document.",
      "evidence": {
        "rule": "allow update: if request.auth != null;"
      },
      "remediation": "Add owner check: allow update: if request.auth != null && request.auth.uid == userId",
      "tool": "static-analysis",
      "timestamp": "2025-12-15T23:40:02.326Z",
      "tools": [
        "static-analysis"
      ],
      "duplicateCount": 1,
      "_fingerprint": "282cb0751f9c62c5",
      "_fingerprintSource": "cwe:CWE-285||cat:A01||loc:rule:allow update: if request.auth != null;||vuln:rule:allow update: if request.auth != null;||title:authorization bypass - no owner verification"
    },
    {
      "id": "VULN-003",
      "category": "A01",
      "cwe": "CWE-200",
      "cweName": "Exposure of Sensitive Information",
      "severity": "HIGH",
      "title": "User Enumeration via Collection Listing",
      "description": "Unauthenticated users can list/enumerate user documents, exposing user data.",
      "evidence": "Unauthenticated list query on /users succeeded",
      "remediation": "Prevent listing: require authentication and consider restricting list queries",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T23:40:09.139Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "a1ba02402a01e8b1",
      "_fingerprintSource": "cwe:CWE-200||cat:A01||title:user enumeration via collection listing"
    },
    {
      "id": "VULN-004",
      "category": "A01",
      "cwe": "CWE-284",
      "cweName": "Improper Access Control",
      "severity": "HIGH",
      "title": "Unrestricted Read Access",
      "description": "Rule allows anyone to read data without authentication",
      "evidence": {
        "rule": "allow read: if true"
      },
      "remediation": "Change to: allow read: if request.auth != null",
      "tool": "static-analysis",
      "tools": [
        "static-analysis"
      ],
      "duplicateCount": 4,
      "mergedFrom": [
        {
          "id": "VULN-001",
          "tool": "static-analysis",
          "severity": "HIGH"
        },
        {
          "id": "VULN-002",
          "tool": "static-analysis",
          "severity": "HIGH"
        },
        {
          "id": "VULN-003",
          "tool": "static-analysis",
          "severity": "HIGH"
        },
        {
          "id": "VULN-004",
          "tool": "static-analysis",
          "severity": "HIGH"
        }
      ],
      "timestamp": "2025-12-15T23:40:02.326Z",
      "confirmed": false,
      "_fingerprint": "c840b8d7ff27a8ee",
      "_fingerprintSource": "cwe:CWE-284||cat:A01||loc:rule:allow read: if true||vuln:rule:allow read: if true||title:unrestricted read access"
    },
    {
      "id": "VULN-005",
      "category": "A01",
      "cwe": "CWE-284",
      "cweName": "Improper Access Control",
      "severity": "HIGH",
      "title": "Message Injection Possible",
      "description": "Message creation does not validate that sender is in participants list",
      "evidence": {
        "collection": "messages"
      },
      "remediation": "Add: && request.auth.uid in request.resource.data.participants && request.resource.data.senderId == request.auth.uid",
      "tool": "static-analysis",
      "timestamp": "2025-12-15T23:40:02.326Z",
      "tools": [
        "static-analysis"
      ],
      "duplicateCount": 1,
      "_fingerprint": "89224ff3b74f6de2",
      "_fingerprintSource": "cwe:CWE-284||cat:A01||loc:collection:messages||title:message injection possible"
    },
    {
      "id": "VULN-006",
      "category": "A01",
      "cwe": "CWE-284",
      "cweName": "Improper Access Control",
      "severity": "HIGH",
      "title": "Unauthenticated Read Access to User Data",
      "description": "Firestore rules allow unauthenticated users to read user documents. This exposes potentially sensitive user information to anyone.",
      "evidence": "Unauthenticated read on /users/{userId} succeeded",
      "remediation": "Add authentication check: allow read: if request.auth != null",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T23:40:09.139Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "cc5cee82832a3308",
      "_fingerprintSource": "cwe:CWE-284||cat:A01||title:unauthenticated read access to user data"
    },
    {
      "id": "VULN-007",
      "category": "A01",
      "cwe": "CWE-639",
      "cweName": "IDOR",
      "severity": "HIGH",
      "title": "IDOR Vulnerability on User Profiles",
      "description": "Users can access other users' profiles by simply changing the document ID in the request.",
      "evidence": "alice123 accessed bob456's profile by changing document ID",
      "remediation": "Restrict reads to own profile: allow read: if request.auth.uid == userId",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T23:40:09.139Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "8116391c3befc481",
      "_fingerprintSource": "cwe:CWE-639||cat:A01||title:idor vulnerability on user profiles"
    },
    {
      "id": "VULN-008",
      "category": "A01",
      "cwe": "CWE-862",
      "cweName": "Missing Authorization",
      "severity": "HIGH",
      "title": "Missing Creator Validation",
      "description": "Create operation only requires authentication. Should validate resource data matches authenticated user.",
      "evidence": {
        "rule": "allow create: if request.auth != null;"
      },
      "remediation": "Add: && request.resource.data.userId == request.auth.uid",
      "tool": "static-analysis",
      "tools": [
        "static-analysis"
      ],
      "duplicateCount": 2,
      "mergedFrom": [
        {
          "id": "VULN-007",
          "tool": "static-analysis",
          "severity": "HIGH"
        },
        {
          "id": "VULN-008",
          "tool": "static-analysis",
          "severity": "HIGH"
        }
      ],
      "timestamp": "2025-12-15T23:40:02.326Z",
      "confirmed": false,
      "_fingerprint": "5c043fda4d5cdb55",
      "_fingerprintSource": "cwe:CWE-862||cat:A01||loc:rule:allow create: if request.auth != null;||vuln:rule:allow create: if request.auth != null;||title:missing creator validation"
    },
    {
      "id": "VULN-009",
      "category": "A01",
      "cwe": "CWE-863",
      "cweName": "Incorrect Authorization",
      "severity": "HIGH",
      "title": "client-side-isadmin",
      "description": "Client-side admin check. CWE-863",
      "evidence": {
        "file": "/home/nillof/Exjobb/Claude4/social-circle-web/app.js",
        "line": 158,
        "endLine": 158,
        "code": "if (userData.isAdmin) {"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T23:40:12.833Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "8f7eff8db5c76a2f",
      "_fingerprintSource": "cwe:CWE-863||cat:A01||loc:file:/home/nillof/Exjobb/Claude4/social-circle-web/app.js|line:158||vuln:code:if (userdata.isadmin) {||title:client-side-isadmin"
    },
    {
      "id": "VULN-010",
      "category": "A02",
      "cwe": "CWE-798",
      "cweName": "Unknown",
      "severity": "HIGH",
      "title": "Hardcoded Google API Key found",
      "description": "Found potential Google API Key in https://claude4-195d9.firebaseapp.com/config.js",
      "evidence": {
        "pattern": "Google API Key",
        "source": "https://claude4-195d9.firebaseapp.com/config.js",
        "redactedMatch": "AIzaSyBWzo...IBQiI"
      },
      "remediation": null,
      "tool": "crypto-scanner",
      "timestamp": "2025-12-15T23:41:18.749Z",
      "tools": [
        "crypto-scanner"
      ],
      "duplicateCount": 1,
      "_fingerprint": "3d0538ce25f56f4c",
      "_fingerprintSource": "cwe:CWE-798||cat:A02||title:hardcoded google api key found"
    },
    {
      "id": "VULN-011",
      "category": "A03",
      "cwe": "CWE-610",
      "cweName": "Unknown",
      "severity": "HIGH",
      "title": "external-reference-script-src",
      "description": "Dynamic script.src. CWE-610",
      "evidence": {
        "file": "/home/nillof/Exjobb/Claude4/social-circle-web/app.js",
        "line": 400,
        "endLine": 400,
        "code": "document.getElementById('profilePic').src = userData.profilePic || 'https://via.placeholder.com/150';"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T23:40:12.834Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "77955ce673422b9d",
      "_fingerprintSource": "cwe:CWE-610||cat:A03||loc:file:/home/nillof/Exjobb/Claude4/social-circle-web/app.js|line:400||vuln:code:document.getelementbyid(profilepic).src = userdata.profilepic || https://via.pla||title:external-reference-script-src"
    },
    {
      "id": "VULN-012",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/Claude4/social-circle-web/app.js",
        "line": 279,
        "endLine": 306,
        "code": "card.innerHTML = `\n        <div class=\"post-header\">\n            <img src=\"${post.userPhoto || 'https://via.placeholder.com/48'}\" alt=\"${post.userName}\" class=\"post-avatar\" onclick=\"viewUserProfile('${post.userId}')\">\n            <div class=\"post-info\">\n                <h4 onclick=\"viewUserProfile('${post.userId}')\" style=\"cursor: pointer;\">${post.userName}</h4>\n                <div class=\"post-time\">${timestamp}${post.friendsOnly ? ' üë• Friends only' : ''}</div>\n            </div>\n        </div>\n        <div class=\"post-content\">${post.content || ''}</div>\n        ${post.imageUrl ? `<img src=\"${post.imageUrl}\" alt=\"Post image\" class=\"post-image\">` : ''}\n        <div class=\"post-actions\">\n            <button class=\"action-btn ${isLiked ? 'liked' : ''}\" onclick=\"toggleLike('${postId}')\">\n                ${isLiked ? '‚ù§Ô∏è' : 'ü§ç'} <span>${likeCount} Likes</span>\n            </button>\n            <button class=\"action-btn\" onclick=\"toggleComments('${postId}')\">\n                üí¨ Comment\n            </button>\n            ${post.imageUrl ? `<a href=\"${post.imageUrl}\" download class=\"action-btn\">‚¨áÔ∏è Download</a>` : ''}\n            ${post.userId !== currentUser.uid ? `<button class=\"action-btn\" onclick=\"addFriendFromFeed('${post.userId}')\">‚ûï Add Friend</button>` : ''}\n        </div>\n        <div id=\"comments-${postId}\" class=\"comments-section\" style=\"display:none;\">\n            <div id=\"comments-list-${postId}\"></div>\n            <form onsubmit=\"addComment(event, '${postId}')\" class=\"comment-form\">\n                <input type=\"text\" class=\"comment-input\" placeholder=\"Write a comment...\" required>\n                <button type=\"submit\" class=\"btn btn-primary btn-small\">Post</button>\n            </form>\n        </div>\n    `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T23:40:12.834Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "72eb75b03453521e",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/Claude4/social-circle-web/app.js|line:279||vuln:code:card.innerhtml = ` <div class=post-header> <img src=${post.userphoto || https://||title:dom xss"
    },
    {
      "id": "VULN-013",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/Claude4/social-circle-web/app.js",
        "line": 357,
        "endLine": 360,
        "code": "commentEl.innerHTML = `\n                <div class=\"comment-author\">${comment.userName}</div>\n                <div class=\"comment-text\">${comment.text}</div>\n            `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T23:40:12.834Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "9c1a6ebf1bc8e855",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/Claude4/social-circle-web/app.js|line:357||vuln:code:commentel.innerhtml = ` <div class=comment-author>${comment.username}</div> <div||title:dom xss"
    },
    {
      "id": "VULN-014",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/Claude4/social-circle-web/app.js",
        "line": 462,
        "endLine": 462,
        "code": "galleryItem.innerHTML = `<img src=\"${item.imageUrl}\" alt=\"Gallery photo\">`;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T23:40:12.834Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "490475916f229c5e",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/Claude4/social-circle-web/app.js|line:462||vuln:code:galleryitem.innerhtml = `<img src=${item.imageurl} alt=gallery photo>`;||title:dom xss"
    },
    {
      "id": "VULN-015",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/Claude4/social-circle-web/app.js",
        "line": 612,
        "endLine": 621,
        "code": "card.innerHTML = `\n        <img src=\"${userData.profilePic || 'https://via.placeholder.com/100'}\" alt=\"${userData.displayName || userData.name}\" class=\"friend-avatar\">\n        <h4>${userData.displayName || userData.name}</h4>\n        <p class=\"friend-info\">${details.join(' ‚Ä¢ ') || 'No details'}</p>\n        ${isSuggestion ? \n            `<button onclick=\"addFriend('${userData.uid}')\" class=\"btn btn-primary btn-small\">Add Friend</button>` :\n            `<button onclick=\"viewUserProfile('${userData.uid}')\" class=\"btn btn-outline btn-small\">View Profile</button>\n             <button onclick=\"removeFriend('${userData.uid}')\" class=\"btn btn-small\">Remove</button>`\n        }\n    `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T23:40:12.834Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "5d78277f65d47464",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/Claude4/social-circle-web/app.js|line:612||vuln:code:card.innerhtml = ` <img src=${userdata.profilepic || https://via.placeholder.com||title:dom xss"
    },
    {
      "id": "VULN-016",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/Claude4/social-circle-web/app.js",
        "line": 681,
        "endLine": 684,
        "code": "conversationItem.innerHTML = `\n                    <img src=\"${userData.profilePic || 'https://via.placeholder.com/40'}\" alt=\"${userData.displayName || userData.name}\" style=\"width: 40px; height: 40px; border-radius: 50%;\">\n                    <div>${userData.displayName || userData.name}</div>\n                `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T23:40:12.834Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "4f76b0af1a895090",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/Claude4/social-circle-web/app.js|line:681||vuln:code:conversationitem.innerhtml = ` <img src=${userdata.profilepic || https://via.pla||title:dom xss"
    },
    {
      "id": "VULN-017",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/Claude4/social-circle-web/app.js",
        "line": 697,
        "endLine": 697,
        "code": "document.getElementById('messageHeader').innerHTML = `<h3>Conversation with ${friendName}</h3>`;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T23:40:12.834Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "4be795d5cb63757a",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/Claude4/social-circle-web/app.js|line:697||vuln:code:document.getelementbyid(messageheader).innerhtml = `<h3>conversation with ${frie||title:dom xss"
    },
    {
      "id": "VULN-018",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/Claude4/social-circle-web/app.js",
        "line": 812,
        "endLine": 821,
        "code": "userCard.innerHTML = `\n                <img src=\"${userData.profilePic || 'https://via.placeholder.com/80'}\" alt=\"${userData.displayName || userData.name}\" class=\"user-avatar\">\n                <h4>${userData.displayName || userData.name}</h4>\n                <p>${userData.city || 'Location not set'}</p>\n                ${currentUser ? \n                    `<button onclick=\"addFriend('${userData.uid}')\" class=\"btn btn-primary btn-small\">Add Friend</button>\n                     <button onclick=\"viewUserProfile('${userData.uid}')\" class=\"btn btn-outline btn-small\">View Profile</button>` :\n                    `<button onclick=\"showLogin()\" class=\"btn btn-primary btn-small\">Login to Connect</button>`\n                }\n            `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T23:40:12.834Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "a1d682aa9655dae7",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/Claude4/social-circle-web/app.js|line:812||vuln:code:usercard.innerhtml = ` <img src=${userdata.profilepic || https://via.placeholder||title:dom xss"
    },
    {
      "id": "VULN-019",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/Claude4/social-circle-web/app.js",
        "line": 843,
        "endLine": 852,
        "code": "content.innerHTML = `\n            <div class=\"profile-banner ${userData.banner || 'gradient1'}\"></div>\n            <div style=\"text-align: center; margin-top: -60px;\">\n                <img src=\"${userData.profilePic || 'https://via.placeholder.com/150'}\" alt=\"${userData.displayName || userData.name}\" style=\"width: 150px; height: 150px; border-radius: 50%; border: 5px solid white;\">\n                <h2>${userData.displayName || userData.name}</h2>\n                <p>${details.join(' ‚Ä¢ ') || 'No details'}</p>\n                <p style=\"margin: 1rem 0;\">${userData.about || 'No bio'}</p>\n                ${currentUser ? `<button onclick=\"addFriend('${userId}')\" class=\"btn btn-primary\">Add Friend</button>` : ''}\n            </div>\n        `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T23:40:12.834Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "cc0a4dbe44621cf6",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/Claude4/social-circle-web/app.js|line:843||vuln:code:content.innerhtml = ` <div class=profile-banner ${userdata.banner || gradient1}>||title:dom xss"
    },
    {
      "id": "VULN-020",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/Claude4/social-circle-web/app.js",
        "line": 951,
        "endLine": 953,
        "code": "codeEl.innerHTML = `\n                <strong>${code.code}</strong> - ${code.used ? '‚úì Used' : '‚óã Available'}\n            `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T23:40:12.834Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "11ad0447897a3aa6",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/Claude4/social-circle-web/app.js|line:951||vuln:code:codeel.innerhtml = ` <strong>${code.code}</strong> - ${code.used ? ‚úì used : ‚óã av||title:dom xss"
    },
    {
      "id": "VULN-021",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/Claude4/social-circle-web/app.js",
        "line": 1079,
        "endLine": 1087,
        "code": "userItem.innerHTML = `\n                <div>\n                    <strong>${user.displayName || user.name}</strong> - ${user.email}\n                </div>\n                <div>\n                    <button onclick=\"makeAdmin('${doc.id}')\" class=\"btn btn-small\">Make Admin</button>\n                    <button onclick=\"deleteUserAdmin('${doc.id}')\" class=\"btn btn-danger btn-small\">Delete</button>\n                </div>\n            `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T23:40:12.834Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "98895638d07d569f",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/Claude4/social-circle-web/app.js|line:1079||vuln:code:useritem.innerhtml = ` <div> <strong>${user.displayname || user.name}</strong> -||title:dom xss"
    },
    {
      "id": "VULN-022",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/Claude4/social-circle-web/app.js",
        "line": 1100,
        "endLine": 1105,
        "code": "adminItem.innerHTML = `\n                <div>\n                    <strong>${admin.displayName || admin.name}</strong> - ${admin.email}\n                </div>\n                <button onclick=\"removeAdmin('${doc.id}')\" class=\"btn btn-small\">Remove Admin</button>\n            `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T23:40:12.834Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "ae312ed044e5d38b",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/Claude4/social-circle-web/app.js|line:1100||vuln:code:adminitem.innerhtml = ` <div> <strong>${admin.displayname || admin.name}</strong||title:dom xss"
    },
    {
      "id": "VULN-023",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/Claude4/social-circle-web/app.js",
        "line": 1118,
        "endLine": 1123,
        "code": "postItem.innerHTML = `\n                <div>\n                    <strong>${post.userName}</strong>: ${post.content?.substring(0, 50)}...\n                </div>\n                <button onclick=\"deletePostAdmin('${doc.id}')\" class=\"btn btn-danger btn-small\">Delete</button>\n            `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T23:40:12.834Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "652a4f04cd72a1bf",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/Claude4/social-circle-web/app.js|line:1118||vuln:code:postitem.innerhtml = ` <div> <strong>${post.username}</strong>: ${post.content?.||title:dom xss"
    },
    {
      "id": "VULN-024",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/Claude4/social-circle-web/app.js",
        "line": 1293,
        "endLine": 1294,
        "code": "document.getElementById('imagePreview').innerHTML = \n                `<img src=\"${e.target.result}\" style=\"max-width: 100%; border-radius: 8px; margin-top: 1rem;\">`;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T23:40:12.834Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "10c424ba7f9d6ca1",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/Claude4/social-circle-web/app.js|line:1293||vuln:code:document.getelementbyid(imagepreview).innerhtml = `<img src=${e.target.result} s||title:dom xss"
    },
    {
      "id": "VULN-025",
      "category": "A01",
      "cwe": "CWE-284",
      "cweName": "Improper Access Control",
      "severity": "MEDIUM",
      "title": "Unauthenticated Read Access to Posts",
      "description": "Posts are readable without authentication. Consider if this is intentional for public content.",
      "evidence": "Unauthenticated read on /posts/{postId} succeeded",
      "remediation": "If posts should be private, add: allow read: if request.auth != null",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T23:40:09.139Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "f5c167243df79b33",
      "_fingerprintSource": "cwe:CWE-284||cat:A01||title:unauthenticated read access to posts"
    },
    {
      "id": "VULN-026",
      "category": "A01",
      "cwe": "CWE-668",
      "cweName": "Unknown",
      "severity": "MEDIUM",
      "title": "Draft Content Exposed to Other Users",
      "description": "Unpublished/draft content is accessible to users other than the author.",
      "evidence": "bob456 accessed alice123's draft posts",
      "remediation": "Add visibility check: allow read: if resource.data.status == \"published\" || request.auth.uid == resource.data.userId",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T23:40:09.139Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "a20995916ac311eb",
      "_fingerprintSource": "cwe:CWE-668||cat:A01||title:draft content exposed to other users"
    },
    {
      "id": "VULN-027",
      "category": "A02",
      "cwe": "CWE-311",
      "cweName": "Missing Encryption of Sensitive Data",
      "severity": "MEDIUM",
      "title": "Public Storage Access",
      "description": "Storage files are publicly readable. Consider if this is necessary.",
      "evidence": {
        "rule": "allow read: if true"
      },
      "remediation": "Consider: allow read: if request.auth != null",
      "tool": "static-analysis",
      "timestamp": "2025-12-15T23:40:02.327Z",
      "tools": [
        "static-analysis"
      ],
      "duplicateCount": 1,
      "_fingerprint": "e49ef171d02d0e12",
      "_fingerprintSource": "cwe:CWE-311||cat:A02||loc:rule:allow read: if true||vuln:rule:allow read: if true||title:public storage access"
    },
    {
      "id": "VULN-028",
      "category": "A02",
      "cwe": "CWE-330",
      "cweName": "Use of Insufficiently Random Values",
      "severity": "MEDIUM",
      "title": "Weak Random detected",
      "description": "Found Weak Random in https://claude4-195d9.firebaseapp.com/app.js. This may indicate weak cryptographic practices.",
      "evidence": {
        "pattern": "Weak Random",
        "source": "https://claude4-195d9.firebaseapp.com/app.js",
        "matchCount": 1
      },
      "remediation": null,
      "tool": "crypto-scanner",
      "timestamp": "2025-12-15T23:41:18.749Z",
      "tools": [
        "crypto-scanner"
      ],
      "duplicateCount": 1,
      "_fingerprint": "c9c51dcd58f3ba92",
      "_fingerprintSource": "cwe:CWE-330||cat:A02||title:weak random detected"
    },
    {
      "id": "VULN-029",
      "category": "A02",
      "cwe": "CWE-521",
      "cweName": "Weak Password Requirements",
      "severity": "MEDIUM",
      "title": "Weak password policy",
      "description": "Password field \"loginPassword\" has weak policy: no minimum length requirement (should be ‚â•8), no pattern for password complexity",
      "evidence": null,
      "remediation": null,
      "tool": "crypto-scanner",
      "tools": [
        "crypto-scanner"
      ],
      "duplicateCount": 2,
      "mergedFrom": [
        {
          "id": "VULN-034",
          "tool": "crypto-scanner",
          "severity": "MEDIUM"
        },
        {
          "id": "VULN-035",
          "tool": "crypto-scanner",
          "severity": "MEDIUM"
        }
      ],
      "timestamp": "2025-12-15T23:41:18.749Z",
      "confirmed": false,
      "_fingerprint": "f17a2819353daa70",
      "_fingerprintSource": "cwe:CWE-521||cat:A02||title:weak password policy"
    },
    {
      "id": "VULN-030",
      "category": "A03",
      "cwe": "CWE-434",
      "cweName": "Unrestricted Upload of File with Dangerous Type",
      "severity": "MEDIUM",
      "title": "Missing File Type Validation in Storage Rules",
      "description": "Storage rules do not validate file content type",
      "evidence": null,
      "remediation": "Add: && request.resource.contentType.matches('image/.*')",
      "tool": "static-analysis",
      "timestamp": "2025-12-15T23:40:02.327Z",
      "tools": [
        "static-analysis"
      ],
      "duplicateCount": 1,
      "_fingerprint": "7a89ddfe7772272a",
      "_fingerprintSource": "cwe:CWE-434||cat:A03||title:missing file type validation in storage rules"
    }
  ],
  "cweCoverage": {
    "A01_BrokenAccessControl": [
      "CWE-22",
      "CWE-23",
      "CWE-200",
      "CWE-201",
      "CWE-219",
      "CWE-264",
      "CWE-275",
      "CWE-276",
      "CWE-284",
      "CWE-285",
      "CWE-352",
      "CWE-359",
      "CWE-425",
      "CWE-441",
      "CWE-497",
      "CWE-538",
      "CWE-540",
      "CWE-548",
      "CWE-552",
      "CWE-566",
      "CWE-601",
      "CWE-639",
      "CWE-651",
      "CWE-668",
      "CWE-706",
      "CWE-862",
      "CWE-863",
      "CWE-913",
      "CWE-922",
      "CWE-1275"
    ],
    "A02_CryptographicFailures": [
      "CWE-261",
      "CWE-296",
      "CWE-310",
      "CWE-319",
      "CWE-321",
      "CWE-322",
      "CWE-323",
      "CWE-324",
      "CWE-325",
      "CWE-326",
      "CWE-327",
      "CWE-328",
      "CWE-329",
      "CWE-330",
      "CWE-331",
      "CWE-335",
      "CWE-336",
      "CWE-337",
      "CWE-338",
      "CWE-340",
      "CWE-347",
      "CWE-523",
      "CWE-757",
      "CWE-759",
      "CWE-760",
      "CWE-780",
      "CWE-818",
      "CWE-916"
    ],
    "A03_Injection": [
      "CWE-20",
      "CWE-74",
      "CWE-75",
      "CWE-77",
      "CWE-78",
      "CWE-79",
      "CWE-80",
      "CWE-83",
      "CWE-87",
      "CWE-88",
      "CWE-89",
      "CWE-90",
      "CWE-91",
      "CWE-93",
      "CWE-94",
      "CWE-95",
      "CWE-96",
      "CWE-97",
      "CWE-98",
      "CWE-99",
      "CWE-113",
      "CWE-116",
      "CWE-138",
      "CWE-184",
      "CWE-470",
      "CWE-471",
      "CWE-564",
      "CWE-610",
      "CWE-643",
      "CWE-644",
      "CWE-652",
      "CWE-917",
      "CWE-943"
    ]
  }
}