{"version":"1.144.1","results":[{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/Claude4/social-circle-web/app.js","start":{"line":158,"col":13,"offset":5091},"end":{"line":158,"col":29,"offset":5107},"extra":{"metavars":{"$USER":{"start":{"line":158,"col":13,"offset":5091},"end":{"line":158,"col":21,"offset":5099},"abstract_content":"userData","propagated_value":{"svalue_start":{"line":147,"col":26,"offset":4735},"svalue_end":{"line":147,"col":40,"offset":4749},"svalue_abstract_content":"userDoc.data()"}}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"3286c8cf12d23788f82f291651f1774ab31ab15b47bb0bbfca6e9f7885176b95419b3aaaeb0713a8135f1406afc1822c60795c3b980d4ffc94c6a85a4066405f_0","lines":"        if (userData.isAdmin) {","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/Claude4/social-circle-web/app.js","start":{"line":279,"col":5,"offset":9345},"end":{"line":306,"col":5,"offset":11101},"extra":{"metavars":{"$EL":{"start":{"line":279,"col":5,"offset":9345},"end":{"line":279,"col":9,"offset":9349},"abstract_content":"card"},"$INPUT":{"start":{"line":279,"col":22,"offset":9362},"end":{"line":306,"col":5,"offset":11101},"abstract_content":"`\n        <div class=\"post-header\">\n            <img src=\"post.userPhoto||'https://via.placeholder.com/48'\" alt=\"post.userName\" class=\"post-avatar\" onclick=\"viewUserProfile('post.userId')\">\n            <div class=\"post-info\">\n                <h4 onclick=\"viewUserProfile('post.userId')\" style=\"cursor: pointer;\">post.userName</h4>\n                <div class=\"post-time\">timestamp post.friendsOnly' üë• Friends only'''</div>\n            </div>\n        </div>\n        <div class=\"post-content\">post.content||''</div>\n        post.imageUrl`<img src=\"post.imageUrl\" alt=\"Post image\" class=\"post-image\">''\n        <div class=\"post-actions\">\n            <button class=\"action-btn isLiked'liked'''\" onclick=\"toggleLike('postId')\">\n                isLiked'‚ù§Ô∏è''ü§ç' <span>likeCount Likes</span>\n            </button>\n            <button class=\"action-btn\" onclick=\"toggleComments('postId')\">\n                üí¨ Comment\n            </button>\n            post.imageUrl`<a href=\"post.imageUrl\" download class=\"action-btn\">‚¨áÔ∏è Download</a>''\n            post.userId!==currentUser.uid`<button class=\"action-btn\" onclick=\"addFriendFromFeed('post.userId')\">‚ûï Add Friend</button>''\n        </div>\n        <div id=\"comments-postId\" class=\"comments-section\" style=\"display:none;\">\n            <div id=\"comments-list-postId\"></div>\n            <form onsubmit=\"addComment(event, 'postId')\" class=\"comment-form\">\n                <input type=\"text\" class=\"comment-input\" placeholder=\"Write a comment...\" required>\n                <button type=\"submit\" class=\"btn btn-primary btn-small\">Post</button>\n            </form>\n        </div>\n    "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"0aa52d3cf9e7c88cda19434a9a7b8e0f06531e7202a1db84597b896a160b2c86fa8d9d54ecb26fb88709f73406a0914b542f2a2deb869a5e0544db3ab2024b66_0","lines":"    card.innerHTML = `\n        <div class=\"post-header\">\n            <img src=\"${post.userPhoto || 'https://via.placeholder.com/48'}\" alt=\"${post.userName}\" class=\"post-avatar\" onclick=\"viewUserProfile('${post.userId}')\">\n            <div class=\"post-info\">\n                <h4 onclick=\"viewUserProfile('${post.userId}')\" style=\"cursor: pointer;\">${post.userName}</h4>\n                <div class=\"post-time\">${timestamp}${post.friendsOnly ? ' üë• Friends only' : ''}</div>\n            </div>\n        </div>\n        <div class=\"post-content\">${post.content || ''}</div>\n        ${post.imageUrl ? `<img src=\"${post.imageUrl}\" alt=\"Post image\" class=\"post-image\">` : ''}\n        <div class=\"post-actions\">\n            <button class=\"action-btn ${isLiked ? 'liked' : ''}\" onclick=\"toggleLike('${postId}')\">\n                ${isLiked ? '‚ù§Ô∏è' : 'ü§ç'} <span>${likeCount} Likes</span>\n            </button>\n            <button class=\"action-btn\" onclick=\"toggleComments('${postId}')\">\n                üí¨ Comment\n            </button>\n            ${post.imageUrl ? `<a href=\"${post.imageUrl}\" download class=\"action-btn\">‚¨áÔ∏è Download</a>` : ''}\n            ${post.userId !== currentUser.uid ? `<button class=\"action-btn\" onclick=\"addFriendFromFeed('${post.userId}')\">‚ûï Add Friend</button>` : ''}\n        </div>\n        <div id=\"comments-${postId}\" class=\"comments-section\" style=\"display:none;\">\n            <div id=\"comments-list-${postId}\"></div>\n            <form onsubmit=\"addComment(event, '${postId}')\" class=\"comment-form\">\n                <input type=\"text\" class=\"comment-input\" placeholder=\"Write a comment...\" required>\n                <button type=\"submit\" class=\"btn btn-primary btn-small\">Post</button>\n            </form>\n        </div>\n    `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/Claude4/social-circle-web/app.js","start":{"line":357,"col":13,"offset":12668},"end":{"line":360,"col":13,"offset":12838},"extra":{"metavars":{"$EL":{"start":{"line":357,"col":13,"offset":12668},"end":{"line":357,"col":22,"offset":12677},"abstract_content":"commentEl"},"$INPUT":{"start":{"line":357,"col":35,"offset":12690},"end":{"line":360,"col":13,"offset":12838},"abstract_content":"`\n                <div class=\"comment-author\">comment.userName</div>\n                <div class=\"comment-text\">comment.text</div>\n            "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"75fc3fd8f6a86b5ab5e01d6c7075920d25c04717c3a59e1dd2bc93d76d87b360390bba7c1ea18e98a49901bf1b417ef611e4e5bb72d31d02d86fbe15af80fa34_0","lines":"            commentEl.innerHTML = `\n                <div class=\"comment-author\">${comment.userName}</div>\n                <div class=\"comment-text\">${comment.text}</div>\n            `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.external-reference-script-src","path":"/home/nillof/Exjobb/Claude4/social-circle-web/app.js","start":{"line":400,"col":9,"offset":14043},"end":{"line":400,"col":109,"offset":14143},"extra":{"metavars":{"$SCRIPT":{"start":{"line":400,"col":9,"offset":14043},"end":{"line":400,"col":46,"offset":14080},"abstract_content":"document.getElementById('profilePic')"},"$URL":{"start":{"line":400,"col":53,"offset":14087},"end":{"line":400,"col":109,"offset":14143},"abstract_content":"userData.profilePic||'https://via.placeholder.com/150'"}},"message":"Dynamic script.src. CWE-610","metadata":{"cwe":"CWE-610","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"13615de143ab028e930cb21199be3ea80f6b339f6b81b234c8573689d0ccaa21b95016c534acc9c715d5a4d81990a0e8a526d98ed76a58407a328969bea48043_0","lines":"        document.getElementById('profilePic').src = userData.profilePic || 'https://via.placeholder.com/150';","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/Claude4/social-circle-web/app.js","start":{"line":462,"col":13,"offset":16350},"end":{"line":462,"col":86,"offset":16423},"extra":{"metavars":{"$EL":{"start":{"line":462,"col":13,"offset":16350},"end":{"line":462,"col":24,"offset":16361},"abstract_content":"galleryItem"},"$INPUT":{"start":{"line":462,"col":37,"offset":16374},"end":{"line":462,"col":86,"offset":16423},"abstract_content":"`<img src=\"item.imageUrl\" alt=\"Gallery photo\">"}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"31f978dac2cd3430ace5ca24fd67ab34d0fdab3066efb5d634704f7c661560f43ff973ce4c5aee51bc0fbe2fe68dd1f05f198995b1b67a8f6b93705c9c48b992_0","lines":"            galleryItem.innerHTML = `<img src=\"${item.imageUrl}\" alt=\"Gallery photo\">`;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/Claude4/social-circle-web/app.js","start":{"line":612,"col":5,"offset":21872},"end":{"line":621,"col":5,"offset":22555},"extra":{"metavars":{"$EL":{"start":{"line":612,"col":5,"offset":21872},"end":{"line":612,"col":9,"offset":21876},"abstract_content":"card"},"$INPUT":{"start":{"line":612,"col":22,"offset":21889},"end":{"line":621,"col":5,"offset":22555},"abstract_content":"`\n        <img src=\"userData.profilePic||'https://via.placeholder.com/100'\" alt=\"userData.displayName||userData.name\" class=\"friend-avatar\">\n        <h4>userData.displayName||userData.name</h4>\n        <p class=\"friend-info\">details.join(' ‚Ä¢ ')||'No details'</p>\n        isSuggestion`<button onclick=\"addFriend('userData.uid')\" class=\"btn btn-primary btn-small\">Add Friend</button>`<button onclick=\"viewUserProfile('userData.uid')\" class=\"btn btn-outline btn-small\">View Profile</button>\n             <button onclick=\"removeFriend('userData.uid')\" class=\"btn btn-small\">Remove</button>\n    "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"884b51464d08900e8e49d05de2aa3df30f35151c7d8395ae6252d0a419e7e31212d73f318893e0b463b224e2b446efc9218f6bf2444deed6bd78aea4ec5d30c2_0","lines":"    card.innerHTML = `\n        <img src=\"${userData.profilePic || 'https://via.placeholder.com/100'}\" alt=\"${userData.displayName || userData.name}\" class=\"friend-avatar\">\n        <h4>${userData.displayName || userData.name}</h4>\n        <p class=\"friend-info\">${details.join(' ‚Ä¢ ') || 'No details'}</p>\n        ${isSuggestion ? \n            `<button onclick=\"addFriend('${userData.uid}')\" class=\"btn btn-primary btn-small\">Add Friend</button>` :\n            `<button onclick=\"viewUserProfile('${userData.uid}')\" class=\"btn btn-outline btn-small\">View Profile</button>\n             <button onclick=\"removeFriend('${userData.uid}')\" class=\"btn btn-small\">Remove</button>`\n        }\n    `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/Claude4/social-circle-web/app.js","start":{"line":681,"col":17,"offset":24465},"end":{"line":684,"col":17,"offset":24777},"extra":{"metavars":{"$EL":{"start":{"line":681,"col":17,"offset":24465},"end":{"line":681,"col":33,"offset":24481},"abstract_content":"conversationItem"},"$INPUT":{"start":{"line":681,"col":46,"offset":24494},"end":{"line":684,"col":17,"offset":24777},"abstract_content":"`\n                    <img src=\"userData.profilePic||'https://via.placeholder.com/40'\" alt=\"userData.displayName||userData.name\" style=\"width: 40px; height: 40px; border-radius: 50%;\">\n                    <div>userData.displayName||userData.name</div>\n                "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"219d9ff2b8477f733a1157c5ac8f7dbcb1d9146f4b595628c13f47bc743e88be63c662ba15344a4c5aca9d984e251106e2f16ff534c708f929b78afcc4eaa3d8_0","lines":"                conversationItem.innerHTML = `\n                    <img src=\"${userData.profilePic || 'https://via.placeholder.com/40'}\" alt=\"${userData.displayName || userData.name}\" style=\"width: 40px; height: 40px; border-radius: 50%;\">\n                    <div>${userData.displayName || userData.name}</div>\n                `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/Claude4/social-circle-web/app.js","start":{"line":697,"col":5,"offset":25179},"end":{"line":697,"col":99,"offset":25273},"extra":{"metavars":{"$EL":{"start":{"line":697,"col":5,"offset":25179},"end":{"line":697,"col":45,"offset":25219},"abstract_content":"document.getElementById('messageHeader')"},"$INPUT":{"start":{"line":697,"col":58,"offset":25232},"end":{"line":697,"col":99,"offset":25273},"abstract_content":"`<h3>Conversation with friendName</h3>"}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"e400a4f2352beffead5409c2c2cb121b2fc3c030522b4baa3847ffebc4fe707a8d6abdf4a848a3551af73e2b685e2e768d8ee881aa0fd82f1c634e0021ddd031_0","lines":"    document.getElementById('messageHeader').innerHTML = `<h3>Conversation with ${friendName}</h3>`;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/Claude4/social-circle-web/app.js","start":{"line":812,"col":13,"offset":29059},"end":{"line":821,"col":13,"offset":29794},"extra":{"metavars":{"$EL":{"start":{"line":812,"col":13,"offset":29059},"end":{"line":812,"col":21,"offset":29067},"abstract_content":"userCard"},"$INPUT":{"start":{"line":812,"col":34,"offset":29080},"end":{"line":821,"col":13,"offset":29794},"abstract_content":"`\n                <img src=\"userData.profilePic||'https://via.placeholder.com/80'\" alt=\"userData.displayName||userData.name\" class=\"user-avatar\">\n                <h4>userData.displayName||userData.name</h4>\n                <p>userData.city||'Location not set'</p>\n                currentUser`<button onclick=\"addFriend('userData.uid')\" class=\"btn btn-primary btn-small\">Add Friend</button>\n                     <button onclick=\"viewUserProfile('userData.uid')\" class=\"btn btn-outline btn-small\">View Profile</button>`<button onclick=\"showLogin()\" class=\"btn btn-primary btn-small\">Login to Connect</button>\n            "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"a26bfcbd7f1f3765be01e4923453a5c974ee5bf5f2ce28704f7e1d289aca06045359604d043e52d1d6ca1ef4598f27dc58e3d15e6ac320405624ad5de6a02ee1_0","lines":"            userCard.innerHTML = `\n                <img src=\"${userData.profilePic || 'https://via.placeholder.com/80'}\" alt=\"${userData.displayName || userData.name}\" class=\"user-avatar\">\n                <h4>${userData.displayName || userData.name}</h4>\n                <p>${userData.city || 'Location not set'}</p>\n                ${currentUser ? \n                    `<button onclick=\"addFriend('${userData.uid}')\" class=\"btn btn-primary btn-small\">Add Friend</button>\n                     <button onclick=\"viewUserProfile('${userData.uid}')\" class=\"btn btn-outline btn-small\">View Profile</button>` :\n                    `<button onclick=\"showLogin()\" class=\"btn btn-primary btn-small\">Login to Connect</button>`\n                }\n            `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/Claude4/social-circle-web/app.js","start":{"line":843,"col":9,"offset":30504},"end":{"line":852,"col":9,"offset":31248},"extra":{"metavars":{"$EL":{"start":{"line":843,"col":9,"offset":30504},"end":{"line":843,"col":16,"offset":30511},"abstract_content":"content","propagated_value":{"svalue_start":{"line":836,"col":25,"offset":30232},"svalue_end":{"line":836,"col":70,"offset":30277},"svalue_abstract_content":"document.getElementById('viewProfileContent')"}},"$INPUT":{"start":{"line":843,"col":29,"offset":30524},"end":{"line":852,"col":9,"offset":31248},"abstract_content":"`\n            <div class=\"profile-banner userData.banner||'gradient1'\"></div>\n            <div style=\"text-align: center; margin-top: -60px;\">\n                <img src=\"userData.profilePic||'https://via.placeholder.com/150'\" alt=\"userData.displayName||userData.name\" style=\"width: 150px; height: 150px; border-radius: 50%; border: 5px solid white;\">\n                <h2>userData.displayName||userData.name</h2>\n                <p>details.join(' ‚Ä¢ ')||'No details'</p>\n                <p style=\"margin: 1rem 0;\">userData.about||'No bio'</p>\n                currentUser`<button onclick=\"addFriend('userId')\" class=\"btn btn-primary\">Add Friend</button>''\n            </div>\n        "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"8eec82478d888a1c261c9dad6b9bed7c26cf93c0c92572aeeb36c9503d04e324b197e37f9dabdeefc3c290a9e3b349a07ded9426acc336dec6a8489428b52f02_0","lines":"        content.innerHTML = `\n            <div class=\"profile-banner ${userData.banner || 'gradient1'}\"></div>\n            <div style=\"text-align: center; margin-top: -60px;\">\n                <img src=\"${userData.profilePic || 'https://via.placeholder.com/150'}\" alt=\"${userData.displayName || userData.name}\" style=\"width: 150px; height: 150px; border-radius: 50%; border: 5px solid white;\">\n                <h2>${userData.displayName || userData.name}</h2>\n                <p>${details.join(' ‚Ä¢ ') || 'No details'}</p>\n                <p style=\"margin: 1rem 0;\">${userData.about || 'No bio'}</p>\n                ${currentUser ? `<button onclick=\"addFriend('${userId}')\" class=\"btn btn-primary\">Add Friend</button>` : ''}\n            </div>\n        `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/Claude4/social-circle-web/app.js","start":{"line":951,"col":13,"offset":34261},"end":{"line":953,"col":13,"offset":34386},"extra":{"metavars":{"$EL":{"start":{"line":951,"col":13,"offset":34261},"end":{"line":951,"col":19,"offset":34267},"abstract_content":"codeEl"},"$INPUT":{"start":{"line":951,"col":32,"offset":34280},"end":{"line":953,"col":13,"offset":34386},"abstract_content":"`\n                <strong>code.code</strong> - code.used'‚úì Used''‚óã Available'\n            "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"5a1f8b1b1f6d5c64db49122d84057d6cc4ac233e6dc06e2007dbac7c063be679d26d1dc4334b6f40d15f4e4dc1f0c9f72fc4c7e00151d9601a4eae116e905bc4_0","lines":"            codeEl.innerHTML = `\n                <strong>${code.code}</strong> - ${code.used ? '‚úì Used' : '‚óã Available'}\n            `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/Claude4/social-circle-web/app.js","start":{"line":1079,"col":13,"offset":38356},"end":{"line":1087,"col":13,"offset":38786},"extra":{"metavars":{"$EL":{"start":{"line":1079,"col":13,"offset":38356},"end":{"line":1079,"col":21,"offset":38364},"abstract_content":"userItem"},"$INPUT":{"start":{"line":1079,"col":34,"offset":38377},"end":{"line":1087,"col":13,"offset":38786},"abstract_content":"`\n                <div>\n                    <strong>user.displayName||user.name</strong> - user.email\n                </div>\n                <div>\n                    <button onclick=\"makeAdmin('doc.id')\" class=\"btn btn-small\">Make Admin</button>\n                    <button onclick=\"deleteUserAdmin('doc.id')\" class=\"btn btn-danger btn-small\">Delete</button>\n                </div>\n            "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"96fea1a43a7db51923729ba0d0377d6ac4e0c3f1a5640048fd5c9613d9011ba0b428f98adfe6923bb80ef859b666fcfaa8c1a0f8ac6d8d502da5536061a9c71a_0","lines":"            userItem.innerHTML = `\n                <div>\n                    <strong>${user.displayName || user.name}</strong> - ${user.email}\n                </div>\n                <div>\n                    <button onclick=\"makeAdmin('${doc.id}')\" class=\"btn btn-small\">Make Admin</button>\n                    <button onclick=\"deleteUserAdmin('${doc.id}')\" class=\"btn btn-danger btn-small\">Delete</button>\n                </div>\n            `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/Claude4/social-circle-web/app.js","start":{"line":1100,"col":13,"offset":39307},"end":{"line":1105,"col":13,"offset":39580},"extra":{"metavars":{"$EL":{"start":{"line":1100,"col":13,"offset":39307},"end":{"line":1100,"col":22,"offset":39316},"abstract_content":"adminItem"},"$INPUT":{"start":{"line":1100,"col":35,"offset":39329},"end":{"line":1105,"col":13,"offset":39580},"abstract_content":"`\n                <div>\n                    <strong>admin.displayName||admin.name</strong> - admin.email\n                </div>\n                <button onclick=\"removeAdmin('doc.id')\" class=\"btn btn-small\">Remove Admin</button>\n            "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"fcc5b24afec4c76eb6401f0ff1640e553cc4428facd3f20a50bf78b35e6a166f679b68775f7fc80cc517b1521099b2158a54a5dcdc82fcf5206ae7987ef4c922_0","lines":"            adminItem.innerHTML = `\n                <div>\n                    <strong>${admin.displayName || admin.name}</strong> - ${admin.email}\n                </div>\n                <button onclick=\"removeAdmin('${doc.id}')\" class=\"btn btn-small\">Remove Admin</button>\n            `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/Claude4/social-circle-web/app.js","start":{"line":1118,"col":13,"offset":40108},"end":{"line":1123,"col":13,"offset":40392},"extra":{"metavars":{"$EL":{"start":{"line":1118,"col":13,"offset":40108},"end":{"line":1118,"col":21,"offset":40116},"abstract_content":"postItem"},"$INPUT":{"start":{"line":1118,"col":34,"offset":40129},"end":{"line":1123,"col":13,"offset":40392},"abstract_content":"`\n                <div>\n                    <strong>post.userName</strong>: post.content?.?.substring(0 50)...\n                </div>\n                <button onclick=\"deletePostAdmin('doc.id')\" class=\"btn btn-danger btn-small\">Delete</button>\n            "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"2fbd7638eaec592b50dd4d761f70e64504f3d903ebce11421b93e55be07dc6fae57aab7970b298f5f58ea39bb9366f083f08b6c21902567d3c61f60d0d851257_0","lines":"            postItem.innerHTML = `\n                <div>\n                    <strong>${post.userName}</strong>: ${post.content?.substring(0, 50)}...\n                </div>\n                <button onclick=\"deletePostAdmin('${doc.id}')\" class=\"btn btn-danger btn-small\">Delete</button>\n            `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/Claude4/social-circle-web/app.js","start":{"line":1293,"col":13,"offset":45634},"end":{"line":1294,"col":111,"offset":45797},"extra":{"metavars":{"$EL":{"start":{"line":1293,"col":13,"offset":45634},"end":{"line":1293,"col":52,"offset":45673},"abstract_content":"document.getElementById('imagePreview')"},"$INPUT":{"start":{"line":1294,"col":17,"offset":45703},"end":{"line":1294,"col":111,"offset":45797},"abstract_content":"`<img src=\"e.target.result\" style=\"max-width: 100%; border-radius: 8px; margin-top: 1rem;\">"}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"9b412f0ef05de5d5a61db89e9d61ca07f8aed0abae0ece2b10dde77d0eb3574b92e8c26bb246d2dc42aa70e93dcdcba66227b627edbb30fbfb86a9e0aed42122_0","lines":"            document.getElementById('imagePreview').innerHTML = \n                `<img src=\"${e.target.result}\" style=\"max-width: 100%; border-radius: 8px; margin-top: 1rem;\">`;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[],"paths":{"scanned":["/home/nillof/Exjobb/Claude4/social-circle-web/app.js","/home/nillof/Exjobb/Claude4/social-circle-web/config.js"]},"time":{"rules":[],"rules_parse_time":0.03881120681762695,"profiling_times":{"config_time":0.23119902610778809,"core_time":0.44198060035705566,"ignores_time":0.00014019012451171875,"total_time":0.6738502979278564},"parsing_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":0.20934796333312988,"per_file_time":{"mean":0.10467398166656494,"std_dev":0.006180966423485756},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"matching_time":{"total_time":0.0,"per_file_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.0,"per_def_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"fixpoint_timeouts":[],"prefiltering":{"project_level_time":0.0,"file_level_time":0.0,"rules_with_project_prefilters_ratio":0.0,"rules_with_file_prefilters_ratio":0.9788732394366197,"rules_selected_ratio":0.14084507042253522,"rules_matched_ratio":0.14084507042253522},"targets":[],"total_bytes":0,"max_memory_bytes":199324800},"engine_requested":"OSS","interfile_languages_used":[],"skipped_rules":[],"profiling_results":[]}