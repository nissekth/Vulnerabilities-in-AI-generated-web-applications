{"version":"1.144.1","results":[{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":178,"col":48,"offset":4900},"end":{"line":178,"col":72,"offset":4924},"extra":{"metavars":{"$USER":{"start":{"line":178,"col":48,"offset":4900},"end":{"line":178,"col":65,"offset":4917},"abstract_content":"currentUserData?."}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"6d35aea3bb091b02f8b10ec30b9af672bbf6e677c6377955c228842b951fc4307943ffc6f02aff8bd8fbdcc87dab116b5ed7a37679642b08d0edc753d1e2b6c4_0","lines":"  adminEls.forEach((el) => (el.style.display = currentUserData?.isAdmin ? \"inline-block\" : \"none\"));","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":315,"col":7,"offset":9675},"end":{"line":319,"col":7,"offset":9867},"extra":{"metavars":{"$EL":{"start":{"line":315,"col":7,"offset":9675},"end":{"line":315,"col":11,"offset":9679},"abstract_content":"card"},"$INPUT":{"start":{"line":315,"col":24,"offset":9692},"end":{"line":319,"col":7,"offset":9867},"abstract_content":"`\n        <strong>u.displayName</strong><br>\n        u.city||\"\" u.country||\"\"<br>\n        <button data-view-profile=\"u.uid\">View public profile</button>\n      "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"8ecf85ddacdcfc42a1d5bb87a87a64e6f37bee00a9107f128a5baf40e8cb6afbcaf0b3136c5ea4d6fda13263d4f1ea83ceb810883c686e3182d5e25511bbc173_0","lines":"      card.innerHTML = `\n        <strong>${u.displayName}</strong><br>\n        ${u.city || \"\"} ${u.country || \"\"}<br>\n        <button data-view-profile=\"${u.uid}\">View public profile</button>\n      `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":340,"col":3,"offset":10408},"end":{"line":344,"col":3,"offset":10539},"extra":{"metavars":{"$EL":{"start":{"line":340,"col":3,"offset":10408},"end":{"line":340,"col":12,"offset":10417},"abstract_content":"container","propagated_value":{"svalue_start":{"line":332,"col":21,"offset":10185},"svalue_end":{"line":332,"col":45,"offset":10209},"svalue_abstract_content":"$(\"public-profile-view\")"}},"$INPUT":{"start":{"line":340,"col":25,"offset":10430},"end":{"line":344,"col":3,"offset":10539},"abstract_content":"`\n    <h3>u.displayName</h3>\n    <p>u.about||\"\"</p>\n    <p>u.city||\"\", u.country||\"\"</p>\n  "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"86978d3daefe4103499ca32612ba10330a307a82af79f05029a632abdc38f659d72595ebe0562b12df3a2e1a943b1b26148c7b194605924e8a463cc3ccf0128b_0","lines":"  container.innerHTML = `\n    <h3>${u.displayName}</h3>\n    <p>${u.about || \"\"}</p>\n    <p>${u.city || \"\"}, ${u.country || \"\"}</p>\n  `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":362,"col":5,"offset":11058},"end":{"line":365,"col":5,"offset":11194},"extra":{"metavars":{"$EL":{"start":{"line":362,"col":5,"offset":11058},"end":{"line":362,"col":7,"offset":11060},"abstract_content":"el"},"$INPUT":{"start":{"line":362,"col":20,"offset":11073},"end":{"line":365,"col":5,"offset":11194},"abstract_content":"`\n      <div>post.text</div>\n      post.imageUrl`<img src=\"post.imageUrl\" class=\"gallery-photo\" />\"\"\n    "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"d2fa1da490c46026ea1322b18ad7664d31481fc7f2357704b366bb4960f581d7aa97600700a7501547b0544704244848a7b430e7f601f473281d4c5795149cac_0","lines":"    el.innerHTML = `\n      <div>${post.text}</div>\n      ${post.imageUrl ? `<img src=\"${post.imageUrl}\" class=\"gallery-photo\" />` : \"\"}\n    `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.firebase-upload","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":390,"col":13,"offset":12070},"end":{"line":390,"col":35,"offset":12092},"extra":{"metavars":{"$REF":{"start":{"line":390,"col":25,"offset":12082},"end":{"line":390,"col":28,"offset":12085},"abstract_content":"ref","propagated_value":{"svalue_start":{"line":389,"col":19,"offset":11999},"svalue_end":{"line":389,"col":76,"offset":12056},"svalue_abstract_content":"storageRef(storage`profilePictures/currentUser.uid)"}},"$FILE":{"start":{"line":390,"col":30,"offset":12087},"end":{"line":390,"col":34,"offset":12091},"abstract_content":"file","propagated_value":{"svalue_start":{"line":388,"col":20,"offset":11961},"svalue_end":{"line":388,"col":38,"offset":11979},"svalue_abstract_content":"fileInput.files[0]"}}},"message":"File upload. CWE-434","metadata":{"cwe":"CWE-434","owasp":"A03:2021"},"severity":"INFO","fingerprint":"7201406daec5e8d086c9350b21641bab8802a6fceeb62ad60db623dec100a25567bd4968d70b3c4cf9b5d7c4a34d58368b855ea536288a3db21a3e1df7b54414_0","lines":"      await uploadBytes(ref, file);","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":440,"col":3,"offset":13379},"end":{"line":450,"col":3,"offset":13727},"extra":{"metavars":{"$EL":{"start":{"line":440,"col":3,"offset":13379},"end":{"line":440,"col":6,"offset":13382},"abstract_content":"div","propagated_value":{"svalue_start":{"line":427,"col":15,"offset":13099},"svalue_end":{"line":427,"col":38,"offset":13122},"svalue_abstract_content":"$(\"my-profile-preview\")"}},"$INPUT":{"start":{"line":440,"col":19,"offset":13395},"end":{"line":450,"col":3,"offset":13727},"abstract_content":"`\n    <div class=\"bannerClass\"></div>\n    <div>\n      u.photoUrl`<img src=\"u.photoUrl\" class=\"gallery-photo\" />\"\"\n      <h3>u.displayName</h3>\n      <p>u.realName||\"\"</p>\n      <p>u.age`Age: u.age\"\"</p>\n      <p>u.city||\"\", u.country||\"\"</p>\n      <p>u.about||\"\"</p>\n    </div>\n  "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"7f7f1b0aba6426cc7e4081f72fbdc532c384bed164eb316abd52b00441ecdcf97ed11dfa450cab40fd470d5b196f1f24179e3b9e19a6206da00a66aa2281f78b_0","lines":"  div.innerHTML = `\n    <div class=\"${bannerClass}\"></div>\n    <div>\n      ${u.photoUrl ? `<img src=\"${u.photoUrl}\" class=\"gallery-photo\" />` : \"\"}\n      <h3>${u.displayName}</h3>\n      <p>${u.realName || \"\"}</p>\n      <p>${u.age ? `Age: ${u.age}` : \"\"}</p>\n      <p>${u.city || \"\"}, ${u.country || \"\"}</p>\n      <p>${u.about || \"\"}</p>\n    </div>\n  `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":463,"col":5,"offset":14102},"end":{"line":463,"col":81,"offset":14178},"extra":{"metavars":{"$EL":{"start":{"line":463,"col":5,"offset":14102},"end":{"line":463,"col":8,"offset":14105},"abstract_content":"div","propagated_value":{"svalue_start":{"line":462,"col":17,"offset":14067},"svalue_end":{"line":462,"col":46,"offset":14096},"svalue_abstract_content":"document.createElement(\"div\")"}},"$INPUT":{"start":{"line":463,"col":21,"offset":14118},"end":{"line":463,"col":81,"offset":14178},"abstract_content":"`<h4>Album: album.name</h4><div id=\"album-a.id\"></div>"}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"2f8a2ff2e55ecca75781827344778723f243ed656a87c97a4b46c84c58c4c60512f502ff4a66c28c93c3950741583a3ad2d0ee2c1b8b51c1013b5269553e788b_0","lines":"    div.innerHTML = `<h4>Album: ${album.name}</h4><div id=\"album-${a.id}\"></div>`;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.firebase-upload","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":556,"col":13,"offset":17666},"end":{"line":556,"col":35,"offset":17688},"extra":{"metavars":{"$REF":{"start":{"line":556,"col":25,"offset":17678},"end":{"line":556,"col":28,"offset":17681},"abstract_content":"ref","propagated_value":{"svalue_start":{"line":555,"col":19,"offset":17573},"svalue_end":{"line":555,"col":98,"offset":17652},"svalue_abstract_content":"storageRef(storage`postImages/currentUser.uid/Date.now()-file.name)"}},"$FILE":{"start":{"line":556,"col":30,"offset":17683},"end":{"line":556,"col":34,"offset":17687},"abstract_content":"file","propagated_value":{"svalue_start":{"line":554,"col":20,"offset":17535},"svalue_end":{"line":554,"col":38,"offset":17553},"svalue_abstract_content":"fileInput.files[0]"}}},"message":"File upload. CWE-434","metadata":{"cwe":"CWE-434","owasp":"A03:2021"},"severity":"INFO","fingerprint":"7201406daec5e8d086c9350b21641bab8802a6fceeb62ad60db623dec100a25567bd4968d70b3c4cf9b5d7c4a34d58368b855ea536288a3db21a3e1df7b54414_1","lines":"      await uploadBytes(ref, file);","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":602,"col":5,"offset":19160},"end":{"line":613,"col":5,"offset":19792},"extra":{"metavars":{"$EL":{"start":{"line":602,"col":5,"offset":19160},"end":{"line":602,"col":8,"offset":19163},"abstract_content":"div"},"$INPUT":{"start":{"line":602,"col":21,"offset":19176},"end":{"line":613,"col":5,"offset":19792},"abstract_content":"`\n      <strong>post.authorName</strong> (post.visibility)<br>\n      <span>post.text</span><br>\n      post.imageUrl`<img src=\"post.imageUrl\" class=\"gallery-photo\" />\"\"\n      <div class=\"post-actions\">\n        <button data-like=\"docSnap.id\">Like (post.likeCount||0)</button>\n        <button data-comment=\"docSnap.id\">Comment</button>\n        <button data-add-friend=\"post.authorId\">Add friend</button>\n        post.imageUrl`<button data-download=\"post.imageUrl\">Download image</button>\"\"\n      </div>\n      <div class=\"comments\" id=\"comments-docSnap.id\"></div>\n    "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"815b862e52b1ea15eca7aa207406f622727b4ba3277b1c36c3cb25efe655069c59a561e7d249a7bc28e183db607bcbdea66f2c77db9566d4c3b0adb2a9732a92_0","lines":"    div.innerHTML = `\n      <strong>${post.authorName}</strong> (${post.visibility})<br>\n      <span>${post.text}</span><br>\n      ${post.imageUrl ? `<img src=\"${post.imageUrl}\" class=\"gallery-photo\" />` : \"\"}\n      <div class=\"post-actions\">\n        <button data-like=\"${docSnap.id}\">Like (${post.likeCount || 0})</button>\n        <button data-comment=\"${docSnap.id}\">Comment</button>\n        <button data-add-friend=\"${post.authorId}\">Add friend</button>\n        ${post.imageUrl ? `<button data-download=\"${post.imageUrl}\">Download image</button>` : \"\"}\n      </div>\n      <div class=\"comments\" id=\"comments-${docSnap.id}\"></div>\n    `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":648,"col":5,"offset":20930},"end":{"line":648,"col":58,"offset":20983},"extra":{"metavars":{"$EL":{"start":{"line":648,"col":5,"offset":20930},"end":{"line":648,"col":8,"offset":20933},"abstract_content":"div","propagated_value":{"svalue_start":{"line":647,"col":17,"offset":20895},"svalue_end":{"line":647,"col":46,"offset":20924},"svalue_abstract_content":"document.createElement(\"div\")"}},"$INPUT":{"start":{"line":648,"col":21,"offset":20946},"end":{"line":648,"col":58,"offset":20983},"abstract_content":"`<em>cm.authorName:</em> cm.text"}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"bfb2451a8e0a951a83b2fc1437043be7ad27196deaf3be3cc6d25ec54e0eb7b6ed33652157173cf2503b21c0bc14400bca0a70d9c4f52bd4dad131db55c2423c_0","lines":"    div.innerHTML = `<em>${cm.authorName}:</em> ${cm.text}`;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":716,"col":5,"offset":23049},"end":{"line":723,"col":5,"offset":23307},"extra":{"metavars":{"$EL":{"start":{"line":716,"col":5,"offset":23049},"end":{"line":716,"col":8,"offset":23052},"abstract_content":"div"},"$INPUT":{"start":{"line":716,"col":21,"offset":23065},"end":{"line":723,"col":5,"offset":23307},"abstract_content":"`\n      <strong>u.displayName</strong><br>\n      u.realName||\"\"<br>\n      u.age`Age: u.age\"\"<br>\n      u.city||\"\", u.country||\"\"<br>\n      UID: u.uid<br>\n      <button data-dm=\"u.uid\">Open DM</button>\n    "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"e9d16348bf5f6a65dfe3f1e4931a2f3eed674eaea08ce7c593a69752c612f31d492917452c3dbcce20216b61ebc222d42362fbd760fea957b268d88587d2ed9c_0","lines":"    div.innerHTML = `\n      <strong>${u.displayName}</strong><br>\n      ${u.realName || \"\"}<br>\n      ${u.age ? `Age: ${u.age}` : \"\"}<br>\n      ${u.city || \"\"}, ${u.country || \"\"}<br>\n      UID: ${u.uid}<br>\n      <button data-dm=\"${u.uid}\">Open DM</button>\n    `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":743,"col":5,"offset":24022},"end":{"line":746,"col":5,"offset":24187},"extra":{"metavars":{"$EL":{"start":{"line":743,"col":5,"offset":24022},"end":{"line":743,"col":8,"offset":24025},"abstract_content":"div"},"$INPUT":{"start":{"line":743,"col":21,"offset":24038},"end":{"line":746,"col":5,"offset":24187},"abstract_content":"`\n      <strong>u.displayName</strong> (u.city||\"\", u.country||\"\")<br>\n      <button data-add-friend=\"u.uid\">Add friend</button>\n    "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"225366d5f95d935ddb2aa5f3b73349aafcf4f70de56e484203419c5bb488b2f59185b414f19102e06daace957b94175e7b53e9fa08d55d0a182b7158daa885f0_0","lines":"    div.innerHTML = `\n      <strong>${u.displayName}</strong> (${u.city || \"\"}, ${u.country || \"\"})<br>\n      <button data-add-friend=\"${u.uid}\">Add friend</button>\n    `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":813,"col":5,"offset":26252},"end":{"line":813,"col":68,"offset":26315},"extra":{"metavars":{"$EL":{"start":{"line":813,"col":5,"offset":26252},"end":{"line":813,"col":8,"offset":26255},"abstract_content":"div","propagated_value":{"svalue_start":{"line":812,"col":17,"offset":26217},"svalue_end":{"line":812,"col":46,"offset":26246},"svalue_abstract_content":"document.createElement(\"div\")"}},"$INPUT":{"start":{"line":813,"col":21,"offset":26268},"end":{"line":813,"col":68,"offset":26315},"abstract_content":"`<strong>msg.authorName:</strong> msg.text"}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"3b34de23df887699a0bd6c1bce9bda147eb7dfe91fde050112be1bc5aa9ecc3001f79b645ff7ed3109fcdb4079d876dde8f39a14e57f6b8b3d8b312f8457cdfa_0","lines":"    div.innerHTML = `<strong>${msg.authorName}:</strong> ${msg.text}`;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":841,"col":8,"offset":27099},"end":{"line":841,"col":32,"offset":27123},"extra":{"metavars":{"$USER":{"start":{"line":841,"col":8,"offset":27099},"end":{"line":841,"col":25,"offset":27116},"abstract_content":"currentUserData?."}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"6d35aea3bb091b02f8b10ec30b9af672bbf6e677c6377955c228842b951fc4307943ffc6f02aff8bd8fbdcc87dab116b5ed7a37679642b08d0edc753d1e2b6c4_1","lines":"  if (!currentUserData?.isAdmin && !currentUserData?.isOwner) return;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":851,"col":5,"offset":27490},"end":{"line":857,"col":5,"offset":27779},"extra":{"metavars":{"$EL":{"start":{"line":851,"col":5,"offset":27490},"end":{"line":851,"col":8,"offset":27493},"abstract_content":"div"},"$INPUT":{"start":{"line":851,"col":21,"offset":27506},"end":{"line":857,"col":5,"offset":27779},"abstract_content":"`\n      <strong>u.displayName</strong> u.isAdmin\"(Admin)\"\"\" u.isOwner\"(Owner)\"\"\"<br>\n      Email: u.email<br>\n      UID: u.uid<br>\n      Disabled: u.disabled\"Yes\"\"No\"<br>\n      <button data-disable=\"u.uid\">Toggle disable</button>\n    "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"ff0fbc1355c9e72ec16717b4c8645097a8385053e6eaa0163f546fb248744d75de7a9925f476185ab92fea0acadaf3d531bf3a5b455c20c07f45abdbb6f3b13b_0","lines":"    div.innerHTML = `\n      <strong>${u.displayName}</strong> ${u.isAdmin ? \"(Admin)\" : \"\"} ${u.isOwner ? \"(Owner)\" : \"\"}<br>\n      Email: ${u.email}<br>\n      UID: ${u.uid}<br>\n      Disabled: ${u.disabled ? \"Yes\" : \"No\"}<br>\n      <button data-disable=\"${u.uid}\">Toggle disable</button>\n    `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":852,"col":43,"offset":27550},"end":{"line":852,"col":52,"offset":27559},"extra":{"metavars":{"$USER":{"start":{"line":852,"col":43,"offset":27550},"end":{"line":852,"col":44,"offset":27551},"abstract_content":"u","propagated_value":{"svalue_start":{"line":848,"col":15,"offset":27392},"svalue_end":{"line":848,"col":27,"offset":27404},"svalue_abstract_content":"uSnap.data()"}}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"681c9c5fc3668940324c863499f72afed197589a62f5e4dd4fd36209048d67d14cd36599ddd0b73baf927a1ee3bb97c658265fc0428a9b17131edbc88910d2e7_0","lines":"      <strong>${u.displayName}</strong> ${u.isAdmin ? \"(Admin)\" : \"\"} ${u.isOwner ? \"(Owner)\" : \"\"}<br>","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":886,"col":5,"offset":28702},"end":{"line":890,"col":5,"offset":28871},"extra":{"metavars":{"$EL":{"start":{"line":886,"col":5,"offset":28702},"end":{"line":886,"col":8,"offset":28705},"abstract_content":"div"},"$INPUT":{"start":{"line":886,"col":21,"offset":28718},"end":{"line":890,"col":5,"offset":28871},"abstract_content":"`\n      <strong>p.authorName</strong> (p.visibility)<br>\n      p.text<br>\n      <button data-delete-post=\"pSnap.id\">Delete post</button>\n    "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"946db81461a42833cf82ecd2acefe3f3c8b83aaab2fe75a7549650648d716014b1a912d123697122fa7aa50d67e238c4ea8773cdc3202744e858d587978d2088_0","lines":"    div.innerHTML = `\n      <strong>${p.authorName}</strong> (${p.visibility})<br>\n      ${p.text}<br>\n      <button data-delete-post=\"${pSnap.id}\">Delete post</button>\n    `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.firebase-no-auth-deletedoc","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":898,"col":13,"offset":29114},"end":{"line":898,"col":48,"offset":29149},"extra":{"metavars":{"$DB":{"start":{"line":898,"col":27,"offset":29128},"end":{"line":898,"col":29,"offset":29130},"abstract_content":"db","propagated_value":{"svalue_start":{"line":49,"col":12,"offset":1226},"svalue_end":{"line":51,"col":3,"offset":1313},"svalue_abstract_content":"initializeFirestore(app{experimentalForceLongPolling true})"}},"$COLL":{"start":{"line":898,"col":31,"offset":29132},"end":{"line":898,"col":38,"offset":29139},"abstract_content":"\"posts\""},"$ID":{"start":{"line":898,"col":40,"offset":29141},"end":{"line":898,"col":46,"offset":29147},"abstract_content":"postId","propagated_value":{"svalue_start":{"line":896,"col":22,"offset":29024},"svalue_end":{"line":896,"col":49,"offset":29051},"svalue_abstract_content":"e.target.dataset.deletePost"}}},"message":"Firestore deleteDoc without auth check. CWE-284","metadata":{"cwe":"CWE-284","owasp":"A01:2021"},"severity":"WARNING","fingerprint":"9448250abdcf71d90d84a1d8d40e84ea1a5f283764b695bc42135d6cc28a734eef1650702cc45e274113f6549a3e254f6167d109f5a99766fbedc8370e7eded7_0","lines":"      await deleteDoc(doc(db, \"posts\", postId));","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.firebase-no-auth-setdoc","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":910,"col":11,"offset":29468},"end":{"line":913,"col":7,"offset":29588},"extra":{"metavars":{"$DB":{"start":{"line":910,"col":22,"offset":29479},"end":{"line":910,"col":24,"offset":29481},"abstract_content":"db","propagated_value":{"svalue_start":{"line":49,"col":12,"offset":1226},"svalue_end":{"line":51,"col":3,"offset":1313},"svalue_abstract_content":"initializeFirestore(app{experimentalForceLongPolling true})"}},"$COLL":{"start":{"line":910,"col":26,"offset":29483},"end":{"line":910,"col":40,"offset":29497},"abstract_content":"\"siteSettings\""},"$ID":{"start":{"line":910,"col":42,"offset":29499},"end":{"line":910,"col":57,"offset":29514},"abstract_content":"\"ownerSettings\""},"$DATA":{"start":{"line":910,"col":60,"offset":29517},"end":{"line":913,"col":6,"offset":29587},"abstract_content":"{siteDisabled disabled updatedAt Timestamp.now()}"}},"message":"Firestore setDoc without auth check. CWE-284","metadata":{"cwe":"CWE-284","owasp":"A01:2021"},"severity":"WARNING","fingerprint":"216c41ee3b8402f10c6898fb7d3673448c6fa83dd09aa3d516f1f0e9eba9ca2be02599a2172b57d0567069fc7448c105a59723a685ab69b800302bdef8f632f9_0","lines":"    await setDoc(doc(db, \"siteSettings\", \"ownerSettings\"), {\n      siteDisabled: disabled,\n      updatedAt: Timestamp.now()\n    });","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":930,"col":9,"offset":30010},"end":{"line":930,"col":25,"offset":30026},"extra":{"metavars":{"$USER":{"start":{"line":930,"col":9,"offset":30010},"end":{"line":930,"col":17,"offset":30018},"abstract_content":"u.data()"}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"352c14cdf4fb4ab43841ff7a3d8ad144d4b90a902a7e2c1e3ab5d8fce83d3758757d7c02c61897b5fb8192782a69b90e476e3437be1a9d0cf78087c1e462c349_0","lines":"    if (u.data().isAdmin) totalAdmins++;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":939,"col":3,"offset":30285},"end":{"line":944,"col":3,"offset":30483},"extra":{"metavars":{"$EL":{"start":{"line":939,"col":3,"offset":30285},"end":{"line":939,"col":11,"offset":30293},"abstract_content":"statsDiv"},"$INPUT":{"start":{"line":939,"col":24,"offset":30306},"end":{"line":944,"col":3,"offset":30483},"abstract_content":"`\n    <p>Total users: totalUsers</p>\n    <p>Total admins: totalAdmins</p>\n    <p>Total posts: totalPosts</p>\n    <p>Site disabled: siteDisabled\"Yes\"\"No\"</p>\n  "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"3b6a3b2229ecdc1f312aae2c3a2b12065ee650d52844f5ab3250c3be7134e717e0053451dd2b636afe87e462484f1aef17504c45747091732fdb43fd66f290c5_0","lines":"  statsDiv.innerHTML = `\n    <p>Total users: ${totalUsers}</p>\n    <p>Total admins: ${totalAdmins}</p>\n    <p>Total posts: ${totalPosts}</p>\n    <p>Site disabled: ${siteDisabled ? \"Yes\" : \"No\"}</p>\n  `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT4/my-social-app/public/app.js","start":{"line":1018,"col":5,"offset":33038},"end":{"line":1022,"col":5,"offset":33192},"extra":{"metavars":{"$EL":{"start":{"line":1018,"col":5,"offset":33038},"end":{"line":1018,"col":8,"offset":33041},"abstract_content":"div","propagated_value":{"svalue_start":{"line":1017,"col":17,"offset":33003},"svalue_end":{"line":1017,"col":46,"offset":33032},"svalue_abstract_content":"document.createElement(\"div\")"}},"$INPUT":{"start":{"line":1018,"col":21,"offset":33054},"end":{"line":1022,"col":5,"offset":33192},"abstract_content":"`\n      Code: c.id<br>\n      Created: d.createdAt.toDate().toLocaleString()<br>\n      Used by: d.usedBy||[].length users\n    "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"ac54e3f0f7335482864af198d2d901e0367aa53598058392b983fe92d33466590881da18684b0b50c58cb60f570f63fef9ec1fa2b9f80c2945d42a8701a392e9_0","lines":"    div.innerHTML = `\n      Code: ${c.id}<br>\n      Created: ${d.createdAt.toDate().toLocaleString()}<br>\n      Used by: ${(d.usedBy || []).length} users\n    `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[],"paths":{"scanned":["/home/nillof/Exjobb/GPT4/my-social-app/public/app.js"]},"time":{"rules":[],"rules_parse_time":0.03966808319091797,"profiling_times":{"config_time":0.20938324928283691,"core_time":0.5108327865600586,"ignores_time":0.0001938343048095703,"total_time":0.7209389209747314},"parsing_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":0.24280691146850586,"per_file_time":{"mean":0.24280691146850586,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"matching_time":{"total_time":0.0,"per_file_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.0,"per_def_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"fixpoint_timeouts":[],"prefiltering":{"project_level_time":0.0,"file_level_time":0.0,"rules_with_project_prefilters_ratio":0.0,"rules_with_file_prefilters_ratio":0.9788732394366197,"rules_selected_ratio":0.1619718309859155,"rules_matched_ratio":0.1619718309859155},"targets":[],"total_bytes":0,"max_memory_bytes":177370368},"engine_requested":"OSS","interfile_languages_used":[],"skipped_rules":[],"profiling_results":[]}