{
  "metadata": {
    "scanDate": "2025-12-15T15:21:26.928Z",
    "duration": "99s",
    "target": "https://gpt-4-aa300.firebaseapp.com",
    "appName": "Social Media App",
    "projectId": "gpt-4-aa300",
    "scope": "OWASP Top 10:2021 A01-A03"
  },
  "summary": {
    "total": 35,
    "bySeverity": {
      "CRITICAL": 1,
      "HIGH": 26,
      "MEDIUM": 7,
      "LOW": 1,
      "INFO": 0
    },
    "byCategory": {
      "A01": 15,
      "A02": 4,
      "A03": 16
    },
    "byTool": {
      "static-analysis": 6,
      "firebase-emulator": 5,
      "semgrep": 21,
      "crypto-scanner": 3
    },
    "riskScore": 155,
    "riskLevel": "CRITICAL",
    "deduplication": {
      "originalCount": 45,
      "deduplicatedCount": 35,
      "duplicatesRemoved": 10,
      "reductionPercent": 22
    }
  },
  "findings": [
    {
      "id": "VULN-001",
      "category": "A01",
      "cwe": "CWE-285",
      "cweName": "Improper Authorization",
      "severity": "CRITICAL",
      "title": "Authorization Bypass - No Owner Verification",
      "description": "Rule only checks authentication, not authorization. Any authenticated user can modify any document.",
      "evidence": {
        "rule": "allow write: if request.auth != null;"
      },
      "remediation": "Add owner check: allow update: if request.auth != null && request.auth.uid == userId",
      "tool": "static-analysis",
      "timestamp": "2025-12-15T15:19:47.496Z",
      "tools": [
        "static-analysis"
      ],
      "duplicateCount": 1,
      "_fingerprint": "55bb57f861d69e4d",
      "_fingerprintSource": "cwe:CWE-285||cat:A01||loc:rule:allow write: if request.auth != null;||vuln:rule:allow write: if request.auth != null;||title:authorization bypass - no owner verification"
    },
    {
      "id": "VULN-002",
      "category": "A01",
      "cwe": "CWE-200",
      "cweName": "Exposure of Sensitive Information",
      "severity": "HIGH",
      "title": "User Enumeration via Collection Listing",
      "description": "Unauthenticated users can list/enumerate user documents, exposing user data.",
      "evidence": "Unauthenticated list query on /users succeeded",
      "remediation": "Prevent listing: require authentication and consider restricting list queries",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T15:19:53.455Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "a1ba02402a01e8b1",
      "_fingerprintSource": "cwe:CWE-200||cat:A01||title:user enumeration via collection listing"
    },
    {
      "id": "VULN-003",
      "category": "A01",
      "cwe": "CWE-284",
      "cweName": "Improper Access Control",
      "severity": "HIGH",
      "title": "Unrestricted Read Access",
      "description": "Rule allows anyone to read data without authentication",
      "evidence": {
        "rule": "allow read: if true"
      },
      "remediation": "Change to: allow read: if request.auth != null",
      "tool": "static-analysis",
      "tools": [
        "static-analysis"
      ],
      "duplicateCount": 7,
      "mergedFrom": [
        {
          "id": "VULN-001",
          "tool": "static-analysis",
          "severity": "HIGH"
        },
        {
          "id": "VULN-002",
          "tool": "static-analysis",
          "severity": "HIGH"
        },
        {
          "id": "VULN-003",
          "tool": "static-analysis",
          "severity": "HIGH"
        },
        {
          "id": "VULN-004",
          "tool": "static-analysis",
          "severity": "HIGH"
        },
        {
          "id": "VULN-005",
          "tool": "static-analysis",
          "severity": "HIGH"
        },
        {
          "id": "VULN-006",
          "tool": "static-analysis",
          "severity": "HIGH"
        },
        {
          "id": "VULN-007",
          "tool": "static-analysis",
          "severity": "HIGH"
        }
      ],
      "timestamp": "2025-12-15T15:19:47.496Z",
      "confirmed": false,
      "_fingerprint": "c840b8d7ff27a8ee",
      "_fingerprintSource": "cwe:CWE-284||cat:A01||loc:rule:allow read: if true||vuln:rule:allow read: if true||title:unrestricted read access"
    },
    {
      "id": "VULN-004",
      "category": "A01",
      "cwe": "CWE-284",
      "cweName": "Improper Access Control",
      "severity": "HIGH",
      "title": "Message Injection Possible",
      "description": "Message creation does not validate that sender is in participants list",
      "evidence": {
        "collection": "messages"
      },
      "remediation": "Add: && request.auth.uid in request.resource.data.participants && request.resource.data.senderId == request.auth.uid",
      "tool": "static-analysis",
      "timestamp": "2025-12-15T15:19:47.496Z",
      "tools": [
        "static-analysis"
      ],
      "duplicateCount": 1,
      "_fingerprint": "89224ff3b74f6de2",
      "_fingerprintSource": "cwe:CWE-284||cat:A01||loc:collection:messages||title:message injection possible"
    },
    {
      "id": "VULN-005",
      "category": "A01",
      "cwe": "CWE-284",
      "cweName": "Improper Access Control",
      "severity": "HIGH",
      "title": "Unauthenticated Read Access to User Data",
      "description": "Firestore rules allow unauthenticated users to read user documents. This exposes potentially sensitive user information to anyone.",
      "evidence": "Unauthenticated read on /users/{userId} succeeded",
      "remediation": "Add authentication check: allow read: if request.auth != null",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T15:19:53.455Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "cc5cee82832a3308",
      "_fingerprintSource": "cwe:CWE-284||cat:A01||title:unauthenticated read access to user data"
    },
    {
      "id": "VULN-006",
      "category": "A01",
      "cwe": "CWE-639",
      "cweName": "IDOR",
      "severity": "HIGH",
      "title": "IDOR Vulnerability on User Profiles",
      "description": "Users can access other users' profiles by simply changing the document ID in the request.",
      "evidence": "alice123 accessed bob456's profile by changing document ID",
      "remediation": "Restrict reads to own profile: allow read: if request.auth.uid == userId",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T15:19:53.455Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "8116391c3befc481",
      "_fingerprintSource": "cwe:CWE-639||cat:A01||title:idor vulnerability on user profiles"
    },
    {
      "id": "VULN-007",
      "category": "A01",
      "cwe": "CWE-862",
      "cweName": "Missing Authorization",
      "severity": "HIGH",
      "title": "Missing Creator Validation",
      "description": "Create operation only requires authentication. Should validate resource data matches authenticated user.",
      "evidence": {
        "rule": "allow create: if request.auth != null;"
      },
      "remediation": "Add: && request.resource.data.userId == request.auth.uid",
      "tool": "static-analysis",
      "tools": [
        "static-analysis"
      ],
      "duplicateCount": 2,
      "mergedFrom": [
        {
          "id": "VULN-009",
          "tool": "static-analysis",
          "severity": "HIGH"
        },
        {
          "id": "VULN-010",
          "tool": "static-analysis",
          "severity": "HIGH"
        }
      ],
      "timestamp": "2025-12-15T15:19:47.496Z",
      "confirmed": false,
      "_fingerprint": "5c043fda4d5cdb55",
      "_fingerprintSource": "cwe:CWE-862||cat:A01||loc:rule:allow create: if request.auth != null;||vuln:rule:allow create: if request.auth != null;||title:missing creator validation"
    },
    {
      "id": "VULN-008",
      "category": "A01",
      "cwe": "CWE-863",
      "cweName": "Incorrect Authorization",
      "severity": "HIGH",
      "title": "client-side-isadmin",
      "description": "Client-side admin check. CWE-863",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT4/my-social-app/public/app.js",
        "line": 178,
        "endLine": 178,
        "code": "adminEls.forEach((el) => (el.style.display = currentUserData?.isAdmin ? \"inline-block\" : \"none\"));"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:19:56.959Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "3f0a1c91efdb4722",
      "_fingerprintSource": "cwe:CWE-863||cat:A01||loc:file:/home/nillof/Exjobb/GPT4/my-social-app/public/app.js|line:178||vuln:code:adminels.foreach((el) => (el.style.display = currentuserdata?.isadmin ? inline-b||title:client-side-isadmin"
    },
    {
      "id": "VULN-009",
      "category": "A01",
      "cwe": "CWE-863",
      "cweName": "Incorrect Authorization",
      "severity": "HIGH",
      "title": "client-side-isadmin",
      "description": "Client-side admin check. CWE-863",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT4/my-social-app/public/app.js",
        "line": 841,
        "endLine": 841,
        "code": "if (!currentUserData?.isAdmin && !currentUserData?.isOwner) return;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:19:56.963Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "48b7cb606b6e386a",
      "_fingerprintSource": "cwe:CWE-863||cat:A01||loc:file:/home/nillof/Exjobb/GPT4/my-social-app/public/app.js|line:841||vuln:code:if (!currentuserdata?.isadmin && !currentuserdata?.isowner) return;||title:client-side-isadmin"
    },
    {
      "id": "VULN-010",
      "category": "A01",
      "cwe": "CWE-863",
      "cweName": "Incorrect Authorization",
      "severity": "HIGH",
      "title": "client-side-isadmin",
      "description": "Client-side admin check. CWE-863",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT4/my-social-app/public/app.js",
        "line": 852,
        "endLine": 852,
        "code": "<strong>${u.displayName}</strong> ${u.isAdmin ? \"(Admin)\" : \"\"} ${u.isOwner ? \"(Owner)\" : \"\"}<br>"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:19:56.963Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "2d3d6e19a70e9353",
      "_fingerprintSource": "cwe:CWE-863||cat:A01||loc:file:/home/nillof/Exjobb/GPT4/my-social-app/public/app.js|line:852||vuln:code:<strong>${u.displayname}</strong> ${u.isadmin ? (admin) : } ${u.isowner ? (owner||title:client-side-isadmin"
    },
    {
      "id": "VULN-011",
      "category": "A01",
      "cwe": "CWE-863",
      "cweName": "Incorrect Authorization",
      "severity": "HIGH",
      "title": "client-side-isadmin",
      "description": "Client-side admin check. CWE-863",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT4/my-social-app/public/app.js",
        "line": 930,
        "endLine": 930,
        "code": "if (u.data().isAdmin) totalAdmins++;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:19:56.963Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "004a9a1c9f5839fa",
      "_fingerprintSource": "cwe:CWE-863||cat:A01||loc:file:/home/nillof/Exjobb/GPT4/my-social-app/public/app.js|line:930||vuln:code:if (u.data().isadmin) totaladmins++;||title:client-side-isadmin"
    },
    {
      "id": "VULN-012",
      "category": "A02",
      "cwe": "CWE-798",
      "cweName": "Unknown",
      "severity": "HIGH",
      "title": "Hardcoded Google API Key found",
      "description": "Found potential Google API Key in https://gpt-4-aa300.firebaseapp.com/app.js",
      "evidence": {
        "pattern": "Google API Key",
        "source": "https://gpt-4-aa300.firebaseapp.com/app.js",
        "redactedMatch": "AIzaSyDiDm...b-dbc"
      },
      "remediation": null,
      "tool": "crypto-scanner",
      "timestamp": "2025-12-15T15:21:00.876Z",
      "tools": [
        "crypto-scanner"
      ],
      "duplicateCount": 1,
      "_fingerprint": "3d0538ce25f56f4c",
      "_fingerprintSource": "cwe:CWE-798||cat:A02||title:hardcoded google api key found"
    },
    {
      "id": "VULN-013",
      "category": "A02",
      "cwe": "CWE-798",
      "cweName": "Unknown",
      "severity": "HIGH",
      "title": "Hardcoded Generic Password found",
      "description": "Found potential Generic Password in https://gpt-4-aa300.firebaseapp.com/app.js",
      "evidence": {
        "pattern": "Generic Password",
        "source": "https://gpt-4-aa300.firebaseapp.com/app.js",
        "redactedMatch": "password:\"...ert(\""
      },
      "remediation": null,
      "tool": "crypto-scanner",
      "timestamp": "2025-12-15T15:21:00.876Z",
      "tools": [
        "crypto-scanner"
      ],
      "duplicateCount": 1,
      "_fingerprint": "8fac7ab7f44109dd",
      "_fingerprintSource": "cwe:CWE-798||cat:A02||title:hardcoded generic password found"
    },
    {
      "id": "VULN-014",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT4/my-social-app/public/app.js",
        "line": 315,
        "endLine": 319,
        "code": "card.innerHTML = `\n        <strong>${u.displayName}</strong><br>\n        ${u.city || \"\"} ${u.country || \"\"}<br>\n        <button data-view-profile=\"${u.uid}\">View public profile</button>\n      `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:19:56.959Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "1930fa74d60b6c1a",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT4/my-social-app/public/app.js|line:315||vuln:code:card.innerhtml = ` <strong>${u.displayname}</strong><br> ${u.city || } ${u.count||title:dom xss"
    },
    {
      "id": "VULN-015",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT4/my-social-app/public/app.js",
        "line": 340,
        "endLine": 344,
        "code": "container.innerHTML = `\n    <h3>${u.displayName}</h3>\n    <p>${u.about || \"\"}</p>\n    <p>${u.city || \"\"}, ${u.country || \"\"}</p>\n  `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:19:56.959Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "4a29212f1946bffa",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT4/my-social-app/public/app.js|line:340||vuln:code:container.innerhtml = ` <h3>${u.displayname}</h3> <p>${u.about || }</p> <p>${u.c||title:dom xss"
    },
    {
      "id": "VULN-016",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT4/my-social-app/public/app.js",
        "line": 362,
        "endLine": 365,
        "code": "el.innerHTML = `\n      <div>${post.text}</div>\n      ${post.imageUrl ? `<img src=\"${post.imageUrl}\" class=\"gallery-photo\" />` : \"\"}\n    `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:19:56.959Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "1025226f55dee865",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT4/my-social-app/public/app.js|line:362||vuln:code:el.innerhtml = ` <div>${post.text}</div> ${post.imageurl ? `<img src=${post.imag||title:dom xss"
    },
    {
      "id": "VULN-017",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT4/my-social-app/public/app.js",
        "line": 440,
        "endLine": 450,
        "code": "div.innerHTML = `\n    <div class=\"${bannerClass}\"></div>\n    <div>\n      ${u.photoUrl ? `<img src=\"${u.photoUrl}\" class=\"gallery-photo\" />` : \"\"}\n      <h3>${u.displayName}</h3>\n      <p>${u.realName || \"\"}</p>\n      <p>${u.age ? `Age: ${u.age}` : \"\"}</p>\n      <p>${u.city || \"\"}, ${u.country || \"\"}</p>\n      <p>${u.about || \"\"}</p>\n    </div>\n  `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:19:56.959Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "19bb939d7ca0c8c6",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT4/my-social-app/public/app.js|line:440||vuln:code:div.innerhtml = ` <div class=${bannerclass}></div> <div> ${u.photourl ? `<img sr||title:dom xss"
    },
    {
      "id": "VULN-018",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT4/my-social-app/public/app.js",
        "line": 463,
        "endLine": 463,
        "code": "div.innerHTML = `<h4>Album: ${album.name}</h4><div id=\"album-${a.id}\"></div>`;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:19:56.959Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "cbc85fd5442da60f",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT4/my-social-app/public/app.js|line:463||vuln:code:div.innerhtml = `<h4>album: ${album.name}</h4><div id=album-${a.id}></div>`;||title:dom xss"
    },
    {
      "id": "VULN-019",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT4/my-social-app/public/app.js",
        "line": 602,
        "endLine": 613,
        "code": "div.innerHTML = `\n      <strong>${post.authorName}</strong> (${post.visibility})<br>\n      <span>${post.text}</span><br>\n      ${post.imageUrl ? `<img src=\"${post.imageUrl}\" class=\"gallery-photo\" />` : \"\"}\n      <div class=\"post-actions\">\n        <button data-like=\"${docSnap.id}\">Like (${post.likeCount || 0})</button>\n        <button data-comment=\"${docSnap.id}\">Comment</button>\n        <button data-add-friend=\"${post.authorId}\">Add friend</button>\n        ${post.imageUrl ? `<button data-download=\"${post.imageUrl}\">Download image</button>` : \"\"}\n      </div>\n      <div class=\"comments\" id=\"comments-${docSnap.id}\"></div>\n    `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:19:56.962Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "1c69047cc88e109a",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT4/my-social-app/public/app.js|line:602||vuln:code:div.innerhtml = ` <strong>${post.authorname}</strong> (${post.visibility})<br> <||title:dom xss"
    },
    {
      "id": "VULN-020",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT4/my-social-app/public/app.js",
        "line": 648,
        "endLine": 648,
        "code": "div.innerHTML = `<em>${cm.authorName}:</em> ${cm.text}`;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:19:56.962Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "cb1c8d087c77d3f9",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT4/my-social-app/public/app.js|line:648||vuln:code:div.innerhtml = `<em>${cm.authorname}:</em> ${cm.text}`;||title:dom xss"
    },
    {
      "id": "VULN-021",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT4/my-social-app/public/app.js",
        "line": 716,
        "endLine": 723,
        "code": "div.innerHTML = `\n      <strong>${u.displayName}</strong><br>\n      ${u.realName || \"\"}<br>\n      ${u.age ? `Age: ${u.age}` : \"\"}<br>\n      ${u.city || \"\"}, ${u.country || \"\"}<br>\n      UID: ${u.uid}<br>\n      <button data-dm=\"${u.uid}\">Open DM</button>\n    `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:19:56.963Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "b7020bb2a104554a",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT4/my-social-app/public/app.js|line:716||vuln:code:div.innerhtml = ` <strong>${u.displayname}</strong><br> ${u.realname || }<br> ${||title:dom xss"
    },
    {
      "id": "VULN-022",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT4/my-social-app/public/app.js",
        "line": 743,
        "endLine": 746,
        "code": "div.innerHTML = `\n      <strong>${u.displayName}</strong> (${u.city || \"\"}, ${u.country || \"\"})<br>\n      <button data-add-friend=\"${u.uid}\">Add friend</button>\n    `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:19:56.963Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "4d4d48fb96eee55d",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT4/my-social-app/public/app.js|line:743||vuln:code:div.innerhtml = ` <strong>${u.displayname}</strong> (${u.city || }, ${u.country ||title:dom xss"
    },
    {
      "id": "VULN-023",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT4/my-social-app/public/app.js",
        "line": 813,
        "endLine": 813,
        "code": "div.innerHTML = `<strong>${msg.authorName}:</strong> ${msg.text}`;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:19:56.963Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "73efdf664d6a6b6c",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT4/my-social-app/public/app.js|line:813||vuln:code:div.innerhtml = `<strong>${msg.authorname}:</strong> ${msg.text}`;||title:dom xss"
    },
    {
      "id": "VULN-024",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT4/my-social-app/public/app.js",
        "line": 851,
        "endLine": 857,
        "code": "div.innerHTML = `\n      <strong>${u.displayName}</strong> ${u.isAdmin ? \"(Admin)\" : \"\"} ${u.isOwner ? \"(Owner)\" : \"\"}<br>\n      Email: ${u.email}<br>\n      UID: ${u.uid}<br>\n      Disabled: ${u.disabled ? \"Yes\" : \"No\"}<br>\n      <button data-disable=\"${u.uid}\">Toggle disable</button>\n    `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:19:56.963Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "b570a556a87c0f75",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT4/my-social-app/public/app.js|line:851||vuln:code:div.innerhtml = ` <strong>${u.displayname}</strong> ${u.isadmin ? (admin) : } ${||title:dom xss"
    },
    {
      "id": "VULN-025",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT4/my-social-app/public/app.js",
        "line": 886,
        "endLine": 890,
        "code": "div.innerHTML = `\n      <strong>${p.authorName}</strong> (${p.visibility})<br>\n      ${p.text}<br>\n      <button data-delete-post=\"${pSnap.id}\">Delete post</button>\n    `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:19:56.963Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "5d2d9397d1503983",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT4/my-social-app/public/app.js|line:886||vuln:code:div.innerhtml = ` <strong>${p.authorname}</strong> (${p.visibility})<br> ${p.tex||title:dom xss"
    },
    {
      "id": "VULN-026",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT4/my-social-app/public/app.js",
        "line": 939,
        "endLine": 944,
        "code": "statsDiv.innerHTML = `\n    <p>Total users: ${totalUsers}</p>\n    <p>Total admins: ${totalAdmins}</p>\n    <p>Total posts: ${totalPosts}</p>\n    <p>Site disabled: ${siteDisabled ? \"Yes\" : \"No\"}</p>\n  `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:19:56.963Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "918b1e52cf5563f8",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT4/my-social-app/public/app.js|line:939||vuln:code:statsdiv.innerhtml = ` <p>total users: ${totalusers}</p> <p>total admins: ${tota||title:dom xss"
    },
    {
      "id": "VULN-027",
      "category": "A03",
      "cwe": "CWE-79",
      "cweName": "Cross-site Scripting (XSS)",
      "severity": "HIGH",
      "title": "dom-xss-innerhtml",
      "description": "innerHTML XSS. CWE-79",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT4/my-social-app/public/app.js",
        "line": 1018,
        "endLine": 1022,
        "code": "div.innerHTML = `\n      Code: ${c.id}<br>\n      Created: ${d.createdAt.toDate().toLocaleString()}<br>\n      Used by: ${(d.usedBy || []).length} users\n    `;"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:19:56.963Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "c5ae215250d43ee5",
      "_fingerprintSource": "cwe:CWE-79||cat:A03||loc:file:/home/nillof/Exjobb/GPT4/my-social-app/public/app.js|line:1018||vuln:code:div.innerhtml = ` code: ${c.id}<br> created: ${d.createdat.todate().tolocalestri||title:dom xss"
    },
    {
      "id": "VULN-028",
      "category": "A01",
      "cwe": "CWE-284",
      "cweName": "Improper Access Control",
      "severity": "MEDIUM",
      "title": "Unauthenticated Read Access to Posts",
      "description": "Posts are readable without authentication. Consider if this is intentional for public content.",
      "evidence": "Unauthenticated read on /posts/{postId} succeeded",
      "remediation": "If posts should be private, add: allow read: if request.auth != null",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T15:19:53.455Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "f5c167243df79b33",
      "_fingerprintSource": "cwe:CWE-284||cat:A01||title:unauthenticated read access to posts"
    },
    {
      "id": "VULN-029",
      "category": "A01",
      "cwe": "CWE-284",
      "cweName": "Improper Access Control",
      "severity": "MEDIUM",
      "title": "firebase-no-auth-deletedoc",
      "description": "Firestore deleteDoc without auth check. CWE-284",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT4/my-social-app/public/app.js",
        "line": 898,
        "endLine": 898,
        "code": "await deleteDoc(doc(db, \"posts\", postId));"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:19:56.963Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "393b10e8573fd12d",
      "_fingerprintSource": "cwe:CWE-284||cat:A01||loc:file:/home/nillof/Exjobb/GPT4/my-social-app/public/app.js|line:898||vuln:code:await deletedoc(doc(db, posts, postid));||title:firebase-no-auth-deletedoc"
    },
    {
      "id": "VULN-030",
      "category": "A01",
      "cwe": "CWE-284",
      "cweName": "Improper Access Control",
      "severity": "MEDIUM",
      "title": "firebase-no-auth-setdoc",
      "description": "Firestore setDoc without auth check. CWE-284",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT4/my-social-app/public/app.js",
        "line": 910,
        "endLine": 913,
        "code": "await setDoc(doc(db, \"siteSettings\", \"ownerSettings\"), {\n      siteDisabled: disabled,\n      updatedAt: Timestamp.now()\n    });"
      },
      "remediation": null,
      "tool": "semgrep",
      "timestamp": "2025-12-15T15:19:56.963Z",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 1,
      "_fingerprint": "e33c9a820b5ef17e",
      "_fingerprintSource": "cwe:CWE-284||cat:A01||loc:file:/home/nillof/Exjobb/GPT4/my-social-app/public/app.js|line:910||vuln:code:await setdoc(doc(db, sitesettings, ownersettings), { sitedisabled: disabled, upd||title:firebase-no-auth-setdoc"
    },
    {
      "id": "VULN-031",
      "category": "A01",
      "cwe": "CWE-668",
      "cweName": "Unknown",
      "severity": "MEDIUM",
      "title": "Draft Content Exposed to Other Users",
      "description": "Unpublished/draft content is accessible to users other than the author.",
      "evidence": "bob456 accessed alice123's draft posts",
      "remediation": "Add visibility check: allow read: if resource.data.status == \"published\" || request.auth.uid == resource.data.userId",
      "tool": "firebase-emulator",
      "timestamp": "2025-12-15T15:19:53.455Z",
      "tools": [
        "firebase-emulator"
      ],
      "duplicateCount": 1,
      "_fingerprint": "a20995916ac311eb",
      "_fingerprintSource": "cwe:CWE-668||cat:A01||title:draft content exposed to other users"
    },
    {
      "id": "VULN-032",
      "category": "A02",
      "cwe": "CWE-311",
      "cweName": "Missing Encryption of Sensitive Data",
      "severity": "MEDIUM",
      "title": "Public Storage Access",
      "description": "Storage files are publicly readable. Consider if this is necessary.",
      "evidence": {
        "rule": "allow read: if true"
      },
      "remediation": "Consider: allow read: if request.auth != null",
      "tool": "static-analysis",
      "timestamp": "2025-12-15T15:19:47.497Z",
      "tools": [
        "static-analysis"
      ],
      "duplicateCount": 1,
      "_fingerprint": "e49ef171d02d0e12",
      "_fingerprintSource": "cwe:CWE-311||cat:A02||loc:rule:allow read: if true||vuln:rule:allow read: if true||title:public storage access"
    },
    {
      "id": "VULN-033",
      "category": "A02",
      "cwe": "CWE-521",
      "cweName": "Weak Password Requirements",
      "severity": "MEDIUM",
      "title": "Weak password policy",
      "description": "Password field \"admin-login-password\" has weak policy: no minimum length requirement (should be â‰¥8), no pattern for password complexity",
      "evidence": null,
      "remediation": null,
      "tool": "crypto-scanner",
      "tools": [
        "crypto-scanner"
      ],
      "duplicateCount": 3,
      "mergedFrom": [
        {
          "id": "VULN-043",
          "tool": "crypto-scanner",
          "severity": "MEDIUM"
        },
        {
          "id": "VULN-044",
          "tool": "crypto-scanner",
          "severity": "MEDIUM"
        },
        {
          "id": "VULN-045",
          "tool": "crypto-scanner",
          "severity": "MEDIUM"
        }
      ],
      "timestamp": "2025-12-15T15:21:00.876Z",
      "confirmed": false,
      "_fingerprint": "f17a2819353daa70",
      "_fingerprintSource": "cwe:CWE-521||cat:A02||title:weak password policy"
    },
    {
      "id": "VULN-034",
      "category": "A03",
      "cwe": "CWE-434",
      "cweName": "Unrestricted Upload of File with Dangerous Type",
      "severity": "MEDIUM",
      "title": "Missing File Type Validation in Storage Rules",
      "description": "Storage rules do not validate file content type",
      "evidence": null,
      "remediation": "Add: && request.resource.contentType.matches('image/.*')",
      "tool": "static-analysis",
      "timestamp": "2025-12-15T15:19:47.497Z",
      "tools": [
        "static-analysis"
      ],
      "duplicateCount": 1,
      "_fingerprint": "7a89ddfe7772272a",
      "_fingerprintSource": "cwe:CWE-434||cat:A03||title:missing file type validation in storage rules"
    },
    {
      "id": "VULN-035",
      "category": "A03",
      "cwe": "CWE-434",
      "cweName": "Unrestricted Upload of File with Dangerous Type",
      "severity": "LOW",
      "title": "firebase-upload",
      "description": "File upload. CWE-434",
      "evidence": {
        "file": "/home/nillof/Exjobb/GPT4/my-social-app/public/app.js",
        "line": 390
      },
      "remediation": null,
      "tool": "semgrep",
      "tools": [
        "semgrep"
      ],
      "duplicateCount": 2,
      "mergedFrom": [
        {
          "id": "VULN-023",
          "tool": "semgrep",
          "severity": "LOW"
        },
        {
          "id": "VULN-026",
          "tool": "semgrep",
          "severity": "LOW"
        }
      ],
      "timestamp": "2025-12-15T15:19:56.959Z",
      "confirmed": false,
      "_fingerprint": "e9e42e65d54ddd1d",
      "_fingerprintSource": "cwe:CWE-434||cat:A03||loc:file:/home/nillof/Exjobb/GPT4/my-social-app/public/app.js|line:390||vuln:code:await uploadbytes(ref, file);||title:firebase-upload"
    }
  ],
  "cweCoverage": {
    "A01_BrokenAccessControl": [
      "CWE-22",
      "CWE-23",
      "CWE-200",
      "CWE-201",
      "CWE-219",
      "CWE-264",
      "CWE-275",
      "CWE-276",
      "CWE-284",
      "CWE-285",
      "CWE-352",
      "CWE-359",
      "CWE-425",
      "CWE-441",
      "CWE-497",
      "CWE-538",
      "CWE-540",
      "CWE-548",
      "CWE-552",
      "CWE-566",
      "CWE-601",
      "CWE-639",
      "CWE-651",
      "CWE-668",
      "CWE-706",
      "CWE-862",
      "CWE-863",
      "CWE-913",
      "CWE-922",
      "CWE-1275"
    ],
    "A02_CryptographicFailures": [
      "CWE-261",
      "CWE-296",
      "CWE-310",
      "CWE-319",
      "CWE-321",
      "CWE-322",
      "CWE-323",
      "CWE-324",
      "CWE-325",
      "CWE-326",
      "CWE-327",
      "CWE-328",
      "CWE-329",
      "CWE-330",
      "CWE-331",
      "CWE-335",
      "CWE-336",
      "CWE-337",
      "CWE-338",
      "CWE-340",
      "CWE-347",
      "CWE-523",
      "CWE-757",
      "CWE-759",
      "CWE-760",
      "CWE-780",
      "CWE-818",
      "CWE-916"
    ],
    "A03_Injection": [
      "CWE-20",
      "CWE-74",
      "CWE-75",
      "CWE-77",
      "CWE-78",
      "CWE-79",
      "CWE-80",
      "CWE-83",
      "CWE-87",
      "CWE-88",
      "CWE-89",
      "CWE-90",
      "CWE-91",
      "CWE-93",
      "CWE-94",
      "CWE-95",
      "CWE-96",
      "CWE-97",
      "CWE-98",
      "CWE-99",
      "CWE-113",
      "CWE-116",
      "CWE-138",
      "CWE-184",
      "CWE-470",
      "CWE-471",
      "CWE-564",
      "CWE-610",
      "CWE-643",
      "CWE-644",
      "CWE-652",
      "CWE-917",
      "CWE-943"
    ]
  }
}