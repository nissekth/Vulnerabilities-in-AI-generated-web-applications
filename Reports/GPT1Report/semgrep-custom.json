{"version":"1.144.1","results":[{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT1/my-social-app/public/app.js","start":{"line":76,"col":7,"offset":2071},"end":{"line":76,"col":23,"offset":2087},"extra":{"metavars":{"$EL":{"start":{"line":76,"col":7,"offset":2071},"end":{"line":76,"col":9,"offset":2073},"abstract_content":"el"},"$INPUT":{"start":{"line":76,"col":22,"offset":2086},"end":{"line":76,"col":23,"offset":2087},"abstract_content":"v"}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"cebbbaf62f630c58a340293c7a8fa372e5bf8ce1eae8a40f6214ef3a93d20ab0aef4191dcc70ca920a440be5750a933405b78e8149fe0b42482a9e474eabb60e_0","lines":"      el.innerHTML = v;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/GPT1/my-social-app/public/app.js","start":{"line":167,"col":7,"offset":4201},"end":{"line":167,"col":33,"offset":4227},"extra":{"metavars":{"$USER":{"start":{"line":167,"col":7,"offset":4201},"end":{"line":167,"col":26,"offset":4220},"abstract_content":"state.userProfile?."}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"3572c3376664c486305ef399cc89d4ca0e2529d7ff7df0ac64b4a9cc7e37add2a366414e0076e8219d00e14b3ebbd3c547d26450bbcdb1930e2a38d69a4ecb59_0","lines":"  if (state.userProfile?.isAdmin) {","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.firebase-no-auth-setdoc","path":"/home/nillof/Exjobb/GPT1/my-social-app/public/app.js","start":{"line":334,"col":11,"offset":9700},"end":{"line":334,"col":49,"offset":9738},"extra":{"metavars":{"$DB":{"start":{"line":334,"col":22,"offset":9711},"end":{"line":334,"col":24,"offset":9713},"abstract_content":"db","propagated_value":{"svalue_start":{"line":52,"col":12,"offset":1235},"svalue_end":{"line":52,"col":29,"offset":1252},"svalue_abstract_content":"getFirestore(app)"}},"$COLL":{"start":{"line":334,"col":26,"offset":9715},"end":{"line":334,"col":33,"offset":9722},"abstract_content":"\"users\""},"$ID":{"start":{"line":334,"col":35,"offset":9724},"end":{"line":334,"col":38,"offset":9727},"abstract_content":"uid","propagated_value":{"svalue_start":{"line":289,"col":17,"offset":8453},"svalue_end":{"line":289,"col":30,"offset":8466},"svalue_abstract_content":"cred.user.uid"}},"$DATA":{"start":{"line":334,"col":41,"offset":9730},"end":{"line":334,"col":48,"offset":9737},"abstract_content":"userDoc"}},"message":"Firestore setDoc without auth check. CWE-284","metadata":{"cwe":"CWE-284","owasp":"A01:2021"},"severity":"WARNING","fingerprint":"7810ccbcd6af300076d66835c254d5b35f6d40c14c05b016696486b0950c3f3a6b90292359d69350000a69704e87cace95a861447f0669148f0fecd92e8161d0_0","lines":"    await setDoc(doc(db, \"users\", uid), userDoc);","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.firebase-upload","path":"/home/nillof/Exjobb/GPT1/my-social-app/public/app.js","start":{"line":431,"col":11,"offset":12398},"end":{"line":431,"col":40,"offset":12427},"extra":{"metavars":{"$REF":{"start":{"line":431,"col":23,"offset":12410},"end":{"line":431,"col":33,"offset":12420},"abstract_content":"storageRef","propagated_value":{"svalue_start":{"line":430,"col":24,"offset":12315},"svalue_end":{"line":430,"col":95,"offset":12386},"svalue_abstract_content":"ref(storage`postImages/state.user.uid/Date.now()_ file.name)"}},"$FILE":{"start":{"line":431,"col":35,"offset":12422},"end":{"line":431,"col":39,"offset":12426},"abstract_content":"file","propagated_value":{"svalue_start":{"line":429,"col":18,"offset":12273},"svalue_end":{"line":429,"col":35,"offset":12290},"svalue_abstract_content":"imgInput.files[0]"}}},"message":"File upload. CWE-434","metadata":{"cwe":"CWE-434","owasp":"A03:2021"},"severity":"INFO","fingerprint":"6c1d9b1e844e401072247144054d58ccf74cd6aa90c9275d1dcc8a5145fdffcbd93c75fe3c5f4038001a620069bf41d559d78226d43d34b9ab35961bb00e2ac2_0","lines":"    await uploadBytes(storageRef, file);","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/GPT1/my-social-app/public/app.js","start":{"line":472,"col":21,"offset":13362},"end":{"line":472,"col":47,"offset":13388},"extra":{"metavars":{"$USER":{"start":{"line":472,"col":21,"offset":13362},"end":{"line":472,"col":40,"offset":13381},"abstract_content":"state.userProfile?."}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"3572c3376664c486305ef399cc89d4ca0e2529d7ff7df0ac64b4a9cc7e37add2a366414e0076e8219d00e14b3ebbd3c547d26450bbcdb1930e2a38d69a4ecb59_1","lines":"  const isAdmin = !!state.userProfile?.isAdmin;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/GPT1/my-social-app/public/app.js","start":{"line":522,"col":8,"offset":15377},"end":{"line":522,"col":34,"offset":15403},"extra":{"metavars":{"$USER":{"start":{"line":522,"col":8,"offset":15377},"end":{"line":522,"col":27,"offset":15396},"abstract_content":"state.userProfile?."}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"3572c3376664c486305ef399cc89d4ca0e2529d7ff7df0ac64b4a9cc7e37add2a366414e0076e8219d00e14b3ebbd3c547d26450bbcdb1930e2a38d69a4ecb59_2","lines":"      (state.userProfile?.isAdmin || state.user.uid === post.authorId) ? h(\"button\", {","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.firebase-upload","path":"/home/nillof/Exjobb/GPT1/my-social-app/public/app.js","start":{"line":702,"col":11,"offset":21600},"end":{"line":702,"col":40,"offset":21629},"extra":{"metavars":{"$REF":{"start":{"line":702,"col":23,"offset":21612},"end":{"line":702,"col":33,"offset":21622},"abstract_content":"storageRef","propagated_value":{"svalue_start":{"line":701,"col":24,"offset":21512},"svalue_end":{"line":701,"col":100,"offset":21588},"svalue_abstract_content":"ref(storage`profilePictures/state.user.uid/Date.now()_ file.name)"}},"$FILE":{"start":{"line":702,"col":35,"offset":21624},"end":{"line":702,"col":39,"offset":21628},"abstract_content":"file","propagated_value":{"svalue_start":{"line":700,"col":18,"offset":21469},"svalue_end":{"line":700,"col":36,"offset":21487},"svalue_abstract_content":"fileInput.files[0]"}}},"message":"File upload. CWE-434","metadata":{"cwe":"CWE-434","owasp":"A03:2021"},"severity":"INFO","fingerprint":"6c1d9b1e844e401072247144054d58ccf74cd6aa90c9275d1dcc8a5145fdffcbd93c75fe3c5f4038001a620069bf41d559d78226d43d34b9ab35961bb00e2ac2_1","lines":"    await uploadBytes(storageRef, file);","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/GPT1/my-social-app/public/app.js","start":{"line":819,"col":23,"offset":24883},"end":{"line":819,"col":49,"offset":24909},"extra":{"metavars":{"$USER":{"start":{"line":819,"col":23,"offset":24883},"end":{"line":819,"col":42,"offset":24902},"abstract_content":"state.userProfile?."}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"3572c3376664c486305ef399cc89d4ca0e2529d7ff7df0ac64b4a9cc7e37add2a366414e0076e8219d00e14b3ebbd3c547d26450bbcdb1930e2a38d69a4ecb59_3","lines":"    const isAdmin = !!state.userProfile?.isAdmin;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.firebase-no-auth-deletedoc","path":"/home/nillof/Exjobb/GPT1/my-social-app/public/app.js","start":{"line":936,"col":9,"offset":29032},"end":{"line":936,"col":52,"offset":29075},"extra":{"metavars":{"$DB":{"start":{"line":936,"col":23,"offset":29046},"end":{"line":936,"col":25,"offset":29048},"abstract_content":"db","propagated_value":{"svalue_start":{"line":52,"col":12,"offset":1235},"svalue_end":{"line":52,"col":29,"offset":1252},"svalue_abstract_content":"getFirestore(app)"}},"$COLL":{"start":{"line":936,"col":27,"offset":29050},"end":{"line":936,"col":34,"offset":29057},"abstract_content":"\"users\""},"$ID":{"start":{"line":936,"col":36,"offset":29059},"end":{"line":936,"col":50,"offset":29073},"abstract_content":"state.user.uid"}},"message":"Firestore deleteDoc without auth check. CWE-284","metadata":{"cwe":"CWE-284","owasp":"A01:2021"},"severity":"WARNING","fingerprint":"127ebcacc11220eabbff820680e1e28a383ffe9dd34a8d45a7958037a043d6b0066cc5905b6afbddaeabbd3d4d52465c863d0f7b47282d9a34f9d89a5a30afc7_0","lines":"  await deleteDoc(doc(db, \"users\", state.user.uid));","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/GPT1/my-social-app/public/app.js","start":{"line":1086,"col":9,"offset":33332},"end":{"line":1086,"col":21,"offset":33344},"extra":{"metavars":{"$USER":{"start":{"line":1086,"col":9,"offset":33332},"end":{"line":1086,"col":13,"offset":33336},"abstract_content":"user"}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"3f5bfd90dc5a1fd406d23b4cd2777f17b47fec332ba2f58805b64760eb5090daaef3eb93e72bda786d6f640f2e042dd31e5080843ba0726bea445de73e13664d_0","lines":"        user.isAdmin ? h(\"span\", { class: \"badge\" }, \"Admin\") : null","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/GPT1/my-social-app/public/app.js","start":{"line":1261,"col":8,"offset":38310},"end":{"line":1261,"col":34,"offset":38336},"extra":{"metavars":{"$USER":{"start":{"line":1261,"col":8,"offset":38310},"end":{"line":1261,"col":27,"offset":38329},"abstract_content":"state.userProfile?."}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"3572c3376664c486305ef399cc89d4ca0e2529d7ff7df0ac64b4a9cc7e37add2a366414e0076e8219d00e14b3ebbd3c547d26450bbcdb1930e2a38d69a4ecb59_4","lines":"  if (!state.userProfile?.isAdmin) {","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/GPT1/my-social-app/public/app.js","start":{"line":1298,"col":11,"offset":39424},"end":{"line":1298,"col":20,"offset":39433},"extra":{"metavars":{"$USER":{"start":{"line":1298,"col":11,"offset":39424},"end":{"line":1298,"col":12,"offset":39425},"abstract_content":"u","propagated_value":{"svalue_start":{"line":1293,"col":15,"offset":39160},"svalue_end":{"line":1293,"col":29,"offset":39174},"svalue_abstract_content":"docSnap.data()"}}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"8e9cc9ee9b13269aa873cdff500508be6d57d12a2020ea882cbafcaeccd35454a9696c07cd8953f42ba628a99fd0de871d94f70b8f46cc9f2108af8a4393b3bf_0","lines":"          u.isAdmin ? \"Admin\" : \"User\",","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.firebase-no-auth-deletedoc","path":"/home/nillof/Exjobb/GPT1/my-social-app/public/app.js","start":{"line":1334,"col":9,"offset":40542},"end":{"line":1334,"col":41,"offset":40574},"extra":{"metavars":{"$DB":{"start":{"line":1334,"col":23,"offset":40556},"end":{"line":1334,"col":25,"offset":40558},"abstract_content":"db","propagated_value":{"svalue_start":{"line":52,"col":12,"offset":1235},"svalue_end":{"line":52,"col":29,"offset":1252},"svalue_abstract_content":"getFirestore(app)"}},"$COLL":{"start":{"line":1334,"col":27,"offset":40560},"end":{"line":1334,"col":34,"offset":40567},"abstract_content":"\"users\""},"$ID":{"start":{"line":1334,"col":36,"offset":40569},"end":{"line":1334,"col":39,"offset":40572},"abstract_content":"uid"}},"message":"Firestore deleteDoc without auth check. CWE-284","metadata":{"cwe":"CWE-284","owasp":"A01:2021"},"severity":"WARNING","fingerprint":"bb72c419a25b24ebc7bc00e30fb2ef60ea5ebe17be9d74bedb3a93b75c027b4f460f7a7fe51cbde99fe2cb8aef7f7434bcba3e4a49d3f6875c62aad920edeb22_0","lines":"  await deleteDoc(doc(db, \"users\", uid));","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[],"paths":{"scanned":["/home/nillof/Exjobb/GPT1/my-social-app/public/app.js"]},"time":{"rules":[],"rules_parse_time":0.07758498191833496,"profiling_times":{"config_time":0.5109238624572754,"core_time":0.8523192405700684,"ignores_time":0.0002562999725341797,"total_time":1.364018440246582},"parsing_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":0.32073402404785156,"per_file_time":{"mean":0.32073402404785156,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"matching_time":{"total_time":0.0,"per_file_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.0,"per_def_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"fixpoint_timeouts":[],"prefiltering":{"project_level_time":0.0,"file_level_time":0.0,"rules_with_project_prefilters_ratio":0.0,"rules_with_file_prefilters_ratio":0.9788732394366197,"rules_selected_ratio":0.176056338028169,"rules_matched_ratio":0.176056338028169},"targets":[],"total_bytes":0,"max_memory_bytes":193482304},"engine_requested":"OSS","interfile_languages_used":[],"skipped_rules":[],"profiling_results":[]}