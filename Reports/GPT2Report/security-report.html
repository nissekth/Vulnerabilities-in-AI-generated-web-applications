<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Security Report - Social Media App</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f5f5; color: #333; line-height: 1.6; }
    .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
    header { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); color: white; padding: 40px 20px; }
    header h1 { font-size: 2rem; margin-bottom: 10px; }
    .meta { display: flex; gap: 20px; flex-wrap: wrap; margin-top: 15px; font-size: 0.9rem; }
    .meta span { background: rgba(255,255,255,0.1); padding: 5px 15px; border-radius: 20px; }
    .cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; margin: 20px 0; }
    .card { background: white; border-radius: 12px; padding: 20px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
    .card.critical { border-left: 4px solid #dc3545; }
    .card.high { border-left: 4px solid #fd7e14; }
    .card.medium { border-left: 4px solid #ffc107; }
    .card.low { border-left: 4px solid #17a2b8; }
    .card h3 { font-size: 2rem; margin-bottom: 5px; }
    .card p { color: #666; font-size: 0.8rem; text-transform: uppercase; }
    .section { background: white; border-radius: 12px; padding: 25px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
    .section h2 { margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #f0f0f0; }
    .finding { background: #fafafa; border-radius: 8px; padding: 15px; margin-bottom: 10px; border-left: 4px solid #ccc; }
    .finding.critical { border-left-color: #dc3545; background: #fff5f5; }
    .finding.high { border-left-color: #fd7e14; background: #fff9f5; }
    .finding.medium { border-left-color: #ffc107; background: #fffcf5; }
    .finding.low { border-left-color: #17a2b8; background: #f5fcff; }
    .finding-header { display: flex; justify-content: space-between; margin-bottom: 10px; flex-wrap: wrap; gap: 10px; }
    .finding-title { font-weight: 600; }
    .badges { display: flex; gap: 8px; }
    .badge { padding: 2px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: 600; }
    .badge.critical { background: #dc3545; color: white; }
    .badge.high { background: #fd7e14; color: white; }
    .badge.medium { background: #ffc107; color: #333; }
    .badge.low { background: #17a2b8; color: white; }
    .badge.cwe { background: #e9ecef; color: #333; }
    .badge.tool { background: #6c757d; color: white; }
    .tools-list { display: flex; flex-wrap: wrap; gap: 4px; }
    .duplicate-badge { background: #17a2b8; color: white; font-size: 0.7rem; padding: 2px 6px; }
    .confirmed-badge { background: #28a745; color: white; }
    .dedup-info { background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #2196f3; }
    .finding-desc { color: #555; margin-bottom: 10px; }
    .evidence { background: #f0f0f0; padding: 10px; border-radius: 6px; font-family: monospace; font-size: 0.85rem; margin-bottom: 10px; overflow-x: auto; }
    .remediation { background: #e8f5e9; padding: 10px; border-radius: 6px; border-left: 3px solid #4caf50; }
    .category-header { padding: 15px 20px; border-radius: 8px; margin-bottom: 15px; color: white; }
    .category-header.a01 { background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); }
    .category-header.a02 { background: linear-gradient(135deg, #fd7e14 0%, #e8650c 100%); }
    .category-header.a03 { background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%); }
    footer { text-align: center; padding: 30px; color: #666; font-size: 0.9rem; }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1>üîí Security Assessment Report</h1>
      <p>OWASP Top 10:2021 (A01-A03) Vulnerability Analysis</p>
      <div class="meta">
        <span>üìç https://gpt-2-22b6d.firebaseapp.com</span>
        <span>üèóÔ∏è gpt-2-22b6d</span>
        <span>üìÖ 12/15/2025</span>
        <span>‚è±Ô∏è 96s</span>
      </div>
    </div>
  </header>
  
  <div class="container">
    <div class="cards">
      <div class="card critical"><h3>1</h3><p>Critical</p></div>
      <div class="card high"><h3>24</h3><p>High</p></div>
      <div class="card medium"><h3>5</h3><p>Medium</p></div>
      <div class="card low"><h3>0</h3><p>Low</p></div>
      <div class="card"><h3>140</h3><p>Risk Score</p></div>
    </div>
    
    <div class="section">
      <h2>üìã Executive Summary</h2>
      <p>This security assessment identified <strong>30 unique findings</strong> 
      across OWASP Top 10:2021 categories A01 (Broken Access Control), A02 (Cryptographic Failures), 
      and A03 (Injection).</p>
      <p style="margin-top:10px"><strong>Risk Level:</strong> CRITICAL</p>
      
      <div class="dedup-info" style="margin-top:15px">
        <strong>üîÑ Deduplication Applied:</strong> 
        36 raw findings from multiple scanners 
        ‚Üí 30 unique vulnerabilities 
        (6 duplicates merged, 
        17% reduction)
      </div>
    </div>
    
    
    <div class="section">
      <div class="category-header a01">
        <h2 style="margin:0;border:none;padding:0;color:white">A01: Broken Access Control (13)</h2>
      </div>
      
      <div class="finding critical">
        <div class="finding-header">
          <span class="finding-title">Sensitive Configuration Data Accessible</span>
          <div class="badges">
            <span class="badge critical">CRITICAL</span>
            <span class="badge cwe">CWE-922</span>
            <span class="badge tool">firebase-emulator</span>
            
            
          </div>
        </div>
        <p class="finding-desc">API keys or other sensitive configuration stored in Firestore is accessible to regular users.</p>
        <div class="evidence"><strong>Evidence:</strong> Regular user accessed /config/api_keys document</div>
        <div class="remediation"><strong>Remediation:</strong> Sensitive config should not be in client-accessible Firestore. Use Cloud Functions or secure backend storage.</div>
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">User Enumeration via Collection Listing</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-200</span>
            <span class="badge tool">firebase-emulator</span>
            
            
          </div>
        </div>
        <p class="finding-desc">Unauthenticated users can list/enumerate user documents, exposing user data.</p>
        <div class="evidence"><strong>Evidence:</strong> Unauthenticated list query on /users succeeded</div>
        <div class="remediation"><strong>Remediation:</strong> Prevent listing: require authentication and consider restricting list queries</div>
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">Unrestricted Read Access</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-284</span>
            <span class="badge tool">static-analysis</span>
            <span class="badge duplicate-badge">√ó5</span>
            
          </div>
        </div>
        <p class="finding-desc">Rule allows anyone to read data without authentication</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "rule": "allow read: if true"
}</div>
        <div class="remediation"><strong>Remediation:</strong> Change to: allow read: if request.auth != null</div>
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">Unauthenticated Read Access to User Data</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-284</span>
            <span class="badge tool">firebase-emulator</span>
            
            
          </div>
        </div>
        <p class="finding-desc">Firestore rules allow unauthenticated users to read user documents. This exposes potentially sensitive user information to anyone.</p>
        <div class="evidence"><strong>Evidence:</strong> Unauthenticated read on /users/{userId} succeeded</div>
        <div class="remediation"><strong>Remediation:</strong> Add authentication check: allow read: if request.auth != null</div>
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">IDOR Vulnerability on User Profiles</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-639</span>
            <span class="badge tool">firebase-emulator</span>
            
            
          </div>
        </div>
        <p class="finding-desc">Users can access other users' profiles by simply changing the document ID in the request.</p>
        <div class="evidence"><strong>Evidence:</strong> alice123 accessed bob456's profile by changing document ID</div>
        <div class="remediation"><strong>Remediation:</strong> Restrict reads to own profile: allow read: if request.auth.uid == userId</div>
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">client-side-isadmin</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-863</span>
            <span class="badge tool">semgrep</span>
            
            
          </div>
        </div>
        <p class="finding-desc">Client-side admin check. CWE-863</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "file": "/home/nillof/Exjobb/GPT2/mini-social/public/app.js",
  "line": 200,
  "endLine": 200,
  "code": "$(\"admin-nav-btn\").classList.toggle(\"hidden\", !currentUserDoc.isAdmin && !currentUserDoc.isOwner);"
}</div>
        
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">client-side-isadmin</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-863</span>
            <span class="badge tool">semgrep</span>
            
            
          </div>
        </div>
        <p class="finding-desc">Client-side admin check. CWE-863</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "file": "/home/nillof/Exjobb/GPT2/mini-social/public/app.js",
  "line": 215,
  "endLine": 215,
  "code": "if (currentUserDoc.isAdmin || currentUserDoc.isOwner) loadAdmin();"
}</div>
        
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">client-side-isadmin</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-863</span>
            <span class="badge tool">semgrep</span>
            
            
          </div>
        </div>
        <p class="finding-desc">Client-side admin check. CWE-863</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "file": "/home/nillof/Exjobb/GPT2/mini-social/public/app.js",
  "line": 374,
  "endLine": 374,
  "code": "currentUserDoc.isAdmin ||"
}</div>
        
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">client-side-isadmin</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-863</span>
            <span class="badge tool">semgrep</span>
            
            
          </div>
        </div>
        <p class="finding-desc">Client-side admin check. CWE-863</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "file": "/home/nillof/Exjobb/GPT2/mini-social/public/app.js",
  "line": 400,
  "endLine": 400,
  "code": "(p.authorId === currentUser.uid || currentUserDoc.isAdmin || currentUserDoc.isOwner)"
}</div>
        
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">client-side-isadmin</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-863</span>
            <span class="badge tool">semgrep</span>
            
            
          </div>
        </div>
        <p class="finding-desc">Client-side admin check. CWE-863</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "file": "/home/nillof/Exjobb/GPT2/mini-social/public/app.js",
  "line": 1139,
  "endLine": 1139,
  "code": "if (!currentUserDoc?.isAdmin && !currentUserDoc?.isOwner) return;"
}</div>
        
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">client-side-isadmin</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-863</span>
            <span class="badge tool">semgrep</span>
            
            
          </div>
        </div>
        <p class="finding-desc">Client-side admin check. CWE-863</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "file": "/home/nillof/Exjobb/GPT2/mini-social/public/app.js",
  "line": 1161,
  "endLine": 1161,
  "code": "Admin: ${u.isAdmin ? \"Yes\" : \"No\"} ¬∑ Owner: ${u.isOwner ? \"Yes\" : \"No\"}<br><br>"
}</div>
        
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">client-side-isadmin</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-863</span>
            <span class="badge tool">semgrep</span>
            
            
          </div>
        </div>
        <p class="finding-desc">Client-side admin check. CWE-863</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "file": "/home/nillof/Exjobb/GPT2/mini-social/public/app.js",
  "line": 1165,
  "endLine": 1165,
  "code": "${u.isAdmin ? \"Remove Admin\" : \"Make Admin\"}"
}</div>
        
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">client-side-isadmin</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-863</span>
            <span class="badge tool">semgrep</span>
            
            
          </div>
        </div>
        <p class="finding-desc">Client-side admin check. CWE-863</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "file": "/home/nillof/Exjobb/GPT2/mini-social/public/app.js",
  "line": 1192,
  "endLine": 1192,
  "code": "await ref.update({ isAdmin: !snap.data().isAdmin });"
}</div>
        
      </div>
      
    </div>
    <div class="section">
      <div class="category-header a02">
        <h2 style="margin:0;border:none;padding:0;color:white">A02: Cryptographic Failures (5)</h2>
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">Hardcoded Google API Key found</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-798</span>
            <span class="badge tool">crypto-scanner</span>
            
            
          </div>
        </div>
        <p class="finding-desc">Found potential Google API Key in https://gpt-2-22b6d.firebaseapp.com/app.js</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "pattern": "Google API Key",
  "source": "https://gpt-2-22b6d.firebaseapp.com/app.js",
  "redactedMatch": "AIzaSyAOVf...TU-lg"
}</div>
        
      </div>
      
      <div class="finding medium">
        <div class="finding-header">
          <span class="finding-title">Public Storage Access</span>
          <div class="badges">
            <span class="badge medium">MEDIUM</span>
            <span class="badge cwe">CWE-311</span>
            <span class="badge tool">static-analysis</span>
            
            
          </div>
        </div>
        <p class="finding-desc">Storage files are publicly readable. Consider if this is necessary.</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "rule": "allow read: if true"
}</div>
        <div class="remediation"><strong>Remediation:</strong> Consider: allow read: if request.auth != null</div>
      </div>
      
      <div class="finding medium">
        <div class="finding-header">
          <span class="finding-title">Weak Random detected</span>
          <div class="badges">
            <span class="badge medium">MEDIUM</span>
            <span class="badge cwe">CWE-330</span>
            <span class="badge tool">crypto-scanner</span>
            
            
          </div>
        </div>
        <p class="finding-desc">Found Weak Random in https://gpt-2-22b6d.firebaseapp.com/app.js. This may indicate weak cryptographic practices.</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "pattern": "Weak Random",
  "source": "https://gpt-2-22b6d.firebaseapp.com/app.js",
  "matchCount": 1
}</div>
        
      </div>
      
      <div class="finding medium">
        <div class="finding-header">
          <span class="finding-title">weak-prng-math-floor-random</span>
          <div class="badges">
            <span class="badge medium">MEDIUM</span>
            <span class="badge cwe">CWE-338</span>
            <span class="badge tool">semgrep</span>
            
            
          </div>
        </div>
        <p class="finding-desc">Math.random for random int. CWE-338</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "file": "/home/nillof/Exjobb/GPT2/mini-social/public/app.js",
  "line": 53,
  "endLine": 53,
  "code": "out += chars[Math.floor(Math.random() * chars.length)];"
}</div>
        
      </div>
      
      <div class="finding medium">
        <div class="finding-header">
          <span class="finding-title">Weak password policy</span>
          <div class="badges">
            <span class="badge medium">MEDIUM</span>
            <span class="badge cwe">CWE-521</span>
            <span class="badge tool">crypto-scanner</span>
            <span class="badge duplicate-badge">√ó2</span>
            
          </div>
        </div>
        <p class="finding-desc">Password field "register-password" has weak policy: no minimum length requirement (should be ‚â•8), no pattern for password complexity</p>
        
        
      </div>
      
    </div>
    <div class="section">
      <div class="category-header a03">
        <h2 style="margin:0;border:none;padding:0;color:white">A03: Injection (12)</h2>
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">external-reference-script-src</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-610</span>
            <span class="badge tool">semgrep</span>
            
            
          </div>
        </div>
        <p class="finding-desc">Dynamic script.src. CWE-610</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "file": "/home/nillof/Exjobb/GPT2/mini-social/public/app.js",
  "line": 620,
  "endLine": 620,
  "code": "img.src = p.imageUrl;"
}</div>
        
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">dom-xss-innerhtml</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-79</span>
            <span class="badge tool">semgrep</span>
            
            
          </div>
        </div>
        <p class="finding-desc">innerHTML XSS. CWE-79</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "file": "/home/nillof/Exjobb/GPT2/mini-social/public/app.js",
  "line": 277,
  "endLine": 284,
  "code": "div.innerHTML = `\n        <div class=\"profile-banner ${u.banner || \"banner-default\"}\"></div>\n        <div class=\"profile-card-body\">\n          <strong>${u.displayName}</strong><br>\n          <small>${u.city || \"\"} ${u.country || \"\"}</small><br>\n          <a href=\"profile.html?uid=${doc.id}\">Open Profile</a>\n        </div>\n      `;"
}</div>
        
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">dom-xss-innerhtml</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-79</span>
            <span class="badge tool">semgrep</span>
            
            
          </div>
        </div>
        <p class="finding-desc">innerHTML XSS. CWE-79</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "file": "/home/nillof/Exjobb/GPT2/mini-social/public/app.js",
  "line": 381,
  "endLine": 407,
  "code": "div.innerHTML = `\n        <div class=\"post-header\">\n          <div><strong>${p.authorName}</strong></div>\n          <div class=\"post-meta\">${formatDate(p.createdAt)} ¬∑ ${p.visibility}</div>\n        </div>\n\n        <p>${p.text}</p>\n\n        ${p.imageUrl ? `\n          <img src=\"${p.imageUrl}\"\n               style=\"max-width:100%;border-radius:6px;margin-bottom:0.4rem;\">`\n        : \"\"}\n\n        <div class=\"post-actions\">\n          <button data-like=\"${doc.id}\">Like</button>\n          <button data-comment=\"${doc.id}\">Comment</button>\n          <button data-addfriend=\"${p.authorId}\">Add Friend</button>\n          ${p.imageUrl ? `<button data-download=\"${p.imageUrl}\">Download</button>` : \"\"}\n          ${\n            (p.authorId === currentUser.uid || currentUserDoc.isAdmin || currentUserDoc.isOwner)\n            ? `<button data-deletepost=\"${doc.id}\" class=\"danger\">Delete</button>`\n            : \"\"\n          }\n        </div>\n\n        <div id=\"comments-${doc.id}\" class=\"comments\"></div>\n      `;"
}</div>
        
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">dom-xss-innerhtml</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-79</span>
            <span class="badge tool">semgrep</span>
            
            
          </div>
        </div>
        <p class="finding-desc">innerHTML XSS. CWE-79</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "file": "/home/nillof/Exjobb/GPT2/mini-social/public/app.js",
  "line": 506,
  "endLine": 506,
  "code": "$(\"my-profile-info\").innerHTML = card;"
}</div>
        
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">dom-xss-innerhtml</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-79</span>
            <span class="badge tool">semgrep</span>
            
            
          </div>
        </div>
        <p class="finding-desc">innerHTML XSS. CWE-79</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "file": "/home/nillof/Exjobb/GPT2/mini-social/public/app.js",
  "line": 538,
  "endLine": 542,
  "code": "div.innerHTML = `\n      <div class=\"post-meta\">${formatDate(p.createdAt)} ¬∑ ${p.visibility}</div>\n      <p>${p.text}</p>\n      ${p.imageUrl ? `<img src=\"${p.imageUrl}\" style=\"max-width:100%;\">` : \"\"}\n    `;"
}</div>
        
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">dom-xss-innerhtml</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-79</span>
            <span class="badge tool">semgrep</span>
            
            
          </div>
        </div>
        <p class="finding-desc">innerHTML XSS. CWE-79</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "file": "/home/nillof/Exjobb/GPT2/mini-social/public/app.js",
  "line": 649,
  "endLine": 652,
  "code": "div.innerHTML = `\n      <strong>Code:</strong> ${r.code}<br>\n      <small>Used ${r.usedCount || 0} times</small>\n    `;"
}</div>
        
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">dom-xss-innerhtml</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-79</span>
            <span class="badge tool">semgrep</span>
            
            
          </div>
        </div>
        <p class="finding-desc">innerHTML XSS. CWE-79</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "file": "/home/nillof/Exjobb/GPT2/mini-social/public/app.js",
  "line": 757,
  "endLine": 761,
  "code": "div.innerHTML = `\n      <strong>${u.displayName}</strong><br>\n      Age: ${u.age || \"?\"}<br>\n      ${u.city || \"\"} ${u.country || \"\"}\n    `;"
}</div>
        
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">dom-xss-innerhtml</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-79</span>
            <span class="badge tool">semgrep</span>
            <span class="badge duplicate-badge">√ó2</span>
            
          </div>
        </div>
        <p class="finding-desc">innerHTML XSS. CWE-79</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "file": "/home/nillof/Exjobb/GPT2/mini-social/public/app.js",
  "line": 805
}</div>
        
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">dom-xss-innerhtml</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-79</span>
            <span class="badge tool">semgrep</span>
            
            
          </div>
        </div>
        <p class="finding-desc">innerHTML XSS. CWE-79</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "file": "/home/nillof/Exjobb/GPT2/mini-social/public/app.js",
  "line": 1158,
  "endLine": 1168,
  "code": "div.innerHTML = `\n      <strong>${u.displayName}</strong><br>\n      Email: ${u.email}<br>\n      Admin: ${u.isAdmin ? \"Yes\" : \"No\"} ¬∑ Owner: ${u.isOwner ? \"Yes\" : \"No\"}<br><br>\n\n      <button data-admin-edit=\"${doc.id}\">Edit User</button>\n      <button data-admin-toggle=\"${doc.id}\">\n        ${u.isAdmin ? \"Remove Admin\" : \"Make Admin\"}\n      </button>\n      <button data-admin-deleteuser=\"${doc.id}\" class=\"danger\">Delete User</button>\n    `;"
}</div>
        
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">dom-xss-innerhtml</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-79</span>
            <span class="badge tool">semgrep</span>
            
            
          </div>
        </div>
        <p class="finding-desc">innerHTML XSS. CWE-79</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "file": "/home/nillof/Exjobb/GPT2/mini-social/public/app.js",
  "line": 1225,
  "endLine": 1229,
  "code": "div.innerHTML = `\n      <strong>${p.authorName}</strong> ¬∑ ${p.visibility}<br>\n      ${p.text}<br>\n      <button data-admin-deletepost=\"${doc.id}\" class=\"danger\">Delete Post</button>\n    `;"
}</div>
        
      </div>
      
      <div class="finding high">
        <div class="finding-header">
          <span class="finding-title">dom-xss-innerhtml</span>
          <div class="badges">
            <span class="badge high">HIGH</span>
            <span class="badge cwe">CWE-79</span>
            <span class="badge tool">semgrep</span>
            
            
          </div>
        </div>
        <p class="finding-desc">innerHTML XSS. CWE-79</p>
        <div class="evidence"><strong>Evidence:</strong> {
  "file": "/home/nillof/Exjobb/GPT2/mini-social/public/app.js",
  "line": 1263,
  "endLine": 1313,
  "code": "editBody.innerHTML = `\n    <label>Display Name:\n      <input id=\"admin-edit-displayName\" value=\"${u.displayName || \"\"}\">\n    </label>\n\n    <label>Full Name:\n      <input id=\"admin-edit-fullName\" value=\"${u.fullName || \"\"}\">\n    </label>\n\n    <label>Age:\n      <input id=\"admin-edit-age\" type=\"number\" value=\"${u.age || \"\"}\">\n    </label>\n\n    <label>City:\n      <input id=\"admin-edit-city\" value=\"${u.city || \"\"}\">\n    </label>\n\n    <label>Country:\n      <input id=\"admin-edit-country\" value=\"${u.country || \"\"}\">\n    </label>\n\n    <label>About:\n      <textarea id=\"admin-edit-about\">${u.about || \"\"}</textarea>\n    </label>\n\n    <label>Banner:\n      <select id=\"admin-edit-banner\">\n        <option value=\"banner-default\" ${u.banner === \"banner-default\" ? \"selected\" : \"\"}>Default</option>\n        <option value=\"banner-blue\" ${u.banner === \"banner-blue\" ? \"selected\" : \"\"}>Blue</option>\n        <option value=\"banner-green\" ${u.banner === \"banner-green\" ? \"selected\" : \"\"}>Green</option>\n        <option value=\"banner-pink\" ${u.banner === \"banner-pink\" ? \"selected\" : \"\"}>Pink</option>\n      </select>\n    </label>\n\n    <label>Theme:\n      <select id=\"admin-edit-theme\">\n        <option value=\"light\" ${u.theme === \"light\" ? \"selected\" : \"\"}>Light</option>\n        <option value=\"dark\" ${u.theme === \"dark\" ? \"selected\" : \"\"}>Dark</option>\n        <option value=\"blue\" ${u.theme === \"blue\" ? \"selected\" : \"\"}>Blue</option>\n      </select>\n    </label>\n\n    <label>Referral Points:\n      <input id=\"admin-edit-refpoints\" type=\"number\" value=\"${u.referralPoints || 0}\">\n    </label>\n\n    <label>\n      <input type=\"checkbox\" id=\"admin-edit-reset-photo\">\n      Reset profile photo\n    </label>\n  `;"
}</div>
        
      </div>
      
      <div class="finding medium">
        <div class="finding-header">
          <span class="finding-title">Missing File Type Validation in Storage Rules</span>
          <div class="badges">
            <span class="badge medium">MEDIUM</span>
            <span class="badge cwe">CWE-434</span>
            <span class="badge tool">static-analysis</span>
            
            
          </div>
        </div>
        <p class="finding-desc">Storage rules do not validate file content type</p>
        
        <div class="remediation"><strong>Remediation:</strong> Add: && request.resource.contentType.matches('image/.*')</div>
      </div>
      
    </div>
  </div>
  
  <footer>
    <p>Generated by OWASP Security Scanner | 2025-12-15T15:37:22.173Z</p>
  </footer>
</body>
</html>