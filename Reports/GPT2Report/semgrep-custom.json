{"version":"1.144.1","results":[{"check_id":"semgrep.weak-prng-math-floor-random","path":"/home/nillof/Exjobb/GPT2/mini-social/public/app.js","start":{"line":53,"col":18,"offset":1455},"end":{"line":53,"col":58,"offset":1495},"extra":{"metavars":{"$X":{"start":{"line":53,"col":45,"offset":1482},"end":{"line":53,"col":57,"offset":1494},"abstract_content":"chars.length"}},"message":"Math.random for random int. CWE-338","metadata":{"cwe":"CWE-338","owasp":"A02:2021"},"severity":"WARNING","fingerprint":"d21142371604f8d863a4dadc2a70df278361f47e2b6cd247c39b0c77c36480a38919ad086f6b31badaac19900ca2c74bf736550da4f24effb705538d8da84876_0","lines":"    out += chars[Math.floor(Math.random() * chars.length)];","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/GPT2/mini-social/public/app.js","start":{"line":200,"col":50,"offset":5214},"end":{"line":200,"col":72,"offset":5236},"extra":{"metavars":{"$USER":{"start":{"line":200,"col":50,"offset":5214},"end":{"line":200,"col":64,"offset":5228},"abstract_content":"currentUserDoc","propagated_value":{"svalue_start":{"line":187,"col":20,"offset":4819},"svalue_end":{"line":187,"col":31,"offset":4830},"svalue_abstract_content":"snap.data()"}}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"1e3597c1db7957a2cd26905fca87d241770fd75d0e38e19f69c3303e64c8e3afdc8c845bc8002b8a2f5ead27112022b179814562e4d5c8a0eaeefb2c97a5d9cb_0","lines":"  $(\"admin-nav-btn\").classList.toggle(\"hidden\", !currentUserDoc.isAdmin && !currentUserDoc.isOwner);","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/GPT2/mini-social/public/app.js","start":{"line":215,"col":7,"offset":5602},"end":{"line":215,"col":29,"offset":5624},"extra":{"metavars":{"$USER":{"start":{"line":215,"col":7,"offset":5602},"end":{"line":215,"col":21,"offset":5616},"abstract_content":"currentUserDoc","propagated_value":{"svalue_start":{"line":187,"col":20,"offset":4819},"svalue_end":{"line":187,"col":31,"offset":4830},"svalue_abstract_content":"snap.data()"}}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"1e3597c1db7957a2cd26905fca87d241770fd75d0e38e19f69c3303e64c8e3afdc8c845bc8002b8a2f5ead27112022b179814562e4d5c8a0eaeefb2c97a5d9cb_1","lines":"  if (currentUserDoc.isAdmin || currentUserDoc.isOwner) loadAdmin();","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT2/mini-social/public/app.js","start":{"line":277,"col":7,"offset":7105},"end":{"line":284,"col":7,"offset":7435},"extra":{"metavars":{"$EL":{"start":{"line":277,"col":7,"offset":7105},"end":{"line":277,"col":10,"offset":7108},"abstract_content":"div"},"$INPUT":{"start":{"line":277,"col":23,"offset":7121},"end":{"line":284,"col":7,"offset":7435},"abstract_content":"`\n        <div class=\"profile-banner u.banner||\"banner-default\"\"></div>\n        <div class=\"profile-card-body\">\n          <strong>u.displayName</strong><br>\n          <small>u.city||\"\" u.country||\"\"</small><br>\n          <a href=\"profile.html?uid=doc.id\">Open Profile</a>\n        </div>\n      "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"90e71b5c25226dd65028b16978ba745133988971afaf16027063736652383c5148d08d3cb5c65ca3985276998076a22a6b772c162b4b063a3e06f3824d1d660a_0","lines":"      div.innerHTML = `\n        <div class=\"profile-banner ${u.banner || \"banner-default\"}\"></div>\n        <div class=\"profile-card-body\">\n          <strong>${u.displayName}</strong><br>\n          <small>${u.city || \"\"} ${u.country || \"\"}</small><br>\n          <a href=\"profile.html?uid=${doc.id}\">Open Profile</a>\n        </div>\n      `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/GPT2/mini-social/public/app.js","start":{"line":374,"col":9,"offset":9599},"end":{"line":374,"col":31,"offset":9621},"extra":{"metavars":{"$USER":{"start":{"line":374,"col":9,"offset":9599},"end":{"line":374,"col":23,"offset":9613},"abstract_content":"currentUserDoc"}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"1e3597c1db7957a2cd26905fca87d241770fd75d0e38e19f69c3303e64c8e3afdc8c845bc8002b8a2f5ead27112022b179814562e4d5c8a0eaeefb2c97a5d9cb_2","lines":"        currentUserDoc.isAdmin ||","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT2/mini-social/public/app.js","start":{"line":381,"col":7,"offset":9777},"end":{"line":407,"col":7,"offset":10777},"extra":{"metavars":{"$EL":{"start":{"line":381,"col":7,"offset":9777},"end":{"line":381,"col":10,"offset":9780},"abstract_content":"div"},"$INPUT":{"start":{"line":381,"col":23,"offset":9793},"end":{"line":407,"col":7,"offset":10777},"abstract_content":"`\n        <div class=\"post-header\">\n          <div><strong>p.authorName</strong></div>\n          <div class=\"post-meta\">formatDate(p.createdAt) · p.visibility</div>\n        </div>\n\n        <p>p.text</p>\n\n        p.imageUrl`\n          <img src=\"p.imageUrl\"\n               style=\"max-width:100%;border-radius:6px;margin-bottom:0.4rem;\">\"\"\n\n        <div class=\"post-actions\">\n          <button data-like=\"doc.id\">Like</button>\n          <button data-comment=\"doc.id\">Comment</button>\n          <button data-addfriend=\"p.authorId\">Add Friend</button>\n          p.imageUrl`<button data-download=\"p.imageUrl\">Download</button>\"\"\n          p.authorId===currentUser.uid||currentUserDoc.isAdmin||currentUserDoc.isOwner`<button data-deletepost=\"doc.id\" class=\"danger\">Delete</button>\"\"\n        </div>\n\n        <div id=\"comments-doc.id\" class=\"comments\"></div>\n      "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"b328fbab6a878b21e641efcc3817ea21e4f709cfc21531d7de951441b9457ee7ea397fd6ae32a093e4a25cf47c95f17427d9f7482059cff2ecd01b2adf17be3e_0","lines":"      div.innerHTML = `\n        <div class=\"post-header\">\n          <div><strong>${p.authorName}</strong></div>\n          <div class=\"post-meta\">${formatDate(p.createdAt)} · ${p.visibility}</div>\n        </div>\n\n        <p>${p.text}</p>\n\n        ${p.imageUrl ? `\n          <img src=\"${p.imageUrl}\"\n               style=\"max-width:100%;border-radius:6px;margin-bottom:0.4rem;\">`\n        : \"\"}\n\n        <div class=\"post-actions\">\n          <button data-like=\"${doc.id}\">Like</button>\n          <button data-comment=\"${doc.id}\">Comment</button>\n          <button data-addfriend=\"${p.authorId}\">Add Friend</button>\n          ${p.imageUrl ? `<button data-download=\"${p.imageUrl}\">Download</button>` : \"\"}\n          ${\n            (p.authorId === currentUser.uid || currentUserDoc.isAdmin || currentUserDoc.isOwner)\n            ? `<button data-deletepost=\"${doc.id}\" class=\"danger\">Delete</button>`\n            : \"\"\n          }\n        </div>\n\n        <div id=\"comments-${doc.id}\" class=\"comments\"></div>\n      `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/GPT2/mini-social/public/app.js","start":{"line":400,"col":48,"offset":10532},"end":{"line":400,"col":70,"offset":10554},"extra":{"metavars":{"$USER":{"start":{"line":400,"col":48,"offset":10532},"end":{"line":400,"col":62,"offset":10546},"abstract_content":"currentUserDoc"}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"1e3597c1db7957a2cd26905fca87d241770fd75d0e38e19f69c3303e64c8e3afdc8c845bc8002b8a2f5ead27112022b179814562e4d5c8a0eaeefb2c97a5d9cb_3","lines":"            (p.authorId === currentUser.uid || currentUserDoc.isAdmin || currentUserDoc.isOwner)","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT2/mini-social/public/app.js","start":{"line":506,"col":3,"offset":13504},"end":{"line":506,"col":40,"offset":13541},"extra":{"metavars":{"$EL":{"start":{"line":506,"col":3,"offset":13504},"end":{"line":506,"col":23,"offset":13524},"abstract_content":"$(\"my-profile-info\")"},"$INPUT":{"start":{"line":506,"col":36,"offset":13537},"end":{"line":506,"col":40,"offset":13541},"abstract_content":"card","propagated_value":{"svalue_start":{"line":492,"col":16,"offset":13049},"svalue_end":{"line":504,"col":3,"offset":13498},"svalue_abstract_content":"`\n    <div class=\"card profile-card\">\n      <div class=\"profile-banner u.banner\"></div>\n      <div class=\"profile-card-body\">\n        <img src=\"u.photoURL||\"https://via.placeholder.com/64\"\" class=\"profile-photo\">\n        <h3>u.displayName</h3>\n        <p>u.about</p>\n        <p>u.fullName · u.age??\"\"</p>\n        <p>u.city u.country</p>\n        <p>Referral Points: u.referralPoints||0</p>\n      </div>\n    </div>\n  "}}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"c74f072cef021555856ff15552bc5aec8b0fbbc05a97211c996868a9db2bcdac9918508254bbe71de6a2a85083a3aa9ae50360c71f6dd9527a2a8f7f6b4471cc_0","lines":"  $(\"my-profile-info\").innerHTML = card;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT2/mini-social/public/app.js","start":{"line":538,"col":5,"offset":14423},"end":{"line":542,"col":5,"offset":14628},"extra":{"metavars":{"$EL":{"start":{"line":538,"col":5,"offset":14423},"end":{"line":538,"col":8,"offset":14426},"abstract_content":"div"},"$INPUT":{"start":{"line":538,"col":21,"offset":14439},"end":{"line":542,"col":5,"offset":14628},"abstract_content":"`\n      <div class=\"post-meta\">formatDate(p.createdAt) · p.visibility</div>\n      <p>p.text</p>\n      p.imageUrl`<img src=\"p.imageUrl\" style=\"max-width:100%;\">\"\"\n    "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"716c96b5efb7cfbd9309f6236392a800623e50ebcf4b3bea692a65020257680bb1aa6ed686b39bdc296f95833dc9de2d60d65eabd1ebeead78245149ace49bdc_0","lines":"    div.innerHTML = `\n      <div class=\"post-meta\">${formatDate(p.createdAt)} · ${p.visibility}</div>\n      <p>${p.text}</p>\n      ${p.imageUrl ? `<img src=\"${p.imageUrl}\" style=\"max-width:100%;\">` : \"\"}\n    `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.external-reference-script-src","path":"/home/nillof/Exjobb/GPT2/mini-social/public/app.js","start":{"line":620,"col":5,"offset":16566},"end":{"line":620,"col":25,"offset":16586},"extra":{"metavars":{"$SCRIPT":{"start":{"line":620,"col":5,"offset":16566},"end":{"line":620,"col":8,"offset":16569},"abstract_content":"img","propagated_value":{"svalue_start":{"line":619,"col":17,"offset":16531},"svalue_end":{"line":619,"col":46,"offset":16560},"svalue_abstract_content":"document.createElement(\"img\")"}},"$URL":{"start":{"line":620,"col":15,"offset":16576},"end":{"line":620,"col":25,"offset":16586},"abstract_content":"p.imageUrl"}},"message":"Dynamic script.src. CWE-610","metadata":{"cwe":"CWE-610","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"154c9f3daa02113834a2d869f9a8fe4845d921a36a2a7317845b736758459d5359cadf1e5877ef9ab20f8c65d06eadee32c3ac0ec99c1c72b2eb0df9eb81bb92_0","lines":"    img.src = p.imageUrl;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT2/mini-social/public/app.js","start":{"line":649,"col":5,"offset":17280},"end":{"line":652,"col":5,"offset":17397},"extra":{"metavars":{"$EL":{"start":{"line":649,"col":5,"offset":17280},"end":{"line":649,"col":8,"offset":17283},"abstract_content":"div"},"$INPUT":{"start":{"line":649,"col":21,"offset":17296},"end":{"line":652,"col":5,"offset":17397},"abstract_content":"`\n      <strong>Code:</strong> r.code<br>\n      <small>Used r.usedCount||0 times</small>\n    "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"edf50f51a4b2968ea4d753acde23246ab8af71f95eca53b7cdee45dd53cd8a0e38a62e1c4d4f0356d2352aa61ef16cb789d1a7703f1690e25176df15401a2c7a_0","lines":"    div.innerHTML = `\n      <strong>Code:</strong> ${r.code}<br>\n      <small>Used ${r.usedCount || 0} times</small>\n    `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT2/mini-social/public/app.js","start":{"line":757,"col":5,"offset":20068},"end":{"line":761,"col":5,"offset":20206},"extra":{"metavars":{"$EL":{"start":{"line":757,"col":5,"offset":20068},"end":{"line":757,"col":8,"offset":20071},"abstract_content":"div"},"$INPUT":{"start":{"line":757,"col":21,"offset":20084},"end":{"line":761,"col":5,"offset":20206},"abstract_content":"`\n      <strong>u.displayName</strong><br>\n      Age: u.age||\"?\"<br>\n      u.city||\"\" u.country||\"\"\n    "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"648fc767bdcdc0548b5187502108605e54ab6ed534bbd3b03e96d84c29b96f6347fb0eb40a1b475d0c38d061fbe5f1e946e6b4a94508535dd66acbec25c910a1_0","lines":"    div.innerHTML = `\n      <strong>${u.displayName}</strong><br>\n      Age: ${u.age || \"?\"}<br>\n      ${u.city || \"\"} ${u.country || \"\"}\n    `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT2/mini-social/public/app.js","start":{"line":805,"col":5,"offset":21164},"end":{"line":809,"col":5,"offset":21371},"extra":{"metavars":{"$EL":{"start":{"line":805,"col":5,"offset":21164},"end":{"line":805,"col":8,"offset":21167},"abstract_content":"div"},"$INPUT":{"start":{"line":805,"col":21,"offset":21180},"end":{"line":809,"col":5,"offset":21371},"abstract_content":"`\n      <strong>u.displayName</strong><br>\n      u.city||\"\" u.country||\"\"<br>\n      <button data-friend-add=\"doc.id\">already\"Already friend\"\"Add friend\"</button>\n    "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"a2a27c68d8eb1408ffc245e6432c5d2a70a62cfae7a6e684414f021f59ae2ba6d9315b556e1c9a0f1087dbb207a5a6528bdeffb23bc4f342e723ef51e182b107_0","lines":"    div.innerHTML = `\n      <strong>${u.displayName}</strong><br>\n      ${u.city || \"\"} ${u.country || \"\"}<br>\n      <button data-friend-add=\"${doc.id}\">${already ? \"Already friend\" : \"Add friend\"}</button>\n    `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT2/mini-social/public/app.js","start":{"line":859,"col":5,"offset":22512},"end":{"line":863,"col":5,"offset":22682},"extra":{"metavars":{"$EL":{"start":{"line":859,"col":5,"offset":22512},"end":{"line":859,"col":8,"offset":22515},"abstract_content":"div"},"$INPUT":{"start":{"line":859,"col":21,"offset":22528},"end":{"line":863,"col":5,"offset":22682},"abstract_content":"`\n      <strong>u.displayName</strong><br>\n      u.city||\"\" u.country||\"\"<br>\n      <button data-rec-add=\"doc.id\">Add friend</button>\n    "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"e3531e5ce867d028b8705880d1dd5bbffb6984c84c53181cd578de521fd85e9000e09b2d370a23b03a0169895e5fab15abeea16bcf417c84c17ffd5c6b89e104_0","lines":"    div.innerHTML = `\n      <strong>${u.displayName}</strong><br>\n      ${u.city || \"\"} ${u.country || \"\"}<br>\n      <button data-rec-add=\"${doc.id}\">Add friend</button>\n    `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/GPT2/mini-social/public/app.js","start":{"line":1139,"col":8,"offset":30257},"end":{"line":1139,"col":31,"offset":30280},"extra":{"metavars":{"$USER":{"start":{"line":1139,"col":8,"offset":30257},"end":{"line":1139,"col":24,"offset":30273},"abstract_content":"currentUserDoc?."}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"858d797e4bf4025fe48c471d1d761957cfde86ffcf43a367f6de6c67217c11d65c27e0b36ce63bf05e81bc1a4b6f8bffc660dad683f9b6b7bebb1ea521f8c272_0","lines":"  if (!currentUserDoc?.isAdmin && !currentUserDoc?.isOwner) return;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT2/mini-social/public/app.js","start":{"line":1158,"col":5,"offset":30683},"end":{"line":1168,"col":5,"offset":31124},"extra":{"metavars":{"$EL":{"start":{"line":1158,"col":5,"offset":30683},"end":{"line":1158,"col":8,"offset":30686},"abstract_content":"div"},"$INPUT":{"start":{"line":1158,"col":21,"offset":30699},"end":{"line":1168,"col":5,"offset":31124},"abstract_content":"`\n      <strong>u.displayName</strong><br>\n      Email: u.email<br>\n      Admin: u.isAdmin\"Yes\"\"No\" · Owner: u.isOwner\"Yes\"\"No\"<br><br>\n\n      <button data-admin-edit=\"doc.id\">Edit User</button>\n      <button data-admin-toggle=\"doc.id\">\n        u.isAdmin\"Remove Admin\"\"Make Admin\"\n      </button>\n      <button data-admin-deleteuser=\"doc.id\" class=\"danger\">Delete User</button>\n    "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"1e3c7b87ddab0800817a68f08f8b3e388349dc5d8b8a989aa6dde2c3cf1e541722987657c5b1e38272b98b05285dea56fbf331e3e4d7203b6392c573f4cd4ad4_0","lines":"    div.innerHTML = `\n      <strong>${u.displayName}</strong><br>\n      Email: ${u.email}<br>\n      Admin: ${u.isAdmin ? \"Yes\" : \"No\"} · Owner: ${u.isOwner ? \"Yes\" : \"No\"}<br><br>\n\n      <button data-admin-edit=\"${doc.id}\">Edit User</button>\n      <button data-admin-toggle=\"${doc.id}\">\n        ${u.isAdmin ? \"Remove Admin\" : \"Make Admin\"}\n      </button>\n      <button data-admin-deleteuser=\"${doc.id}\" class=\"danger\">Delete User</button>\n    `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/GPT2/mini-social/public/app.js","start":{"line":1161,"col":16,"offset":30788},"end":{"line":1161,"col":25,"offset":30797},"extra":{"metavars":{"$USER":{"start":{"line":1161,"col":16,"offset":30788},"end":{"line":1161,"col":17,"offset":30789},"abstract_content":"u","propagated_value":{"svalue_start":{"line":1153,"col":15,"offset":30590},"svalue_end":{"line":1153,"col":25,"offset":30600},"svalue_abstract_content":"doc.data()"}}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"1f2772860eaf4d3b41c75d93e826da7f47a212bdda0e5c3ba219a77ebc0b2dc6988410cb2853347a4c6cbda682c3b8d2f6da4b57c2c253fc67c411a2c1d616a7_0","lines":"      Admin: ${u.isAdmin ? \"Yes\" : \"No\"} · Owner: ${u.isOwner ? \"Yes\" : \"No\"}<br><br>","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/GPT2/mini-social/public/app.js","start":{"line":1165,"col":11,"offset":30977},"end":{"line":1165,"col":20,"offset":30986},"extra":{"metavars":{"$USER":{"start":{"line":1165,"col":11,"offset":30977},"end":{"line":1165,"col":12,"offset":30978},"abstract_content":"u","propagated_value":{"svalue_start":{"line":1153,"col":15,"offset":30590},"svalue_end":{"line":1153,"col":25,"offset":30600},"svalue_abstract_content":"doc.data()"}}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"1f2772860eaf4d3b41c75d93e826da7f47a212bdda0e5c3ba219a77ebc0b2dc6988410cb2853347a4c6cbda682c3b8d2f6da4b57c2c253fc67c411a2c1d616a7_1","lines":"        ${u.isAdmin ? \"Remove Admin\" : \"Make Admin\"}","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/GPT2/mini-social/public/app.js","start":{"line":1192,"col":36,"offset":31763},"end":{"line":1192,"col":55,"offset":31782},"extra":{"metavars":{"$USER":{"start":{"line":1192,"col":36,"offset":31763},"end":{"line":1192,"col":47,"offset":31774},"abstract_content":"snap.data()"}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"cb91c70f53c9c36f5989c5d0d491686ed11fed4ea3e62342136e1f1c95e9ea1deac356c42a3890244539adc44f9f03ea29ad6cd75bf9c3f769a4f6698743cd4a_0","lines":"      await ref.update({ isAdmin: !snap.data().isAdmin });","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT2/mini-social/public/app.js","start":{"line":1225,"col":5,"offset":32473},"end":{"line":1229,"col":5,"offset":32661},"extra":{"metavars":{"$EL":{"start":{"line":1225,"col":5,"offset":32473},"end":{"line":1225,"col":8,"offset":32476},"abstract_content":"div"},"$INPUT":{"start":{"line":1225,"col":21,"offset":32489},"end":{"line":1229,"col":5,"offset":32661},"abstract_content":"`\n      <strong>p.authorName</strong> · p.visibility<br>\n      p.text<br>\n      <button data-admin-deletepost=\"doc.id\" class=\"danger\">Delete Post</button>\n    "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"25b27e0d2e7891b0324324a1ebd18f29a642c14e133c6e6e46fc993224a3ab217453eb718b490033dc5a5118a265c97dfd6c53ac58e6456b1b67f20997d49131_0","lines":"    div.innerHTML = `\n      <strong>${p.authorName}</strong> · ${p.visibility}<br>\n      ${p.text}<br>\n      <button data-admin-deletepost=\"${doc.id}\" class=\"danger\">Delete Post</button>\n    `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.dom-xss-innerhtml","path":"/home/nillof/Exjobb/GPT2/mini-social/public/app.js","start":{"line":1263,"col":3,"offset":33448},"end":{"line":1313,"col":3,"offset":35142},"extra":{"metavars":{"$EL":{"start":{"line":1263,"col":3,"offset":33448},"end":{"line":1263,"col":11,"offset":33456},"abstract_content":"editBody"},"$INPUT":{"start":{"line":1263,"col":24,"offset":33469},"end":{"line":1313,"col":3,"offset":35142},"abstract_content":"`\n    <label>Display Name:\n      <input id=\"admin-edit-displayName\" value=\"u.displayName||\"\"\">\n    </label>\n\n    <label>Full Name:\n      <input id=\"admin-edit-fullName\" value=\"u.fullName||\"\"\">\n    </label>\n\n    <label>Age:\n      <input id=\"admin-edit-age\" type=\"number\" value=\"u.age||\"\"\">\n    </label>\n\n    <label>City:\n      <input id=\"admin-edit-city\" value=\"u.city||\"\"\">\n    </label>\n\n    <label>Country:\n      <input id=\"admin-edit-country\" value=\"u.country||\"\"\">\n    </label>\n\n    <label>About:\n      <textarea id=\"admin-edit-about\">u.about||\"\"</textarea>\n    </label>\n\n    <label>Banner:\n      <select id=\"admin-edit-banner\">\n        <option value=\"banner-default\" u.banner===\"banner-default\"\"selected\"\"\">Default</option>\n        <option value=\"banner-blue\" u.banner===\"banner-blue\"\"selected\"\"\">Blue</option>\n        <option value=\"banner-green\" u.banner===\"banner-green\"\"selected\"\"\">Green</option>\n        <option value=\"banner-pink\" u.banner===\"banner-pink\"\"selected\"\"\">Pink</option>\n      </select>\n    </label>\n\n    <label>Theme:\n      <select id=\"admin-edit-theme\">\n        <option value=\"light\" u.theme===\"light\"\"selected\"\"\">Light</option>\n        <option value=\"dark\" u.theme===\"dark\"\"selected\"\"\">Dark</option>\n        <option value=\"blue\" u.theme===\"blue\"\"selected\"\"\">Blue</option>\n      </select>\n    </label>\n\n    <label>Referral Points:\n      <input id=\"admin-edit-refpoints\" type=\"number\" value=\"u.referralPoints||0\">\n    </label>\n\n    <label>\n      <input type=\"checkbox\" id=\"admin-edit-reset-photo\">\n      Reset profile photo\n    </label>\n  "}},"message":"innerHTML XSS. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"ERROR","fingerprint":"1eec62b96911cc4ff71dfa20b413c71c0039d4aedbb6a0aead1409b85899d8776688b5f581873c49a7ec6f490072b283dc632e8762a73acd85eca91e7502c788_0","lines":"  editBody.innerHTML = `\n    <label>Display Name:\n      <input id=\"admin-edit-displayName\" value=\"${u.displayName || \"\"}\">\n    </label>\n\n    <label>Full Name:\n      <input id=\"admin-edit-fullName\" value=\"${u.fullName || \"\"}\">\n    </label>\n\n    <label>Age:\n      <input id=\"admin-edit-age\" type=\"number\" value=\"${u.age || \"\"}\">\n    </label>\n\n    <label>City:\n      <input id=\"admin-edit-city\" value=\"${u.city || \"\"}\">\n    </label>\n\n    <label>Country:\n      <input id=\"admin-edit-country\" value=\"${u.country || \"\"}\">\n    </label>\n\n    <label>About:\n      <textarea id=\"admin-edit-about\">${u.about || \"\"}</textarea>\n    </label>\n\n    <label>Banner:\n      <select id=\"admin-edit-banner\">\n        <option value=\"banner-default\" ${u.banner === \"banner-default\" ? \"selected\" : \"\"}>Default</option>\n        <option value=\"banner-blue\" ${u.banner === \"banner-blue\" ? \"selected\" : \"\"}>Blue</option>\n        <option value=\"banner-green\" ${u.banner === \"banner-green\" ? \"selected\" : \"\"}>Green</option>\n        <option value=\"banner-pink\" ${u.banner === \"banner-pink\" ? \"selected\" : \"\"}>Pink</option>\n      </select>\n    </label>\n\n    <label>Theme:\n      <select id=\"admin-edit-theme\">\n        <option value=\"light\" ${u.theme === \"light\" ? \"selected\" : \"\"}>Light</option>\n        <option value=\"dark\" ${u.theme === \"dark\" ? \"selected\" : \"\"}>Dark</option>\n        <option value=\"blue\" ${u.theme === \"blue\" ? \"selected\" : \"\"}>Blue</option>\n      </select>\n    </label>\n\n    <label>Referral Points:\n      <input id=\"admin-edit-refpoints\" type=\"number\" value=\"${u.referralPoints || 0}\">\n    </label>\n\n    <label>\n      <input type=\"checkbox\" id=\"admin-edit-reset-photo\">\n      Reset profile photo\n    </label>\n  `;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[],"paths":{"scanned":["/home/nillof/Exjobb/GPT2/mini-social/public/app.js"]},"time":{"rules":[],"rules_parse_time":0.03343701362609863,"profiling_times":{"config_time":0.2194056510925293,"core_time":0.4293389320373535,"ignores_time":0.0001373291015625,"total_time":0.6491177082061768},"parsing_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":0.19393515586853027,"per_file_time":{"mean":0.19393515586853027,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"matching_time":{"total_time":0.0,"per_file_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.0,"per_def_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"fixpoint_timeouts":[],"prefiltering":{"project_level_time":0.0,"file_level_time":0.0,"rules_with_project_prefilters_ratio":0.0,"rules_with_file_prefilters_ratio":0.9788732394366197,"rules_selected_ratio":0.15492957746478872,"rules_matched_ratio":0.15492957746478872},"targets":[],"total_bytes":0,"max_memory_bytes":211790912},"engine_requested":"OSS","interfile_languages_used":[],"skipped_rules":[],"profiling_results":[]}