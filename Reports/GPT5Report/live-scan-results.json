{
  "metadata": {
    "scanDate": "2025-12-16T11:07:42.483Z",
    "target": "https://gpt-5-338b7.web.app",
    "projectId": "gpt-5-338b7",
    "type": "live-security-test"
  },
  "summary": {
    "total": 4,
    "bySeverity": {
      "CRITICAL": 2,
      "HIGH": 1,
      "MEDIUM": 1,
      "LOW": 0
    },
    "testResults": {
      "passed": 5,
      "failed": 4
    }
  },
  "findings": [
    {
      "id": "LIVE-001",
      "category": "A01",
      "cwe": "CWE-269",
      "severity": "CRITICAL",
      "title": "Privilege Escalation: Self-Elevation to Admin",
      "description": "User successfully set their own isAdmin flag to true",
      "evidence": {
        "userId": "IrC0moxaFDOegg7wki3r6WC5z6t2",
        "before": false,
        "after": true
      },
      "remediation": "Prevent modification of privilege fields in Firestore rules OR use Custom Claims",
      "tool": "live-scanner",
      "confirmed": true,
      "timestamp": "2025-12-16T11:07:22.884Z"
    },
    {
      "id": "LIVE-002",
      "category": "A01",
      "cwe": "CWE-269",
      "severity": "CRITICAL",
      "title": "Privilege Escalation: Self-Elevation to Owner",
      "description": "User successfully set their own isOwner flag to true",
      "evidence": {
        "userId": "IrC0moxaFDOegg7wki3r6WC5z6t2",
        "before": false,
        "after": true
      },
      "remediation": "Prevent modification of privilege fields in Firestore rules",
      "tool": "live-scanner",
      "confirmed": true,
      "timestamp": "2025-12-16T11:07:23.436Z"
    },
    {
      "id": "LIVE-003",
      "category": "A01",
      "cwe": "CWE-284",
      "severity": "HIGH",
      "title": "Improper Access Control: Unauthenticated User Data Access",
      "description": "3 user profiles readable without authentication",
      "evidence": {
        "userCount": 3,
        "exposedFields": [
          "themeKey",
          "createdAt",
          "name",
          "uid",
          "displayName",
          "updatedAt",
          "city",
          "referralOptOut",
          "country",
          "bannerKey",
          "referralPoints",
          "aboutMe",
          "profilePhotoPath",
          "role",
          "age"
        ],
        "sensitiveFields": [
          "city",
          "country",
          "age"
        ]
      },
      "remediation": "Change to: allow read: if request.auth != null",
      "tool": "live-scanner",
      "confirmed": true,
      "timestamp": "2025-12-16T11:07:28.842Z"
    },
    {
      "id": "LIVE-004",
      "category": "A01",
      "cwe": "CWE-639",
      "severity": "MEDIUM",
      "title": "IDOR: User Enumeration",
      "description": "Authenticated user can enumerate and access all user profiles",
      "evidence": {
        "usersAccessible": 3
      },
      "remediation": "Restrict read access to own profile or implement field-level security",
      "tool": "live-scanner",
      "confirmed": true,
      "timestamp": "2025-12-16T11:07:34.047Z"
    }
  ],
  "testResults": [
    {
      "name": "Privilege Escalation (isAdmin)",
      "passed": false,
      "details": "User elevated to admin",
      "timestamp": "2025-12-16T11:07:22.884Z"
    },
    {
      "name": "Privilege Escalation (isOwner)",
      "passed": false,
      "details": "User elevated to owner",
      "timestamp": "2025-12-16T11:07:23.436Z"
    },
    {
      "name": "Cross-User Modification",
      "passed": true,
      "details": "Protected: 7 PERMISSION_DENIED: Missing or insufficient permissions.",
      "timestamp": "2025-12-16T11:07:26.954Z"
    },
    {
      "name": "Unauthenticated User Read",
      "passed": false,
      "details": "Read 3 users",
      "timestamp": "2025-12-16T11:07:28.842Z"
    },
    {
      "name": "Unauthenticated Post Read",
      "passed": true,
      "details": "Protected: Missing or insufficient permissions.",
      "timestamp": "2025-12-16T11:07:29.025Z"
    },
    {
      "name": "Message Injection",
      "passed": true,
      "details": "Protected: 7 PERMISSION_DENIED: Missing or insufficient permissions.",
      "timestamp": "2025-12-16T11:07:31.680Z"
    },
    {
      "name": "User Enumeration",
      "passed": false,
      "details": "Accessed 3 users",
      "timestamp": "2025-12-16T11:07:34.047Z"
    },
    {
      "name": "PII Exposure",
      "passed": true,
      "details": "No PII exposed",
      "timestamp": "2025-12-16T11:07:36.401Z"
    },
    {
      "name": "Stored XSS",
      "passed": true,
      "details": "All payloads blocked",
      "timestamp": "2025-12-16T11:07:42.481Z"
    }
  ]
}