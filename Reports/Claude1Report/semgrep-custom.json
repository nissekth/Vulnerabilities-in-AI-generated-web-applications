{"version":"1.144.1","results":[{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/Claude1/social-media-app/src/App.jsx","start":{"line":32,"col":25,"offset":1262},"end":{"line":32,"col":45,"offset":1282},"extra":{"metavars":{"$USER":{"start":{"line":32,"col":25,"offset":1262},"end":{"line":32,"col":38,"offset":1275},"abstract_content":"userProfile?."}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"80c7ba8ced7168ab5ff62a1c42f632c09486584b26a134445799986e89721db5716082b89a6373376e05d4ee3ed1ff6361450a3230f2963e1572c1e9b7dff80c_0","lines":"  return currentUser && userProfile?.isAdmin ? children : <Navigate to=\"/\" />;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.firebase-no-auth-deletedoc","path":"/home/nillof/Exjobb/Claude1/social-media-app/src/components/PostCard.jsx","start":{"line":92,"col":13,"offset":2683},"end":{"line":92,"col":49,"offset":2719},"extra":{"metavars":{"$DB":{"start":{"line":92,"col":27,"offset":2697},"end":{"line":92,"col":29,"offset":2699},"abstract_content":"db db"},"$COLL":{"start":{"line":92,"col":31,"offset":2701},"end":{"line":92,"col":38,"offset":2708},"abstract_content":"'posts'"},"$ID":{"start":{"line":92,"col":40,"offset":2710},"end":{"line":92,"col":47,"offset":2717},"abstract_content":"post.id"}},"message":"Firestore deleteDoc without auth check. CWE-284","metadata":{"cwe":"CWE-284","owasp":"A01:2021"},"severity":"WARNING","fingerprint":"7b89864f7272fab9b64774a23c77172b804d8715d794ae0e9127d0f2bcc98067d9cb8b13398e69cc4379d28e3f010810f5fe8e84910e03a1d424e6d67b3811c9_0","lines":"      await deleteDoc(doc(db, 'posts', post.id));","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/Claude1/social-media-app/src/components/PostCard.jsx","start":{"line":109,"col":19,"offset":3179},"end":{"line":109,"col":39,"offset":3199},"extra":{"metavars":{"$USER":{"start":{"line":109,"col":19,"offset":3179},"end":{"line":109,"col":32,"offset":3192},"abstract_content":"userProfile?."}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"d3b7e656b68eb47d887ac6eb8d736baf7ed782b98ea755d29eaa9cf8cdb1a3263cc3f75ff29da7ad99285c787557810064312d483df162dc05784d199d1812f7_0","lines":"  const isAdmin = userProfile?.isAdmin;","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.firebase-upload","path":"/home/nillof/Exjobb/Claude1/social-media-app/src/components/PostCreate.jsx","start":{"line":58,"col":15,"offset":1911},"end":{"line":58,"col":43,"offset":1939},"extra":{"metavars":{"$REF":{"start":{"line":58,"col":27,"offset":1923},"end":{"line":58,"col":35,"offset":1931},"abstract_content":"imageRef","propagated_value":{"svalue_start":{"line":57,"col":26,"offset":1827},"svalue_end":{"line":57,"col":94,"offset":1895},"svalue_abstract_content":"ref(storage`posts/currentUser.uid/Date.now()_ image.name)"}},"$FILE":{"start":{"line":58,"col":37,"offset":1933},"end":{"line":58,"col":42,"offset":1938},"abstract_content":"image"}},"message":"File upload. CWE-434","metadata":{"cwe":"CWE-434","owasp":"A03:2021"},"severity":"INFO","fingerprint":"c277f63cdbe0f97db1534458e98d5bce5e2c074e799864c4fb7090476892bc6235787ba67e7a84510773ed66a1f45cc1083778d42c82f84e2044bd8ca13b7e52_0","lines":"        await uploadBytes(imageRef, image);","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.firebase-no-auth-setdoc","path":"/home/nillof/Exjobb/Claude1/social-media-app/src/contexts/AuthContext.jsx","start":{"line":33,"col":11,"offset":1156},"end":{"line":54,"col":7,"offset":1692},"extra":{"metavars":{"$DB":{"start":{"line":33,"col":22,"offset":1167},"end":{"line":33,"col":24,"offset":1169},"abstract_content":"db db"},"$COLL":{"start":{"line":33,"col":26,"offset":1171},"end":{"line":33,"col":33,"offset":1178},"abstract_content":"'users'"},"$ID":{"start":{"line":33,"col":35,"offset":1180},"end":{"line":33,"col":43,"offset":1188},"abstract_content":"user.uid"},"$DATA":{"start":{"line":33,"col":46,"offset":1191},"end":{"line":54,"col":6,"offset":1691},"abstract_content":"{uid user.uid email email displayName displayName name displayName age null city''country''bio''profilePicture''banner'gradient1'theme'default'colorScheme'rose'friends[]friendRequests[]referralCode generateReferralCode()referralPoints 0 referralsUsed 0 referralOptOut false createdAt serverTimestamp()isAdmin false}"}},"message":"Firestore setDoc without auth check. CWE-284","metadata":{"cwe":"CWE-284","owasp":"A01:2021"},"severity":"WARNING","fingerprint":"4a73ee1f8c4b1deb3f7ce56196f7ce038ce6c43f0de095b0e733295a8200d4a6fc779cdcd562e21a5f6766b6002cd56bb1df1a8a1e10ad7b7b5f9c8a38634186_0","lines":"    await setDoc(doc(db, 'users', user.uid), {\n      uid: user.uid,\n      email: email,\n      displayName: displayName,\n      name: displayName,\n      age: null,\n      city: '',\n      country: '',\n      bio: '',\n      profilePicture: '',\n      banner: 'gradient1',\n      theme: 'default',\n      colorScheme: 'rose',\n      friends: [],\n      friendRequests: [],\n      referralCode: generateReferralCode(),\n      referralPoints: 0,\n      referralsUsed: 0,\n      referralOptOut: false,\n      createdAt: serverTimestamp(),\n      isAdmin: false\n    });","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/Claude1/social-media-app/src/pages/AdminLoginPage.jsx","start":{"line":24,"col":31,"offset":843},"end":{"line":24,"col":53,"offset":865},"extra":{"metavars":{"$USER":{"start":{"line":24,"col":31,"offset":843},"end":{"line":24,"col":45,"offset":857},"abstract_content":"userDoc.data()"}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"dab4a272ed49febbe945aba69a232e85a532b84cbe4c8b9b22979ff1e0286a8c4687da3bf8563b09f30bb64591b247d23275923fecf9224127b12ca9f40ad2bf_0","lines":"      if (userDoc.exists() && userDoc.data().isAdmin) {","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.firebase-no-auth-deletedoc","path":"/home/nillof/Exjobb/Claude1/social-media-app/src/pages/AdminPage.jsx","start":{"line":40,"col":13,"offset":1377},"end":{"line":40,"col":48,"offset":1412},"extra":{"metavars":{"$DB":{"start":{"line":40,"col":27,"offset":1391},"end":{"line":40,"col":29,"offset":1393},"abstract_content":"db"},"$COLL":{"start":{"line":40,"col":31,"offset":1395},"end":{"line":40,"col":38,"offset":1402},"abstract_content":"'users'"},"$ID":{"start":{"line":40,"col":40,"offset":1404},"end":{"line":40,"col":46,"offset":1410},"abstract_content":"userId"}},"message":"Firestore deleteDoc without auth check. CWE-284","metadata":{"cwe":"CWE-284","owasp":"A01:2021"},"severity":"WARNING","fingerprint":"efa77a8093067ee32b908aaa97d136fe21946127aa6bc19b10c0db38911be081884c4f4deb2d2a5cb2ade79454f80cb2ae482f5f46a8c2ee7b50b7c8821f2215_0","lines":"      await deleteDoc(doc(db, 'users', userId));","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.firebase-no-auth-deletedoc","path":"/home/nillof/Exjobb/Claude1/social-media-app/src/pages/AdminPage.jsx","start":{"line":42,"col":44,"offset":1521},"end":{"line":42,"col":77,"offset":1554},"extra":{"metavars":{"$DB":{"start":{"line":42,"col":58,"offset":1535},"end":{"line":42,"col":60,"offset":1537},"abstract_content":"db"},"$COLL":{"start":{"line":42,"col":62,"offset":1539},"end":{"line":42,"col":69,"offset":1546},"abstract_content":"'posts'"},"$ID":{"start":{"line":42,"col":71,"offset":1548},"end":{"line":42,"col":75,"offset":1552},"abstract_content":"p.id"}},"message":"Firestore deleteDoc without auth check. CWE-284","metadata":{"cwe":"CWE-284","owasp":"A01:2021"},"severity":"WARNING","fingerprint":"3a25c45f38fbd34d8234b93b8a9cd5739084bc89d344457b37e97c6ee7b23bbeda974f8d4e1c01e492c33ad3ac2952b0c6235e2fd132e001a20766e962543bc1_0","lines":"      await Promise.all(userPosts.map(p => deleteDoc(doc(db, 'posts', p.id))));","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.firebase-no-auth-deletedoc","path":"/home/nillof/Exjobb/Claude1/social-media-app/src/pages/AdminPage.jsx","start":{"line":55,"col":13,"offset":1849},"end":{"line":55,"col":48,"offset":1884},"extra":{"metavars":{"$DB":{"start":{"line":55,"col":27,"offset":1863},"end":{"line":55,"col":29,"offset":1865},"abstract_content":"db db"},"$COLL":{"start":{"line":55,"col":31,"offset":1867},"end":{"line":55,"col":38,"offset":1874},"abstract_content":"'posts'"},"$ID":{"start":{"line":55,"col":40,"offset":1876},"end":{"line":55,"col":46,"offset":1882},"abstract_content":"postId"}},"message":"Firestore deleteDoc without auth check. CWE-284","metadata":{"cwe":"CWE-284","owasp":"A01:2021"},"severity":"WARNING","fingerprint":"3881c453e49ea9e8e95a7a66bd3c1c517f9dec8d08efa0a5ebeb750f2bd7c2feb14aa7d7c010f13fc962e65808aec91b975807649be3ad1ca00a94403655b8ec_0","lines":"      await deleteDoc(doc(db, 'posts', postId));","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/Claude1/social-media-app/src/pages/AdminPage.jsx","start":{"line":147,"col":27,"offset":5702},"end":{"line":147,"col":39,"offset":5714},"extra":{"metavars":{"$USER":{"start":{"line":147,"col":27,"offset":5702},"end":{"line":147,"col":31,"offset":5706},"abstract_content":"user"}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"bc4001bd2335e2780bbb19bc7f33f2dd0330ba7311b6a410e70bf32f28b619d097030b5a2d9a496bbffca8981aab7cdd16d9a830468321244682acafd01ab506_0","lines":"                          user.isAdmin ? 'bg-purple-100 text-purple-800' : 'bg-gray-100 text-gray-800'","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/Claude1/social-media-app/src/pages/AdminPage.jsx","start":{"line":149,"col":28,"offset":5835},"end":{"line":149,"col":40,"offset":5847},"extra":{"metavars":{"$USER":{"start":{"line":149,"col":28,"offset":5835},"end":{"line":149,"col":32,"offset":5839},"abstract_content":"user"}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"bc4001bd2335e2780bbb19bc7f33f2dd0330ba7311b6a410e70bf32f28b619d097030b5a2d9a496bbffca8981aab7cdd16d9a830468321244682acafd01ab506_1","lines":"                          {user.isAdmin ? 'Admin' : 'User'}","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/Claude1/social-media-app/src/pages/AdminPage.jsx","start":{"line":154,"col":69,"offset":6088},"end":{"line":154,"col":81,"offset":6100},"extra":{"metavars":{"$USER":{"start":{"line":154,"col":69,"offset":6088},"end":{"line":154,"col":73,"offset":6092},"abstract_content":"user"}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"bc4001bd2335e2780bbb19bc7f33f2dd0330ba7311b6a410e70bf32f28b619d097030b5a2d9a496bbffca8981aab7cdd16d9a830468321244682acafd01ab506_2","lines":"                          onClick={() => handleToggleAdmin(user.id, user.isAdmin)}","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.client-side-isadmin","path":"/home/nillof/Exjobb/Claude1/social-media-app/src/pages/AdminPage.jsx","start":{"line":157,"col":28,"offset":6247},"end":{"line":157,"col":40,"offset":6259},"extra":{"metavars":{"$USER":{"start":{"line":157,"col":28,"offset":6247},"end":{"line":157,"col":32,"offset":6251},"abstract_content":"user"}},"message":"Client-side admin check. CWE-863","metadata":{"cwe":"CWE-863","owasp":"A01:2021"},"severity":"ERROR","fingerprint":"bc4001bd2335e2780bbb19bc7f33f2dd0330ba7311b6a410e70bf32f28b619d097030b5a2d9a496bbffca8981aab7cdd16d9a830468321244682acafd01ab506_3","lines":"                          {user.isAdmin ? 'Remove Admin' : 'Make Admin'}","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.firebase-stored-xss","path":"/home/nillof/Exjobb/Claude1/social-media-app/src/pages/MessagesPage.jsx","start":{"line":88,"col":13,"offset":2687},"end":{"line":94,"col":9,"offset":2967},"extra":{"metavars":{"$COLLECTION":{"start":{"line":88,"col":20,"offset":2694},"end":{"line":88,"col":46,"offset":2720},"abstract_content":"collection(db'messages')"},"$INPUT":{"start":{"line":89,"col":18,"offset":2741},"end":{"line":89,"col":35,"offset":2758},"abstract_content":"newMessage.trim()"}},"message":"User content stored. CWE-79","metadata":{"cwe":"CWE-79","owasp":"A03:2021"},"severity":"WARNING","fingerprint":"af49542b29692d250c29af55db7271d29273063c7176051102a818604cee2b4aaced18219a118e35e8cd6ed6e83b7f63c878e14023d2fdb19d7e03ad9b305a06_0","lines":"      await addDoc(collection(db, 'messages'), {\n        content: newMessage.trim(),\n        senderId: currentUser.uid,\n        senderName: userProfile?.displayName || userProfile?.name,\n        participants: [currentUser.uid, selectedFriend.id],\n        createdAt: serverTimestamp()\n      });","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.firebase-upload","path":"/home/nillof/Exjobb/Claude1/social-media-app/src/pages/SettingsPage.jsx","start":{"line":45,"col":13,"offset":1660},"end":{"line":45,"col":40,"offset":1687},"extra":{"metavars":{"$REF":{"start":{"line":45,"col":25,"offset":1672},"end":{"line":45,"col":33,"offset":1680},"abstract_content":"imageRef","propagated_value":{"svalue_start":{"line":44,"col":24,"offset":1591},"svalue_end":{"line":44,"col":79,"offset":1646},"svalue_abstract_content":"ref(storage`profiles/currentUser.uid/profile-pic)"}},"$FILE":{"start":{"line":45,"col":35,"offset":1682},"end":{"line":45,"col":39,"offset":1686},"abstract_content":"file","propagated_value":{"svalue_start":{"line":35,"col":18,"offset":1405},"svalue_end":{"line":35,"col":35,"offset":1422},"svalue_abstract_content":"e.target.files[0]"}}},"message":"File upload. CWE-434","metadata":{"cwe":"CWE-434","owasp":"A03:2021"},"severity":"INFO","fingerprint":"a6384cc0eba80233ba5a07d2b790f73baaae16b16ad1d08ecc0afc5341f5ef6ccfa1118f795aea01e955c35851d33b3b3c7e738e3d08c2695840d9c39d447e12_0","lines":"      await uploadBytes(imageRef, file);","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.firebase-no-auth-deletedoc","path":"/home/nillof/Exjobb/Claude1/social-media-app/src/pages/SettingsPage.jsx","start":{"line":87,"col":13,"offset":3036},"end":{"line":87,"col":57,"offset":3080},"extra":{"metavars":{"$DB":{"start":{"line":87,"col":27,"offset":3050},"end":{"line":87,"col":29,"offset":3052},"abstract_content":"db db"},"$COLL":{"start":{"line":87,"col":31,"offset":3054},"end":{"line":87,"col":38,"offset":3061},"abstract_content":"'users'"},"$ID":{"start":{"line":87,"col":40,"offset":3063},"end":{"line":87,"col":55,"offset":3078},"abstract_content":"currentUser.uid"}},"message":"Firestore deleteDoc without auth check. CWE-284","metadata":{"cwe":"CWE-284","owasp":"A01:2021"},"severity":"WARNING","fingerprint":"3e432b19c0dcaf183d6410a92f0125714834ed382224fd11124dcaec0085167b268c03aeb49b7e42a0532d2dc7f0c98f7739cfbbbdd258cc94d583bded914a66_0","lines":"      await deleteDoc(doc(db, 'users', currentUser.uid));","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[],"paths":{"scanned":["/home/nillof/Exjobb/Claude1/social-media-app/postcss.config.js","/home/nillof/Exjobb/Claude1/social-media-app/src/App.jsx","/home/nillof/Exjobb/Claude1/social-media-app/src/components/Navbar.jsx","/home/nillof/Exjobb/Claude1/social-media-app/src/components/PostCard.jsx","/home/nillof/Exjobb/Claude1/social-media-app/src/components/PostCreate.jsx","/home/nillof/Exjobb/Claude1/social-media-app/src/contexts/AuthContext.jsx","/home/nillof/Exjobb/Claude1/social-media-app/src/contexts/ThemeContext.jsx","/home/nillof/Exjobb/Claude1/social-media-app/src/firebase.js","/home/nillof/Exjobb/Claude1/social-media-app/src/main.jsx","/home/nillof/Exjobb/Claude1/social-media-app/src/pages/AdminLoginPage.jsx","/home/nillof/Exjobb/Claude1/social-media-app/src/pages/AdminPage.jsx","/home/nillof/Exjobb/Claude1/social-media-app/src/pages/BillingPage.jsx","/home/nillof/Exjobb/Claude1/social-media-app/src/pages/ForgotPasswordPage.jsx","/home/nillof/Exjobb/Claude1/social-media-app/src/pages/FriendsPage.jsx","/home/nillof/Exjobb/Claude1/social-media-app/src/pages/HomePage.jsx","/home/nillof/Exjobb/Claude1/social-media-app/src/pages/LoginPage.jsx","/home/nillof/Exjobb/Claude1/social-media-app/src/pages/MessagesPage.jsx","/home/nillof/Exjobb/Claude1/social-media-app/src/pages/OwnerPage.jsx","/home/nillof/Exjobb/Claude1/social-media-app/src/pages/ProfilePage.jsx","/home/nillof/Exjobb/Claude1/social-media-app/src/pages/RegisterPage.jsx","/home/nillof/Exjobb/Claude1/social-media-app/src/pages/SearchPage.jsx","/home/nillof/Exjobb/Claude1/social-media-app/src/pages/SettingsPage.jsx","/home/nillof/Exjobb/Claude1/social-media-app/src/pages/WelcomePage.jsx","/home/nillof/Exjobb/Claude1/social-media-app/tailwind.config.js","/home/nillof/Exjobb/Claude1/social-media-app/vite.config.js"]},"time":{"rules":[],"rules_parse_time":0.03337216377258301,"profiling_times":{"config_time":0.21627306938171387,"core_time":0.43464207649230957,"ignores_time":0.0001354217529296875,"total_time":0.6512818336486816},"parsing_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":0.49782729148864746,"per_file_time":{"mean":0.019913091659545898,"std_dev":0.00017800338055203605},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"matching_time":{"total_time":0.0,"per_file_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.0,"per_def_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"fixpoint_timeouts":[],"prefiltering":{"project_level_time":0.0,"file_level_time":0.0,"rules_with_project_prefilters_ratio":0.0,"rules_with_file_prefilters_ratio":0.9788732394366197,"rules_selected_ratio":0.051830985915492955,"rules_matched_ratio":0.051830985915492955},"targets":[],"total_bytes":0,"max_memory_bytes":188959744},"engine_requested":"OSS","interfile_languages_used":[],"skipped_rules":[],"profiling_results":[]}