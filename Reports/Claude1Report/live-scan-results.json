{
  "metadata": {
    "scanDate": "2025-12-15T15:55:41.046Z",
    "target": "https://claude1-f630a.web.app",
    "projectId": "claude1-f630a",
    "type": "live-security-test"
  },
  "summary": {
    "total": 8,
    "bySeverity": {
      "CRITICAL": 2,
      "HIGH": 3,
      "MEDIUM": 3,
      "LOW": 0
    },
    "testResults": {
      "passed": 2,
      "failed": 8
    }
  },
  "findings": [
    {
      "id": "LIVE-001",
      "category": "A01",
      "cwe": "CWE-269",
      "severity": "CRITICAL",
      "title": "Privilege Escalation: Self-Elevation to Admin",
      "description": "User successfully set their own isAdmin flag to true",
      "evidence": {
        "userId": "1f9Oi7FYVcbV0YGYDfl3hbsCbEo2",
        "before": false,
        "after": true
      },
      "remediation": "Prevent modification of privilege fields in Firestore rules OR use Custom Claims",
      "tool": "live-scanner",
      "confirmed": true,
      "timestamp": "2025-12-15T15:55:30.059Z"
    },
    {
      "id": "LIVE-002",
      "category": "A01",
      "cwe": "CWE-285",
      "severity": "CRITICAL",
      "title": "Improper Authorization: Cross-User Profile Modification",
      "description": "User 1f9Oi7FYVcbV0YGYDfl3hbsCbEo2 modified user 7kO2isk0XUZe0PuytBO7iSqaLrB2's profile",
      "evidence": {
        "attacker": "1f9Oi7FYVcbV0YGYDfl3hbsCbEo2",
        "victim": "7kO2isk0XUZe0PuytBO7iSqaLrB2",
        "modified": "bio"
      },
      "remediation": "Add owner check: allow update: if request.auth.uid == userId",
      "tool": "live-scanner",
      "confirmed": true,
      "timestamp": "2025-12-15T15:55:32.179Z"
    },
    {
      "id": "LIVE-003",
      "category": "A01",
      "cwe": "CWE-284",
      "severity": "HIGH",
      "title": "Improper Access Control: Unauthenticated User Data Access",
      "description": "9 user profiles readable without authentication",
      "evidence": {
        "userCount": 9,
        "exposedFields": [
          "banner",
          "theme",
          "createdAt",
          "gallery",
          "friendRequests",
          "referralPoints",
          "referralsUsed",
          "referralOptOut",
          "displayName",
          "referralCode",
          "country",
          "profilePicture",
          "name",
          "friends",
          "isAdmin",
          "email",
          "uid",
          "colorScheme",
          "city",
          "bio",
          "age",
          "isOwner"
        ],
        "sensitiveFields": [
          "friendRequests",
          "referralCode",
          "country",
          "friends",
          "email",
          "city",
          "age"
        ]
      },
      "remediation": "Change to: allow read: if request.auth != null",
      "tool": "live-scanner",
      "confirmed": true,
      "timestamp": "2025-12-15T15:55:33.412Z"
    },
    {
      "id": "LIVE-004",
      "category": "A02",
      "cwe": "CWE-311",
      "severity": "MEDIUM",
      "title": "Public Post Access",
      "description": "10 posts readable without authentication",
      "evidence": {
        "postCount": 10
      },
      "remediation": "Consider: allow read: if resource.data.visibility == \"public\"",
      "tool": "live-scanner",
      "confirmed": true,
      "timestamp": "2025-12-15T15:55:33.491Z"
    },
    {
      "id": "LIVE-005",
      "category": "A01",
      "cwe": "CWE-284",
      "severity": "HIGH",
      "title": "Message Injection: Create Messages Between Other Users",
      "description": "Attacker created a message appearing to be between other users without being a participant",
      "evidence": {
        "messageId": "4G7veM5vgGjFrpLe22Ol",
        "spoofedSender": "7kO2isk0XUZe0PuytBO7iSqaLrB2",
        "recipient": "Jc11AFr5hMPMFhGY3Rg2IvaRGNr2"
      },
      "remediation": "Validate sender in rules: request.auth.uid in request.resource.data.participants && request.resource.data.senderId == request.auth.uid",
      "tool": "live-scanner",
      "confirmed": true,
      "timestamp": "2025-12-15T15:55:35.275Z"
    },
    {
      "id": "LIVE-006",
      "category": "A01",
      "cwe": "CWE-639",
      "severity": "MEDIUM",
      "title": "IDOR: User Enumeration",
      "description": "Authenticated user can enumerate and access all user profiles",
      "evidence": {
        "usersAccessible": 9
      },
      "remediation": "Restrict read access to own profile or implement field-level security",
      "tool": "live-scanner",
      "confirmed": true,
      "timestamp": "2025-12-15T15:55:36.939Z"
    },
    {
      "id": "LIVE-007",
      "category": "A02",
      "cwe": "CWE-359",
      "severity": "HIGH",
      "title": "Exposure of Private Personal Information",
      "description": "Other users' PII accessible: email, friends, friendRequests, referralCode",
      "evidence": {
        "exposedPII": [
          "email",
          "friends",
          "friendRequests",
          "referralCode"
        ],
        "affectedUsers": 8
      },
      "remediation": "Implement field-level access control or separate public/private profile data",
      "tool": "live-scanner",
      "confirmed": true,
      "timestamp": "2025-12-15T15:55:38.549Z"
    },
    {
      "id": "LIVE-008",
      "category": "A03",
      "cwe": "CWE-79",
      "severity": "MEDIUM",
      "title": "Stored XSS: Unsanitized Content Storage",
      "description": "4/4 XSS payloads stored without sanitization. If rendered with dangerouslySetInnerHTML, XSS is possible.",
      "evidence": {
        "storedPayloads": 4,
        "totalTested": 4
      },
      "remediation": "Sanitize user input with DOMPurify before storage",
      "tool": "live-scanner",
      "confirmed": true,
      "timestamp": "2025-12-15T15:55:41.045Z"
    }
  ],
  "testResults": [
    {
      "name": "Privilege Escalation (isAdmin)",
      "passed": false,
      "details": "User elevated to admin",
      "timestamp": "2025-12-15T15:55:30.060Z"
    },
    {
      "name": "Privilege Escalation (isOwner)",
      "passed": true,
      "details": "Could not modify isOwner",
      "timestamp": "2025-12-15T15:55:30.305Z"
    },
    {
      "name": "Cross-User Modification",
      "passed": false,
      "details": "Modified other user profile",
      "timestamp": "2025-12-15T15:55:32.179Z"
    },
    {
      "name": "Unauthenticated User Read",
      "passed": false,
      "details": "Read 9 users",
      "timestamp": "2025-12-15T15:55:33.412Z"
    },
    {
      "name": "Unauthenticated Post Read",
      "passed": false,
      "details": "Read 10 posts",
      "timestamp": "2025-12-15T15:55:33.491Z"
    },
    {
      "name": "Message Injection",
      "passed": false,
      "details": "Created fake message",
      "timestamp": "2025-12-15T15:55:35.275Z"
    },
    {
      "name": "Message Injection",
      "passed": true,
      "details": "Protected: 7 PERMISSION_DENIED: Missing or insufficient permissions.",
      "timestamp": "2025-12-15T15:55:35.352Z"
    },
    {
      "name": "User Enumeration",
      "passed": false,
      "details": "Accessed 9 users",
      "timestamp": "2025-12-15T15:55:36.939Z"
    },
    {
      "name": "PII Exposure",
      "passed": false,
      "details": "Exposed: email, friends, friendRequests, referralCode",
      "timestamp": "2025-12-15T15:55:38.549Z"
    },
    {
      "name": "Stored XSS",
      "passed": false,
      "details": "4 payloads stored",
      "timestamp": "2025-12-15T15:55:41.045Z"
    }
  ]
}